(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25f8276c"],{"3c2c":function(e,t,i){"use strict";i("4ad1")},"4ad1":function(e,t,i){},a207:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.filesDialogVisible,title:"附件",width:"80%"},on:{"update:visible":function(t){e.filesDialogVisible=t},closed:e.closeFilesLook}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[i("el-upload",{ref:"upload",staticStyle:{width:"80px !important"},attrs:{action:e.fileAction,"auto-upload":!0,"before-upload":e.fileBeforeUpload,data:{correctId:e.info.correctId},headers:e.uploadHeader,"on-error":e.onError,"on-success":e.handleSuccessUp,"show-file-list":!1,accept:".jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.zip,.rar"}},[i("el-button",{staticStyle:{height:"38px"},attrs:{size:"small",type:"primary"}},[e._v("附件上传")])],1)],1),i("div",[i("limsTable",{ref:"yearTable",staticStyle:{"margin-top":"0.5em"},attrs:{column:e.columnData,height:"calc(100vh - 30em)",highlightCurrentRow:!0,"table-data":e.tableData,"table-loading":e.tableLoading,page:e.page}})],1)]),i("el-dialog",{attrs:{visible:e.lookDialogVisible,fullscreen:"",title:"查看附件",top:"5vh",width:"800px"},on:{"update:visible":function(t){e.lookDialogVisible=t}}},[e.lookDialogVisible?i("filePreview",{staticStyle:{height:"90vh","overflow-y":"auto"},attrs:{currentFile:{},fileUrl:e.javaApi+"/word/"+e.currentInfo.fileUrl}}):e._e()],1)],1)},o=[],l=(i("d3b7"),i("00d5")),n=i("a408"),c=i("5545"),s={name:"ViewTestRecord",components:{filePreview:n["a"],limsTable:l["a"]},data:function(){var e=this;return{filesDialogVisible:!1,tableLoading:!1,filesLookInfo:{},columnData:[{label:"文件名称",prop:"fileName",minWidth:"150px"},{dataType:"action",minWidth:"100",label:"操作",fixed:"right",operation:[{name:"预览",type:"text",clickFun:function(t){e.handleLook(t)}},{name:"下载",type:"text",clickFun:function(t){e.upload(t)}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.delete(t)}}]}],tableData:[],info:{},currentInfo:{},lookDialogVisible:!1,page:{total:0,size:-1,current:-1}}},methods:{openDia:function(e){this.filesDialogVisible=!0,this.info=e,this.searchTableList()},searchTableList:function(){var e=this;this.tableLoading=!0,Object(c["w"])({correctId:this.info.correctId}).then((function(t){e.tableLoading=!1,e.tableData=t.data})).catch((function(t){e.tableLoading=!1,console.log("err---",t)}))},closeFilesLook:function(){this.filesDialogVisible=!1},handleLook:function(e){this.currentInfo=e,this.lookDialogVisible=!0},upload:function(e){this.$download.saveAs(e.fileUrl,e.fileName)},delete:function(e){var t=this;this.tableLoading=!0,Object(c["h"])({correctFileId:e.correctFileId}).then((function(e){t.tableLoading=!1,t.$message.success("删除成功"),t.searchTableList()})).catch((function(e){t.tableLoading=!1,console.log("err---",e)}))},fileBeforeUpload:function(e){var t=!0;if(e.size>10485760&&(this.$message.error("上传文件不超过10M"),this.$refs.upload.clearFiles(),t=!1),!t)return Promise.reject(t)},onError:function(e,t,i,a){this.$message.error("上传失败"),this.$refs.upload.clearFiles()},handleSuccessUp:function(e){this.upLoading=!1,200==e.code?(this.$message.success("上传成功"),this.searchTableList()):this.$message.error(e.message)}},computed:{fileAction:function(){return this.javaApi+"/internalCorrect/uploadInternalCorrectFile"}}},r=s,u=i("2877"),d=Object(u["a"])(r,a,o,!1,null,"2c564480",null);t["default"]=d.exports},fbfe:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"search"},[i("div",[i("el-form",{ref:"searchForm",attrs:{model:e.searchForm,size:"small",inline:!0}},[i("el-form-item",{attrs:{label:"不合格描述",prop:"laboratoryName"}},[i("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.searchForm.raiseResult,callback:function(t){e.$set(e.searchForm,"raiseResult",t)},expression:"searchForm.raiseResult"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchList}},[e._v("查询")]),i("el-button",{attrs:{size:"mini"},on:{click:e.resetSearchForm}},[e._v("重置")])],1)],1)],1),i("div",[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.openFormDia("add")}}},[e._v("新 增")])],1)]),i("div",{staticClass:"table"},[i("limsTable",{attrs:{column:e.tableColumn,height:"calc(100vh - 23em)","table-data":e.tableData,"table-loading":e.tableLoading,page:e.page},on:{pagination:e.pagination}})],1),e.correctiveActionDIa?i("corrective-action-d-ia",{ref:"correctiveActionDIa",on:{closeRectifyDia:e.closeRectifyDia}}):e._e(),e.viewTestRecordDialog?i("view-test-record",{ref:"viewTestRecordDialog"}):e._e()],1)},o=[],l=i("5530"),n=i("00d5"),c=i("8ca5"),s=i("a207"),r=i("5545"),u={name:"correctiveAction",components:{CorrectiveActionDIa:c["default"],limsTable:n["a"],ViewTestRecord:s["default"]},data:function(){var e=this;return{searchForm:{raiseResult:""},tableColumn:[{label:"不合格或偏离事实的描述",prop:"raiseResult",minWidth:"100"},{label:"原因分析",prop:"causeResult",minWidth:"100"},{label:"纠正措施",prop:"correctResult",minWidth:"100"},{label:"实施验证结果",prop:"validationResult",minWidth:"100"},{dataType:"action",minWidth:"220",label:"操作",operation:[{name:"导出",type:"text",clickFun:function(t){e.handleDown(t)}},{name:"纠正",type:"text",clickFun:function(t){e.openFormDia("rectify",t)}},{name:"查看附件",type:"text",clickFun:function(t){e.viewFiles(t)}}]}],tableData:[],tableLoading:!1,page:{size:20,current:1,total:0},correctiveActionDIa:!1,viewTestRecordDialog:!1}},mounted:function(){this.searchList()},methods:{searchList:function(){var e=this,t={raiseResult:this.searchForm.raiseResult},i=this.page;this.tableLoading=!0,Object(r["C"])(Object(l["a"])(Object(l["a"])({},t),i)).then((function(t){e.tableLoading=!1,e.tableData=t.data.records,e.page.total=t.data.total})).catch((function(t){console.log("err---",t),e.tableLoading=!1}))},resetSearchForm:function(){this.searchForm.raiseResult="",this.searchList()},viewFiles:function(e){var t=this;this.viewTestRecordDialog=!0,this.$nextTick((function(){t.$refs.viewTestRecordDialog.openDia(e)}))},openFormDia:function(e,t){var i=this;this.correctiveActionDIa=!0,this.$nextTick((function(){i.$refs.correctiveActionDIa.openDia(e,t)}))},handleDown:function(e){var t=this;Object(r["p"])({correctId:e.correctId}).then((function(e){t.outLoading=!1;var i=new Blob([e],{type:"application/msword"});t.$download.saveAs(i,"内审纠正措施.docx")}))},closeRectifyDia:function(){this.correctiveActionDIa=!1,this.searchList()},pagination:function(e){var t=e.page,i=e.limit;this.page.current=t,this.page.size=i,this.searchList()}}},d=u,h=(i("3c2c"),i("2877")),f=Object(h["a"])(d,a,o,!1,null,"edb70bba",null);t["default"]=f.exports}}]);