(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-714e730e"],{3422:function(e,t,a){},"5a92":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"capacity-scope"},[a("div",[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0}},[a("el-form-item",{attrs:{label:"资质名称",prop:"name"}},[a("el-select",{attrs:{placeholder:"选择资质名称",size:"small"},on:{change:function(t){e.refreshTable(),e.list=[]}},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}},e._l(e.dict.type.cnas_method_qualification,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.refreshTable}},[e._v("查询")]),a("el-button",{attrs:{size:"mini"},on:{click:e.refresh}},[e._v("重置")])],1)],1)],1),a("div",[a("el-row",{staticClass:"title"},[a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:12}},[a("el-radio-group",{attrs:{size:"medium",fill:"#409EFF"},on:{input:e.selectorSwitch},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:0}},[e._v("资质明细")]),a("el-radio-button",{attrs:{label:1}},[e._v("资质总览")])],1)],1),0===e.radio?a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.openAdd}},[e._v("资质更新")]),a("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.handleDel}},[e._v("删除")])],1):e._e()],1)],1),0===e.radio?a("div",[a("lims-table",{attrs:{tableData:e.tableData,column:e.column,isSelection:!0,handleSelectionChange:e.handleSelectionChange,height:"calc(100vh - 300px)",page:e.page,tableLoading:e.tableLoading},on:{pagination:e.pagination}})],1):e._e(),1===e.radio?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"table",on:{scroll:e.scrollFn}},[a("el-row",{attrs:{gutter:16}},e._l(e.list,(function(t,i){return a("el-col",{key:i,staticStyle:{"margin-bottom":"16px"},attrs:{span:8,xs:24,sm:12,md:8,lg:8,xl:6}},[a("div",{staticClass:"table-item"},[a("el-image",{staticStyle:{width:"102px",height:"102px","margin-right":"20px","border-radius":"16px"},attrs:{src:e.javaApi+"/img/"+t.imageUrl}},[a("div",{staticClass:"image-error",staticStyle:{width:"100px",height:"100px","border-radius":"16px",display:"flex","align-items":"center","justify-content":"center",border:"1px solid #eeeeee"},attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"30px",color:"#666666"}})])]),a("div",{staticClass:"table-item-right",staticStyle:{flex:"1","font-size":"12px",color:"#666666"}},[a("p",{staticStyle:{"line-height":"26px"}},[e._v(" 资质名称："),a("span",{staticStyle:{color:"#3a7bfa"}},[e._v(e._s(t.name))])]),a("p",{staticStyle:{"line-height":"26px"}},[e._v("颁发时间："+e._s(t.recentlyTime))]),a("p",{staticStyle:{"line-height":"26px"}},[e._v("到期时间："+e._s(t.expireTime))]),a("p",[a("span",[e._v("状态：")]),a("el-tag",{attrs:{type:0===t.state?"danger":"success",size:"small"}},[e._v(e._s(0===t.state?"失效":"有效"))])],1)])],1)])})),1),e.list.length<1&&!e.pageLoading&&!e.isLoding?a("div",{staticStyle:{color:"#909399","font-size":"14px","text-align":"center","margin-top":"200px"}},[e._v(" 暂无数据 ")]):e._e(),e.list.length>0?a("div",[e.isLoding?a("el-button",{staticStyle:{display:"flex",margin:"0 auto",color:"#909399"},attrs:{type:"text"}},[a("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"20px"}})]):e._e(),e.finishLoding?a("el-button",{staticStyle:{display:"flex",margin:"0 auto",color:"#909399"},attrs:{type:"text"}},[e._v("已经没有更多啦~")]):e._e()],1):e._e()],1):e._e(),a("el-dialog",{attrs:{title:"资质更新",visible:e.qualificationsConnectVisible,width:"400px"},on:{"update:visible":function(t){e.qualificationsConnectVisible=t}}},[a("el-form",{ref:"formDataRef",attrs:{model:e.formData,"label-position":"right",rules:e.formDataRules,"label-width":"78px"}},[a("el-form-item",{attrs:{label:"资质名称",prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}},e._l(e.dict.type.cnas_method_qualification,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"资质编码",prop:"code"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},model:{value:e.formData.code,callback:function(t){e.$set(e.formData,"code",t)},expression:"formData.code"}})],1),a("el-form-item",{attrs:{label:"颁发机构",prop:"organization"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},model:{value:e.formData.organization,callback:function(t){e.$set(e.formData,"organization",t)},expression:"formData.organization"}})],1),a("el-form-item",{attrs:{label:"资质说明",prop:"explanation"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},model:{value:e.formData.explanation,callback:function(t){e.$set(e.formData,"explanation",t)},expression:"formData.explanation"}})],1),a("el-form-item",{attrs:{label:"颁发时间",prop:"dateOfIssuance"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",size:"small",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",clearable:"",placeholder:"选择日期"},model:{value:e.formData.dateOfIssuance,callback:function(t){e.$set(e.formData,"dateOfIssuance",t)},expression:"formData.dateOfIssuance"}})],1),a("el-form-item",{attrs:{label:"到期时间",prop:"expireTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",size:"small",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",clearable:"",placeholder:"选择日期"},model:{value:e.formData.expireTime,callback:function(t){e.$set(e.formData,"expireTime",t)},expression:"formData.expireTime"}})],1),a("el-form-item",{attrs:{label:"资质图片"}},[a("el-upload",{ref:"upload",attrs:{action:e.uploadAction,"on-success":function(t){return e.handleSuccessUpImg(t,"imageUrl")},accept:"image/jpg,image/jpeg,image/png",multiple:!1,limit:1,headers:e.headers,"on-change":e.beforeUpload,"on-error":e.onError}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取图片")])],1)],1),a("el-form-item",{attrs:{label:"资质附件"}},[a("el-upload",{ref:"upload1",attrs:{action:e.uploadAction,"on-success":function(t){return e.handleSuccessUpImg(t,"fileUrl")},accept:"image/jpg,image/jpeg,image/png,application/pdf,.doc,.docx",headers:e.headers,multiple:!1,limit:1,"on-change":e.beforeUpload1,"on-error":e.onError1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.qualificationsConnectVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmQualifications}},[e._v("确 定")])],1)],1)],1)},l=[],r=a("5530"),o=(a("99af"),a("a15b"),a("14d9"),a("b0c0"),a("d3b7"),a("0643"),a("4e3e"),a("159b"),a("00d5")),s=a("5fb3"),n=a("5f87"),c={name:"Laboratory",components:{limsTable:o["a"]},dicts:["cnas_method_qualification"],data:function(){var e=this;return{radio:0,queryParams:{name:""},tableData:[],selection:[],column:[{label:"资质名称",prop:"name"},{label:"资质编码",prop:"code"},{label:"颁发机构",prop:"organization"},{label:"资质说明",prop:"explanation"},{label:"首次颁发时间",prop:"firstIssuanceDate"},{label:"最近颁发时间",prop:"latestIssuanceDate"},{label:"到期颁发时间",prop:"expireTime"},{dataType:"action",label:"操作",operation:[{name:"附件下载",type:"text",clickFun:function(t){e.handleDownLoad(t)}}]}],page:{total:0,size:10,current:1},tableLoading:!1,qualificationsList:[],qualificationsConnectVisible:!1,formData:{},formDataRules:{name:[{required:!0,message:"请填写资质名称",trigger:"change"}],code:[{required:!0,message:"请填写资质编码",trigger:"blur"}],organization:[{required:!0,message:"请填写颁发机构",trigger:"blur"}],dateOfIssuance:[{required:!0,message:"请选择颁发时间",trigger:"change"}],expireTime:[{required:!0,message:"请填写到期时间",trigger:"change"}]},loading:!1,pageLoading:!1,isLoding:!1,finishLoding:!1,currentPage:1,pageSize:16,total:"",list:[],uploadAction:"/prod-api/deviceScope/uploadFile",headers:{Authorization:"Bearer "+Object(n["a"])()}}},mounted:function(){this.refreshTable()},methods:{selectorSwitch:function(e){1===e&&(this.list=[],this.refreshTable())},refreshTable:function(){var e=this;0===this.radio?(this.tableLoading=!0,Object(s["c"])(Object(r["a"])(Object(r["a"])({},this.page),this.queryParams)).then((function(t){e.tableLoading=!1,200===t.code&&(e.tableData=t.data.records,e.page.total=t.data.total)})).catch((function(t){e.tableLoading=!1}))):(this.currentPage>1?this.isLoding=!0:this.pageLoading=!0,0===this.list.length&&window.addEventListener("scroll",this.throttle(this.scrollFn,2e4)),Object(s["c"])(Object(r["a"])({current:this.currentPage,size:this.pageSize},this.queryParams)).then((function(t){if(200===t.code){e.total=t.data.total;var a=t.data.records;0===a.length?e.finishLoding=!0:(a.length<e.pageSize&&(e.finishLoding=!0),e.list=e.list.concat(a),e.total===e.list.length&&(e.finishLoding=!0))}e.pageLoading=!1,e.isLoding=!1})).catch((function(t){e.pageLoading=!1,e.isLoding=!1})))},refresh:function(){0===this.radio?(this.queryParams.name="",this.page.size=10,this.page.current=1,this.refreshTable()):(this.finishLoding=!1,this.currentPage=1,this.list=[],this.refreshTable())},handleSelectionChange:function(e){this.selection=e},pagination:function(e){this.page.size=e.limit,this.refreshTable()},handleDel:function(){var e=this;if(0!==this.selection.length){var t=[];this.selection.forEach((function(e){t.push(e.id)})),Object(s["b"])({ids:t.join(",")}).then((function(t){200===t.code&&(e.refreshTable(),e.$message.success("删除成功"))}))}else this.$message.warning("请选择至少一条数据")},handleDownLoad:function(e){e.fileUrl?this.$download.saveAs(e.fileUrl,e.fileUrl):this.$message.warning("暂无附件")},openAdd:function(){var e=this;this.qualificationsConnectVisible=!0,this.$nextTick((function(){e.$refs.upload.clearFiles(),e.$refs.upload1.clearFiles()})),this.formData={}},handleSuccessUpImg:function(e,t){200===e.code&&(this.formData[t]=e.data.url)},beforeUpload:function(e){return!(e.size>10485760)||(this.$message.error("上传文件不超过10M"),this.$refs.upload.clearFiles(),!1)},onError:function(e,t,a){this.$message.error("上传失败"),this.$refs.upload.clearFiles()},beforeUpload1:function(e){return!(e.size>10485760)||(this.$message.error("上传文件不超过10M"),this.$refs.upload1.clearFiles(),!1)},onError1:function(e,t,a){this.$message.error("上传失败"),this.$refs.upload1.clearFiles()},confirmQualifications:function(){var e=this;this.$refs["formDataRef"].validate((function(t){t&&(e.loading=!0,Object(s["a"])(Object(r["a"])({},e.formData)).then((function(t){e.loading=!1,e.$message.success("已提交"),e.refreshTable(),e.resetForm("formDataRef"),e.qualificationsConnectVisible=!1})).catch((function(t){e.loading=!1})))}))},scrollFn:function(){var e=document.documentElement.clientHeight-18,t=document.body.scrollHeight,a=parseInt(document.documentElement.scrollTop),i=300;if(!(a+e>=t-i&&0!==t))return!1;!this.finishLoding&&this.currentPage*this.pageSize<this.total&&(this.currentPage=this.currentPage+1,this.refreshTable())},throttle:function(e,t){var a=null;return function(){var i=this,l=arguments;a||(a=setTimeout((function(){e.apply(i,l),a=null}),t))}}},destroyed:function(){window.removeEventListener("scroll",this.throttle(),!1)}},d=c,u=(a("f981"),a("2877")),m=Object(u["a"])(d,i,l,!1,null,"2a386154",null);t["default"]=m.exports},"5fb3":function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var i=a("b775");function l(e){return Object(i["a"])({url:"/certification/getCertificationDetail",method:"get",params:e})}function r(e){return Object(i["a"])({url:"/certification/addCertificationDetail",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/certification/delCertificationDetail",method:"delete",params:e})}},f981:function(e,t,a){"use strict";a("3422")}}]);