(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3eedad7a"],{4078:function(e,t,n){"use strict";n("96e4")},"504c":function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return s}));var r=n("b775");function a(e){return Object(r["a"])({url:"/insReport/upReportUrl",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/insReport/pageInsReport",method:"get",params:e})}function o(e){return Object(r["a"])({url:"/insReport/downAll",method:"get",params:e})}function u(e){return Object(r["a"])({url:"/insReport/sendBackTask",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/insReport/examineReport",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/insReport/writeReport",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/insReport/ratifyReport",method:"post",data:e})}},"8abd":function(e,t,n){e.exports=n.p+"static/img/no-full.f23a9ad7.svg"},"96e4":function(e,t,n){},b3ec:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",[r("el-form",{ref:"entity",attrs:{model:e.entity,size:"small",inline:!0}},[r("el-form-item",{attrs:{label:"委托编号",prop:"entrustCode"}},[r("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable()}},model:{value:e.entity.entrustCode,callback:function(t){e.$set(e.entity,"entrustCode",t)},expression:"entity.entrustCode"}})],1),r("el-form-item",{attrs:{label:"下单类别",prop:"entrustCode"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:""},on:{change:function(t){return e.refreshTable()}},model:{value:e.entity.typeSource,callback:function(t){e.$set(e.entity,"typeSource",t)},expression:"entity.typeSource"}},e._l(e.typeSourceList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.refreshTable}},[e._v("查询")]),r("el-button",{attrs:{size:"mini"},on:{click:e.refresh}},[e._v("重置")])],1)],1),r("div",{staticClass:"page_total"},[r("span",[e._v("总计任务数量:")]),r("span",[e._v(e._s(e.page.total))])])],1),r("div",[r("lims-table",{key:"tableData0",attrs:{tableData:e.tableData,column:e.column,page:e.page,tableLoading:e.tableLoading,rowClassName:e.rowClassName,height:"calc(100vh - 270px)"},on:{pagination:e.pagination}})],1),r("el-dialog",{attrs:{title:"报告查看",visible:e.issuedVisible,width:"80vw","modal-append-to-body":!1,fullscreen:e.fullscreen},on:{"update:visible":function(t){e.issuedVisible=t}}},[r("div",{staticClass:"full-screen"},[e.fullscreen?r("img",{staticStyle:{cursor:"pointer"},attrs:{src:n("8abd"),alt:""},on:{click:function(t){e.fullscreen=!1}}}):r("i",{staticClass:"el-icon-full-screen",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:function(t){e.fullscreen=!0}}})]),e.issuedVisible?r("div",{staticStyle:{height:"80vh"}},[r("onlyoffice",{ref:"onlyoffice",staticStyle:{width:"100%",height:"100%"},attrs:{options:e.option}})],1):e._e()]),r("el-dialog",{attrs:{title:"查看附件",visible:e.lookDialogVisible,width:"800px",top:"5vh",fullscreen:""},on:{"update:visible":function(t){e.lookDialogVisible=t}}},[e.lookDialogVisible?r("filePreview",{staticStyle:{"max-height":"90vh","overflow-y":"auto"},attrs:{fileUrl:e.javaApi+"/word/"+e.currentInfo.tempUrlPdf,currentFile:{}}}):e._e()],1)],1)},a=[],i=n("5530"),o=(n("7db0"),n("caad"),n("14d9"),n("b0c0"),n("d3b7"),n("ac1f"),n("2532"),n("5319"),n("0643"),n("fffc"),n("4e3e"),n("159b"),n("c466")),u=n("e317"),l=n("00d5"),c=n("b558"),s=n("2f62"),d=n("504c"),p=n("a408"),f={name:"InspectionReview",components:{filePreview:p["a"],onlyoffice:u["a"],limsTable:l["a"]},dicts:["urgency_level","inspection_task_state"],computed:Object(i["a"])({},Object(s["b"])(["nickName","userId"])),data:function(){var e=this;return{lookDialogVisible:!1,alone:!1,tabList:[],active:1,tabIndex:0,entity:{sonLaboratory:null,insState:"3",userId:0,typeSource:null,isCheck:1},tableData:[],column:[{label:"委托编号",prop:"entrustCode",width:"160px",dataType:"link",linkMethod:"selectAllByOne"},{label:"样品名称",prop:"sample",width:"160px"},{label:"下单类别",prop:"typeSource",width:"100px",dataType:"tag",formatData:function(e){return 0==e?"成品下单":"原材料下单"}},{label:"样品型号",prop:"sampleModel",width:"120px"},{label:"紧急程度",prop:"type",dataType:"tag",formatData:function(t){return e.urgencyLevel.find((function(e){return e.value==t}))?e.urgencyLevel.find((function(e){return e.value==t})).label:null},formatType:function(t){return e.urgencyLevel.find((function(e){return e.value==t}))?e.urgencyLevel.find((function(e){return e.value==t})).type:null}},{label:"检验类型",prop:"orderType",width:"100px",dataType:"tag",formatData:function(t){return e.orderTypeList.find((function(e){return e.value==t})).label},formatType:function(t){return e.orderTypeList.find((function(e){return e.value==t})).type}},{label:"状态",prop:"insState",dataType:"tag",formatData:function(t){return e.inspectionTaskState.find((function(e){return e.value==t}))?e.inspectionTaskState.find((function(e){return e.value==t})).label:null},formatType:function(t){return e.inspectionTaskState.find((function(e){return e.value==t}))?e.inspectionTaskState.find((function(e){return e.value==t})).type:null}},{label:"检验人",prop:"userName"},{label:"复核人",prop:"checkName"},{label:"约定时间",prop:"appointed"},{label:"下发时间",prop:"sendTime",width:"140px"},{label:"检验开始时间",prop:"insTime",width:"140px"},{label:"理由",prop:"verifyTell",width:"140px"},{dataType:"action",fixed:"right",label:"操作",operation:[{name:"复核",type:"text",clickFun:function(t){e.handleReview(t)},disabled:function(t){return null==t.checkName||t.checkName&&!t.checkName.includes(e.nickName)}},{name:"下载报告",type:"text",clickFun:function(t){e.download(t)}},{name:"上传",type:"upload",accept:".doc,.docx",url:"/insReport/inReport",uploadIdFun:function(e){return e.insReportId}},{name:"还原",type:"text",clickFun:function(t){e.handleRestore(t)}},{name:"查看报告",type:"text",clickFun:function(t){e.handleIssued(t)}}]}],page:{total:0,size:10,current:0},tableLoading:!1,upIndex:0,planTotal:0,insStateList:[],state:0,activeFace:0,examine:null,isReport:0,currentId:null,orderId:0,personList:[],currentTime:null,sonLaboratoryList:[],typeSourceList:[{label:"成品下单",value:0},{label:"原材料下单",value:1}],isCopper:null,customsInspection:{},typeSource:null,showInfoDialog:!1,issuedVisible:!1,fullscreen:!1,option:null,orderTypeList:[{label:"委托试验",value:"Customer-ordered test",type:"success"},{label:"抽检",value:"抽检",type:"danger"},{label:"进厂检验",value:"进厂检验",type:"info"},{label:"季度检验",value:"Quarterly inspection",type:""}],urgencyLevel:[],inspectionTaskState:[]}},created:function(){var e=this;this.getDicts("urgency_level").then((function(t){e.urgencyLevel=e.dictToValue(t.data)})),this.getDicts("inspection_task_state").then((function(t){e.inspectionTaskState=e.dictToValue(t.data)})),this.getAuthorizedPerson(),this.currentTime=Object(o["b"])()},mounted:function(){this.refreshTable()},activated:function(){this.refreshTable()},methods:{refreshTable:function(){var e=this;this.tableLoading=!0;var t=Object(i["a"])(Object(i["a"])({},this.entity),this.page);delete t.total,Object(c["u"])(Object(i["a"])({},t)).then((function(t){e.tableLoading=!1,200===t.code&&(e.tableData=t.data.records,e.page.total=t.data.total)})).catch((function(t){e.tableLoading=!1}))},pagination:function(e){var t=e.page,n=e.limit;this.page.current=t,this.page.size=n,this.refreshTable()},refresh:function(){this.resetForm("entity"),this.refreshTable()},rowClassName:function(e){var t=e.row;e.rowIndex;return this.currentTime==t.appointed?"highlight-warning-row-border":this.currentTime>t.appointed?"highlight-danger-row-border":""},selectAllByOne:function(e){switch(this.isCopper=e.isCopper,this.customsInspection=e,this.activeFace=2,this.examine=1,this.isReport=0,this.currentId=parseInt(e.id),e.isCopper){case 0:this.$router.push({path:"/materialOrder/customsInspectionView",query:{customsInspection:e,active:this.activeFace,currentId:this.currentId,isReport:this.isReport}});break;case null:this.$router.push({path:"/productOrder/addView",query:{examine:this.examine,active:this.activeFace,currentId:this.currentId}});break;case 1:this.$router.push({path:"/materialOrder/CopperView",query:{active:this.activeFace,currentId:this.currentId}});break}},handleReview:function(e){this.$router.push({path:"/inspectionTask/inspection",query:{sonLaboratory:e.sonLaboratory,state:2,typeSource:e.typeSource,orderId:e.id}})},download:function(e){var t=null===e.urlS||""===e.urlS?e.url:e.urlS,n=document.createElement("a");n.href=this.javaApi+t,n.target="_blank",document.body.appendChild(n),n.click()},handleRestore:function(e){var t=this;this.$confirm("是否还原当前报告?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["f"])({id:e.insReportId}).then((function(e){200===e.code&&(t.$message.success("还原成功"),t.refreshTable())}))})).catch((function(){}))},handleIssued:function(e){this.currentInfo=e;var t=e.url,n="docx";null==e.tempUrlPdf&&""!==e.tempUrlPdf||(t=e.tempUrlPdf,n="pdf"),t=t.replace("/word/","");var r=this.nickName;this.option={url:this.javaApi+"/word/"+t,isEdit:!1,fileType:n,title:t,lang:"zh-CN",isPrint:!1,user_id:1,user_name:r,editUrl:this.javaApi+"/insReport/onlyOffice/save?fileName="+t},this.issuedVisible=!0},getAuthorizedPerson:function(){var e=this;Object(c["w"])({type:1}).then((function(t){var n=[];t.data.forEach((function(e){n.push({label:e.name,value:e.id})})),e.personList=n}))}}},h=f,m=(n("4078"),n("2877")),b=Object(m["a"])(h,r,a,!1,null,"6baba7c9",null);t["default"]=b.exports},b558:function(e,t,n){"use strict";n.d(t,"v",(function(){return a})),n.d(t,"A",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"z",(function(){return u})),n.d(t,"y",(function(){return l})),n.d(t,"w",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"n",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"u",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"o",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"D",(function(){return O})),n.d(t,"l",(function(){return w})),n.d(t,"t",(function(){return k})),n.d(t,"C",(function(){return P})),n.d(t,"b",(function(){return j})),n.d(t,"x",(function(){return T})),n.d(t,"s",(function(){return I})),n.d(t,"h",(function(){return x})),n.d(t,"k",(function(){return S})),n.d(t,"f",(function(){return R})),n.d(t,"r",(function(){return C})),n.d(t,"m",(function(){return L})),n.d(t,"q",(function(){return D})),n.d(t,"B",(function(){return _}));var r=n("b775");function a(e){return Object(r["a"])({url:"/insOrder/selectSampleAndProductByOrderId",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/insOrderPlan/updateProductOnPlan",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/insOrderPlan/claimInsOrderPlan",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/insOrderPlan/upPlanUser2",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/insOrderPlan/upPlanUser",method:"post",params:e})}function c(e){return Object(r["a"])({url:"/system/newUser/selectUserCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/insOrderPlan/getBindingProductByProductId",method:"get",params:e})}function d(e){return Object(r["a"])({url:"/insOrderPlan/getProductTreeByProductId",method:"get",params:e})}function p(e){return Object(r["a"])({url:"/insOrderPlan/bindingProductTreeByProductId",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/insOrderPlan/delProductTreeByProductId",method:"delete",params:e})}function h(e){return Object(r["a"])({url:"/insOrderPlan/selectInsOrderPlanList",method:"get",params:e})}function m(e){return Object(r["a"])({url:"/insOrderPlan/doInsOrder",method:"get",params:e})}function b(e){return Object(r["a"])({url:"/insOrderPlan/getCableTag",method:"get",params:e})}function g(e){return Object(r["a"])({url:"/insOrderPlan/getRepetitionTag",method:"get",params:e})}function y(e){return Object(r["a"])({url:"/insOrderPlan/getRawMaterialTag",method:"get",params:e})}function v(e){return Object(r["a"])({url:"/deviceScope/dataCollection",method:"post",data:e})}function O(e){return Object(r["a"])({url:"/insOrderPlan/write",method:"post",data:e})}function w(e){return Object(r["a"])({url:"/insOrderPlan/getInsProduct",method:"get",params:e})}function k(e){return Object(r["a"])({url:"/deviceScope/search",method:"get",params:e})}function P(e){return Object(r["a"])({url:"/insOrderPlan/verifyPlan",method:"post",params:e})}function j(e){return Object(r["a"])({url:"/insOrderPlan/checkSubmitPlan",method:"post",params:e})}function T(e){return Object(r["a"])({url:"/insOrderPlan/submitPlan",method:"post",params:e})}function I(e){return Object(r["a"])({url:"/insOrderPlan/saveInsContext",method:"post",data:e})}function x(e){return Object(r["a"])({url:"/insOrderPlan/downFile",method:"get",params:e})}function S(e){return Object(r["a"])({url:"/insOrderPlan/getFileList",method:"get",params:e})}function R(e){return Object(r["a"])({url:"/insOrderPlan/delfile",method:"delete",params:e})}function C(e){return Object(r["a"])({url:"/insOrderPlan/inspectionOrderDetailsTaskSwitching",method:"get",params:e})}function L(e){return Object(r["a"])({url:"/insOrderPlan/getInsProductUnqualifiedRetest",method:"get",params:e})}function D(e){return Object(r["a"])({url:"/insOrderPlan/getWorkingHoursByOrderId",method:"get",params:e})}function _(e){return Object(r["a"])({url:"/insOrderPlan/updateWorkingHours",method:"post",data:e})}},c466:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));n("4d63"),n("c607"),n("ac1f"),n("2c3e"),n("00b4"),n("25f0"),n("5319");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),n=e.getMonth()+1;n<10?n="0"+n+"-":n+="-",t+="-";var r=e.getDate();return r=r<10?"0"+r:r,t+n+r}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";if("Invalid Date"!==e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}return""}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate();return 26===r&&(n++,n>11&&(n=0,t++)),n+=1,n=n<10?"0"+n+"-":n+"-",t+="-",r=r<10?"0"+r:r,t+n+r}}}]);