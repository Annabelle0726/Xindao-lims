(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-563a1d42"],{4548:function(t,e,n){"use strict";n("5a3f")},"4c2d":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"flex"},[n("el-button",{attrs:{icon:"el-icon-plus",size:"small",type:"primary"},on:{click:function(e){return t.showDialog(void 0)}}},[t._v(" 新建 ")]),n("el-button",{attrs:{icon:"el-icon-upload2",size:"small"},on:{click:t.exportExcel}},[t._v(" 导出Excel ")])],1),n("limsTable",{staticStyle:{"margin-top":"18px"},attrs:{column:t.columns,currentChange:t.rowClick,height:"25vh",highlightCurrentRow:!0,isSelection:!1,rowStyle:t.tableRowStyle,"table-data":t.tableData,rowKey:"id",page:t.page},on:{pagination:t.pagination},scopedSlots:t._u([{key:"consumablesTypeSlot",fn:function(e){var n=e.row;return[t._v(" "+t._s(t.findType(n.consumablesType))+" ")]}},{key:"operation",fn:function(e){return[n("el-button",{attrs:{size:"small",type:"text"},on:{click:function(n){return t.showDialog(e.row)}}},[t._v("编辑")]),n("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"small",type:"text"},on:{click:function(n){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])}),n("el-divider"),n("div",[n("ConsumableProject",{ref:"consumableProject"})],1),n("Edit",{ref:"editRef",attrs:{contentsId:t.contentsId},on:{submit:t.fetchData}})],1)},o=[],c=n("c14f"),i=n("5530"),l=n("1da1"),r=(n("7db0"),n("a9e3"),n("d3b7"),n("0643"),n("fffc"),n("7239")),s=n("00d5"),u=n("27bc"),p=n("395b"),f={dicts:["consumables_type"],components:{limsTable:s["a"],Edit:r["default"],ConsumableProject:p["default"]},props:{contentsId:{type:Number,required:!0}},watch:{contentsId:function(t,e){0!==t&&this.fetchData()}},data:function(){return{columns:[{label:"货号",prop:"itemNumber"},{label:"类别",prop:"consumablesType",dataType:"slot",slot:"consumablesTypeSlot"},{label:"名称",prop:"consumablesName"},{label:"规格",prop:"specifications"},{label:"参考供应商",prop:"supplierName"},{label:"库存下限",prop:"lowerLimit"},{label:"当前库存",prop:"currentAmount"},{label:"计量单位",prop:"unit"},{label:"备注",prop:"remark"},{label:"负责人",prop:"personInChargeName"},{label:"最近更新人",prop:"updateUserName"},{label:"最近更新日期",prop:"updateTime"},{fixed:"right",label:"操作",width:120,dataType:"slot",slot:"operation"}],tableData:[],page:{current:1,size:20,total:0},options:[]}},mounted:function(){this.fetchData(),this.options=this.dict.type.consumables_type},methods:{fetchData:function(){var t=this;return Object(l["a"])(Object(c["a"])().m((function e(){return Object(c["a"])().w((function(e){while(1)switch(e.n){case 0:Object(u["q"])(Object(i["a"])({contentId:t.contentsId},t.page)).then((function(e){200===e.code&&(t.tableData=e.data.records,t.page.total=e.data.total,t.tableData.length>0&&t.rowClick(t.tableData[0]))}));case 1:return e.a(2)}}),e)})))()},findType:function(t){var e;this.$nextTick();var n=this.options.find((function(e){return e.value==t}));return e=n?n.label:"-",e},showDialog:function(t){this.$refs.editRef.openDialog(t)},exportExcel:function(){var t=this;return Object(l["a"])(Object(c["a"])().m((function e(){return Object(c["a"])().w((function(e){while(1)switch(e.n){case 0:Object(u["l"])({parentId:t.contentsId}).then((function(e){var n=new Blob([e],{type:"application/octet-stream"});t.$download.saveAs(n,"耗材列表.xlsx")}));case 1:return e.a(2)}}),e)})))()},pagination:function(t){this.page.size=t.limit,this.fetchData()},handleDelete:function(t){var e=this;Object(u["h"])({id:t.id}).then((function(t){200===t.code&&(e.$message.success("删除成功"),e.fetchData())}))},rowClick:function(t){this.$refs.consumableProject.fetchListId(t)},tableRowStyle:function(t){var e=t.row;return e.currentAmount<=e.lowerLimit?{background:"#ffcaca"}:{background:"#fff"}}}},d=f,b=(n("4548"),n("2877")),h=Object(b["a"])(d,a,o,!1,null,"02cade9e",null);e["default"]=h.exports},"5a3f":function(t,e,n){}}]);