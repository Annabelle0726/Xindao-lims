(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-416279eb"],{"4dd6":function(t,e,a){"use strict";a("973f")},5353:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"10px"}},[a("div",{staticClass:"header"},[a("div"),a("div",{staticStyle:{"min-width":"200px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addFun}},[t._v("新 增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.approvalFun}},[t._v("审 批")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.approveFun}},[t._v("批 准")]),a("el-upload",{staticStyle:{display:"inline-block",padding:"0 6px"},attrs:{action:t.action,headers:t.uploadHeader,"on-error":t.onError,"show-file-list":!1,"on-success":t.onSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("导 入")])],1),a("el-button",{attrs:{size:"small"},on:{click:t.openDownloadDia}},[t._v("导出")])],1)]),a("el-table",{key:"table0",staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"calc(100vh - 18em)","header-cell-style":{background:"#f8f8f9",color:"#515a6e"},border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s((t.search.current-1)*t.search.size+e.$index+1))])]}}])}),a("el-table-column",{attrs:{prop:"jobActivity",label:"作业活动","min-width":"180"}}),a("el-table-column",{attrs:{prop:"category",label:"风险因素类别",width:"testDate","min-width":"180"}}),a("el-table-column",{attrs:{prop:"description",label:"风险因素描述","min-width":"180"}}),a("el-table-column",{attrs:{prop:"result",label:"可导致的事故","min-width":"180"}}),a("el-table-column",{attrs:{prop:"intolerable",label:"是否不可承受风险","min-width":"180"}}),a("el-table-column",{attrs:{prop:"plan",label:"控制计划","min-width":"180"}}),a("el-table-column",{attrs:{prop:"editorName",label:"编制人姓名","min-width":"180"}}),a("el-table-column",{attrs:{prop:"editorDate",label:"编制日期","min-width":"180"}}),a("el-table-column",{attrs:{prop:"approvalName",label:"审批姓名","min-width":"180"}}),a("el-table-column",{attrs:{prop:"approvalDate",label:"审批日期","min-width":"180"}}),a("el-table-column",{attrs:{prop:"approvalStatus",label:"审批状态","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(1===a.approvalStatus?"通过":2===a.approvalStatus?"不通过":"")+" ")]}}])}),a("el-table-column",{attrs:{prop:"approveName",label:"批准姓名","min-width":"180"}}),a("el-table-column",{attrs:{prop:"approveStatus",label:"批准状态","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(1===a.approveStatus?"通过":2===a.approveStatus?"不通过":"")+" ")]}}])}),a("el-table-column",{attrs:{prop:"approveDate",label:"批准人日期","min-width":"180"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.editClick(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteClick(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":1,"page-size":t.search.size,"page-sizes":[10,20,30,50,100],total:t.search.total,layout:"->,total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"提示",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"作业活动"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.jobActivity,callback:function(e){t.$set(t.form,"jobActivity",e)},expression:"form.jobActivity"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"风险因素类别"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"风险因素描述"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"可导致的事故"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.result,callback:function(e){t.$set(t.form,"result",e)},expression:"form.result"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否不可承受风险","label-width":"130px"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.intolerable,callback:function(e){t.$set(t.form,"intolerable",e)},expression:"form.intolerable"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"控制计划"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.plan,callback:function(e){t.$set(t.form,"plan",e)},expression:"form.plan"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.addApi}},[t._v("确 定")])],1)],1)],1)},o=[],s=a("5530"),l=(a("ac1f"),a("841c"),a("dda7")),i=a("2f62"),r={data:function(){return{dialogVisible:!1,form:{},loading:!1,search:{size:20,current:1,total:0},tableData:[]}},computed:Object(s["a"])({action:function(){return this.javaApi+"/manageControlPlanList/importControlPlanList"}},Object(i["b"])(["userId"])),methods:{handleSizeChange:function(t){this.search.size=t,this.initData()},handleCurrentChange:function(t){this.search.current=t,this.initData()},initData:function(){var t=this;Object(l["h"])(this.search).then((function(e){t.tableData=e.data.records,t.search.total=e.data.total}))},approvalFun:function(){var t=this;this.$confirm("是否审批通过?","提示",{confirmButtonText:"通过",cancelButtonText:"不通过",type:"warning",closeOnClickModal:!1,distinguishCancelAndClose:!0,beforeClose:function(e,a,n){"confirm"===e?(t.approvalApi(t.userId,1),n()):"cancel"===e?(t.approvalApi(t.userId,2),n()):"close"===e&&n()}})},approvalApi:function(t,e){var a=this;Object(l["l"])({approval:t,status:e}).then((function(t){a.initData(),a.$message({type:"success",message:"操作成功!"})}))},approveFun:function(){var t=this;this.$confirm("是否批准通过?","提示",{confirmButtonText:"通过",cancelButtonText:"不通过",type:"warning",closeOnClickModal:!1,distinguishCancelAndClose:!0,beforeClose:function(e,a,n){"confirm"===e?(t.approveApi(t.userId,1),n()):"cancel"===e?(t.approveApi(t.userId,2),n()):"close"===e&&n()}})},approveApi:function(t,e){var a=this;Object(l["c"])({approve:t,status:e}).then((function(t){a.initData(),a.$message({type:"success",message:"操作成功!"})}))},onError:function(){this.$message({type:"error",message:"操作失败!"})},onSuccess:function(t){200==t.code?(this.initData(),this.$message({type:"success",message:"操作成功!"})):this.$message({type:"error",message:t.message})},addFun:function(){this.form={},this.dialogVisible=!0},deleteClick:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["e"])({id:t.id}).then((function(t){e.initData(),e.$message({type:"success",message:"操作成功!"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},addApi:function(){var t=this;this.loading=!0,Object(l["b"])(this.form).then((function(e){t.dialogVisible=!1,t.loading=!1,t.initData(),t.$message({type:"success",message:"操作成功!"})})).catch((function(e){t.loading=!1}))},editClick:function(t){this.form=Object(s["a"])({},t),this.dialogVisible=!0},openDownloadDia:function(){var t=this;Object(l["g"])().then((function(e){t.outLoading=!1;var a=new Blob([e],{type:"application/msword"});t.$download.saveAs(a,"重大风险因素分析及控制计划清单.docx")}))}},mounted:function(){this.initData()}},c=r,u=(a("4dd6"),a("2877")),p=Object(u["a"])(c,n,o,!1,null,"7161a55c",null);e["default"]=p.exports},"973f":function(t,e,a){},dda7:function(t,e,a){"use strict";a.d(e,"i",(function(){return o})),a.d(e,"d",(function(){return s})),a.d(e,"j",(function(){return l})),a.d(e,"k",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"h",(function(){return u})),a.d(e,"l",(function(){return p})),a.d(e,"c",(function(){return d})),a.d(e,"e",(function(){return m})),a.d(e,"b",(function(){return f})),a.d(e,"g",(function(){return b}));var n=a("b775");function o(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/getPageResults",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/dangerousRiskApproval",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/hazardIdentificationAndRiskApproval",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/removeRiskFactors",method:"delete",params:t})}function r(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/addNewRiskFactors",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/manageRiskAssessmentResults/exportHazardFactorIdentification",method:"get",responseType:"blob",params:t})}function u(t){return Object(n["a"])({url:"/manageControlPlanList/getPageList",method:"get",params:t})}function p(t){return Object(n["a"])({url:"/manageControlPlanList/riskAnalysisApprovalOfControlPlanChecklist",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/manageControlPlanList/approvalOfControlPlanChecklist",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/manageControlPlanList/deleteSignificantRiskFactorAnalysis",method:"delete",params:t})}function f(t){return Object(n["a"])({url:"/manageControlPlanList/analysisOfMajorRiskFactorsAdded",method:"post",data:t})}function b(t){return Object(n["a"])({url:"/manageControlPlanList/exportSignificantRiskFactors",method:"get",responseType:"blob",params:t})}}}]);