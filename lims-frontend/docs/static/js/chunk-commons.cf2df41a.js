(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"00d5":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticClass:"lims-table",staticStyle:{width:"100%"},attrs:{border:t.border,data:t.tableData,"header-cell-style":{background:"#f8f8f9",color:"#515a6e"},height:t.height,"highlight-current-row":t.highlightCurrentRow,"row-class-name":t.rowClassName,"row-style":t.rowStyle,"row-key":t.rowKey,"span-method":t.spanMethod,stripe:"","tooltip-effect":"dark"},on:{"row-click":t.rowClick,"current-change":t.currentChange,"selection-change":t.handleSelectionChange}},[t.isSelection?i("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}):t._e(),i("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"60",index:t.indexMethod}}),t._l(t.column,(function(e,n){return i("el-table-column",{key:n,attrs:{"column-key":e.columnKey,"filter-method":e.filterHandler,"filter-multiple":e.filterMultiple,"filtered-value":e.filteredValue,filters:e.filters,fixed:e.fixed,label:e.label,prop:e.prop,"show-overflow-tooltip":"action"!==e.dataType&&"slot"!==e.dataType,"min-width":"action"==e.dataType?t.btnWidth:e.width,sortable:!!e.sortable,type:e.type,width:"action"==e.dataType?t.btnWidth:e.width,align:"center"},scopedSlots:t._u([{key:e.colunmTemplate,fn:function(i){return e.hasOwnProperty("colunmTemplate")?[e.theadSlot?t._t(e.theadSlot,null,{index:n,row:i.row}):t._e()]:void 0}},{key:"default",fn:function(n){return["slot"==e.dataType?i("div",[e.slot?t._t(e.slot,null,{index:n.$index,row:n.row}):t._e()],2):"progress"==e.dataType?i("div",[i("el-progress",{attrs:{percentage:Number(n.row[e.prop])}})],1):"image"==e.dataType?i("div",[i("img",{staticStyle:{width:"40px",height:"40px","margin-top":"10px"},attrs:{src:t.javaApi+"/img/"+n.row[e.prop],alt:""}})]):"tag"==e.dataType?i("div",["string"==typeof t.dataTypeFn(n.row[e.prop],e.formatData)?i("el-tag",{attrs:{title:t._f("formatters")(n.row[e.prop],e.formatData),type:t.formatType(n.row[e.prop],e.formatType)}},[t._v(t._s(t._f("formatters")(n.row[e.prop],e.formatData))+" ")]):"object"==typeof t.dataTypeFn(n.row[e.prop],e.formatData)?t._l(t.dataTypeFn(n.row[e.prop],e.formatData),(function(r,a){return i("el-tag",{key:a,attrs:{title:t._f("formatters")(n.row[e.prop],e.formatData),type:t.formatType(r,e.formatType)}},[t._v(t._s(e.tagGroup&&r[e.tagGroup.label]?r[e.tagGroup.label]:r)+" ")])})):i("el-tag",{attrs:{title:t._f("formatters")(n.row[e.prop],e.formatData),type:t.formatType(n.row[e.prop],e.formatType)}},[t._v(t._s(t._f("formatters")(n.row[e.prop],e.formatData))+" ")])],2):"action"==e.dataType?i("div",{style:"min-width:"+t.getWidth(e.operation,n.row)},[t._l(e.operation,(function(e,r){return[!e.showHide||e.showHide(n.row)?i("el-button",{directives:[{name:"show",rawName:"v-show",value:"upload"!=e.type,expression:"o.type != 'upload'"}],key:r,style:{color:"删除"===e.name?"#f56c6c":e.color},attrs:{size:"mini",disabled:!!e.disabled&&e.disabled(n.row),icon:t.iconFn(e),plain:e.plain,type:t._f("typeFn")(e.type,n.row)},on:{click:function(t){return e.clickFun(n.row)}}},[t._v(" "+t._s(e.name)+" ")]):t._e(),"upload"==e.type?i("el-upload",{directives:[{name:"show",rawName:"v-show",value:!e.showHide||e.showHide(n.row),expression:"o.showHide ? o.showHide(scope.row) : true"}],key:t.uploadKeys[n.$index],ref:"uploadRef",refInFor:!0,staticStyle:{display:"inline-block",width:"50px"},attrs:{action:t.javaApi+e.url+"?id="+(e.uploadIdFun?e.uploadIdFun(n.row):n.row.id),size:"mini",multiple:!!e.multiple&&e.multiple,limit:1,disabled:!!e.disabled&&e.disabled(n.row),accept:e.accept?e.accept:".jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.zip,.rar",headers:t.uploadHeader,"before-upload":function(e){return t.beforeUpload(e,n.$index)},"on-change":function(e,i){return t.handleChange(e,i,n.$index)},"on-error":function(e,i,r){return t.onError(e,i,r,n.$index)},"on-success":function(e,i,r){return t.handleSuccessUp(e,i,r,n.$index)},"on-exceed":t.onExceed,"show-file-list":!1}},[i("el-button",{attrs:{size:e.size?e.size:"small",type:"text",disabled:!!e.disabled&&e.disabled(n.row)}},[t._v(t._s(e.name)+" ")])],1):t._e()]}))],2):"link"==e.dataType?i("div",{staticClass:"cell link",staticStyle:{width:"100%"},on:{click:function(i){return t.goLink(n.row,e.linkMethod)}}},[e.formatData?t._e():i("span",[t._v(t._s(n.row[e.prop]))])]):i("div",{staticClass:"cell",staticStyle:{width:"100%"}},[e.formatData?i("span",[t._v(t._s(t._f("formatters")(n.row[e.prop],e.formatData)))]):i("span",[t._v(t._s(n.row[e.prop]))])])]}}],null,!0)})}))],2),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.page.total>0,expression:"page.total > 0"}],attrs:{total:t.page.total,layout:t.page.layout,page:t.page.current,limit:t.page.size},on:{"update:page":function(e){return t.$set(t.page,"current",e)},"update:limit":function(e){return t.$set(t.page,"size",e)},pagination:t.pagination}})],1)},r=[],a=(i("7db0"),i("caad"),i("14d9"),i("b0c0"),i("d3b7"),i("2532"),i("0643"),i("fffc"),i("4e3e"),i("159b"),{name:"ZTTable",filters:{typeFn:function(t,e){return"function"===typeof t?t(e):t},describeConts:function(t,e){return"function"===typeof e?e(t):t},formatters:function(t,e){return"function"===typeof e?e(t):t}},props:{isSelection:{type:Boolean,default:!1},height:{type:String,default:null},tableLoading:{type:Boolean,default:!1},handleSelectionChange:{type:Function,default:function(){return function(){}}},rowClick:{type:Function,default:function(){return function(){}}},currentChange:{type:Function,default:function(){return function(){}}},border:{type:Boolean,default:!0},highlightCurrentRow:{type:Boolean,default:!1},headerCellStyle:{type:Object,default:function(){return{}}},column:{type:Array,default:function(){return[]}},rowClassName:{type:Function,default:function(){}},rowStyle:{type:Object||Function,default:function(){return null}},tableData:{type:Array,default:function(){return[]}},rowKey:{type:String,default:void 0},page:{type:Object,default:function(){return{total:0,current:0,size:10,layout:"total, sizes, prev, pager, next, jumper"}}}},data:function(){return{spanList:[],btnWidth:"120px",uploadRefs:[],currentFiles:{},uploadKeys:{}}},mounted:function(){var t=this;this.calculateSpanInfo(),this.$nextTick((function(){t.$refs.multipleTable.doLayout(),t.tableData.forEach((function(e,i){t.$refs.uploadRef&&(t.$refs.uploadRef[i]=t.$refs.uploadRef[i]||{})}))}))},watch:{tableData:{handler:function(){var t=this;this.tableData.forEach((function(e,i){t.$set(t.uploadKeys,i,Date.now())}))},immediate:!0}},methods:{getWidth:function(t,e){var i=0;return t.forEach((function(t){void 0!==t.showHide&&t.showHide(e)?i+=t.name.length:t.showHide||(i+=t.name.length)})),this.btnWidth=15*i+60+"px",15*i+60+"px"},getTitleWidth:function(t){if(t.label.includes("时间")||t.label.includes("编号")||t.label.includes("样品名称")||t.label.includes("零件"))return 160;if(t.label.includes("操作"))return t.width;var e=document.createElement("span");e.innerText=t.label,document.body.appendChild(e);var i="".concat(e.offsetWidth+50,"px");return document.body.removeChild(e),i},iconFn:function(t){return"编辑"===t.name||"修改"===t.name?"el-icon-edit":"查看"===t.name?"el-icon-view":t.icon},formatType:function(t,e){return"function"===typeof e?e(t):""},dataTypeFn:function(t,e){return"function"===typeof e?e(t):t},setCurrent:function(t){this.$refs.multipleTable.setCurrentRow()},handleSuccessUp:function(t,e,i,n){200==t.code?(this.uploadRefs[n]&&this.uploadRefs[n].clearFiles(),this.currentFiles[n]=e,this.$message.success("上传成功"),this.resetUploadComponent(n)):this.$message.error(t.message)},resetUploadComponent:function(t){this.uploadKeys[t]=Date.now()},handleChange:function(t,e,i){if(e.length>1){var n=e[0];this.uploadRefs[i].handleRemove(n)}this.currentFiles[i]=t},beforeUpload:function(t,e){return this.currentFiles[e]={},!(t.size>10485760)||(this.$message.error("上传文件不超过10M"),!1)},onError:function(t,e,i,n){this.$message.error("文件上传失败，请重试"),this.uploadRefs[n]&&this.uploadRefs[n].clearFiles()},onExceed:function(){this.$message.warning("超出文件个数")},pagination:function(t){var e=t.page,i=t.limit;this.$emit("pagination",{page:e,limit:i})},indexMethod:function(t){return(this.page.current-1)*this.page.size+t+1},goLink:function(t,e){if(!e)return this.$message.warning("请配置lingk事件");this.$parent[e](t)},calculateSpanInfo:function(){var t=this;this.spanList=[],this.column.forEach((function(e,i){e.mergeCol&&t.spanList.push({arr:[],position:0,name:e.prop,index:i+1})})),this.spanList.forEach((function(e,i){t.rowspan(t.spanList[i].arr,t.spanList[i].position,e.name)}))},rowspan:function(t,e,i){var n=this;this.tableData.forEach((function(r,a){0===a?(t.push(1),e=0):n.tableData[a][i]===n.tableData[a-1][i]?(t[e]+=1,t.push(0)):(t.push(1),e=a)}))},spanMethod:function(t){t.row,t.column;var e=t.rowIndex,i=t.columnIndex;if(this.column.find((function(t){return t.mergeCol}))){var n=null,r=this.spanList.find((function(t,e){return n=e,t.index==i}));if(r){var a=this.spanList[n].arr[e],o=a>0?1:0;return{rowspan:a,colspan:o}}}}}}),o=a,s=(i("a320"),i("2877")),l=Object(s["a"])(o,n,r,!1,null,"3bf5dfdc",null);e["a"]=l.exports},"132c":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"up-pdf-stamp"},[t.isUpFile?i("div",{staticClass:"work",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"10px"}},[i("input",{ref:"fileInput",attrs:{type:"file",accept:"application/pdf"},on:{change:t.handleFileUpload}})]):t._e(),t.canvasNumPages>0?i("div",{staticStyle:{color:"red","font-size":"12px",margin:"16px 0"}},[t._v("提示：在文件范围内，单击鼠标盖章，双击鼠标已盖好章处可删除当前章")]):t._e(),t._l(t.canvasNumPages,(function(e,n){return i("canvas",{key:n,ref:"pdfCanvas",refInFor:!0,staticStyle:{border:"1px solid #000"},on:{click:function(e){return t.handleCanvasClick(e,n)},dblclick:function(e){return t.removeStamp(e,n)}}})}))],2)},r=[],a=i("c14f"),o=i("1da1"),s=(i("c740"),i("caad"),i("14d9"),i("a434"),i("c19f"),i("ace4"),i("2c66"),i("249d"),i("40e9"),i("b0c0"),i("d3b7"),i("2532"),i("5cc6"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("986a"),i("1d02"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("6ce5"),i("2834"),i("72f7"),i("4ea1"),i("0643"),i("4e3e"),i("159b"),i("8baf")),l=(i("0e9a"),{props:["isUpFile"],data:function(){return{pdfDoc:null,stamps:[],contextList:[],canvasNumPages:0,stampWidth:120,stampHeight:80,stampsName:"",stampsList:["主任","质量负责人","技术负责人","综合室","通信","电力","装备","储能","射频"],fileName:"文件名"}},methods:{handleFileUpload:function(t){var e=t.target.files[0];if(e.size>20971520)return this.$refs.fileInput.value="",this.$message.error("文件大小不能超过20M");this.lookFile(e)},lookFile:function(t,e){var i=this;if(this.fileName=t.name,e)this.stampsName=e;else{var n=this.stampsList.indexOf((function(e){return t.name.includes(e)}));this.stampsName=n>-1?this.stampsList[n]:"综合室"}if(t&&"application/pdf"===t.type){var r=new FileReader;r.onload=function(t){var e=new Uint8Array(t.target.result);i.loadPDF(e)},r.readAsArrayBuffer(t)}else this.$message.error("请选择 PDF 文件")},loadPDF:function(t){var e=this;pdfjsLib.getDocument(t).promise.then((function(t){e.pdfDoc=t,e.canvasNumPages=e.pdfDoc._pdfInfo.numPages,e.stamps=[],e.contextList=[];for(var i=function(t){e.$nextTick((function(){e.renderPage(t)})),e.stamps.push([])},n=1;n<=e.canvasNumPages;n++)i(n)}))},renderPage:function(t){var e=this;this.pdfDoc.getPage(t).then((function(i){var n=e.$refs.pdfCanvas[t-1];e.contextList.push(n.getContext("2d"));var r=i.getViewport({scale:1.5});n.width=r.width,n.height=r.height,i.render({canvasContext:e.contextList[t-1],viewport:r}).promise.then((function(){e.stamps[t-1].forEach((function(i){e.drawStamps(i.x,i.y,t-1)}))}))}))},handleCanvasClick:function(t,e){var i=this,n=t.offsetX,r=t.offsetY,a=this.stamps[e].findIndex((function(t){var e=n-t.x,a=r-t.y;return e>0&&e<i.stampWidth&&a>0&&a<i.stampHeight}));a>-1||(this.drawStamps(n,r,e),this.stamps[e].push({x:n,y:r}))},removeStamp:function(t,e){var i=this,n=t.offsetX,r=t.offsetY,a=this.stamps[e].findIndex((function(t){var e=n-t.x,a=r-t.y;return e>0&&e<i.stampWidth&&a>0&&a<i.stampHeight}));-1!==a&&(this.stamps[e].splice(a,1),this.contextList[e].clearRect(0,0,this.contextList[e].width,this.contextList[e].height),this.renderPage(e+1))},drawStamps:function(t,e,n){var r=new Image;r.src=i("a436")("./"+this.stampsName+".png");var a=this;r.onload=function(){a.contextList[n].drawImage(r,t,e,a.stampWidth,a.stampHeight)}},generatePDF:function(){var t=this;return Object(o["a"])(Object(a["a"])().m((function e(){var i,n,r,o,l,c;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:if(0!==t.contextList.length){e.n=1;break}return t.$message({message:"请先上传PDF文件",type:"error"}),t.$emit("uploadPDFErr"),e.a(2,!1);case 1:for(i=new s["a"]("p","mm","a4"),n=0;n<t.contextList.length;n++)r=t.$refs.pdfCanvas[n].toDataURL("image/jpeg",.7),o=i.internal.pageSize.getWidth(),l=t.$refs.pdfCanvas[n].height*o/t.$refs.pdfCanvas[n].width,i.addImage(r,"JPEG",0,0,o,l),n!==t.contextList.length-1&&i.addPage();return c=i.output("blob"),e.a(2,t.$emit("uploadPDF",c,t.fileName))}}),e)})))()}}}),c=l,u=i("2877"),d=Object(u["a"])(c,n,r,!1,null,"3693f85c",null);e["a"]=d.exports},2433:function(t,e,i){},"3ad9":function(t,e,i){"use strict";i("c489")},"715fe":function(t,e,i){},"76f3":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"content",staticClass:"scroll-pagination",on:{scroll:t.onScroll}},[t._t("default"),!t.finishLoding&&t.isLoding?i("el-button",{staticStyle:{display:"flex",margin:"0 auto",color:"#909399"},attrs:{type:"text"}},[i("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"20px"}})]):t._e(),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.finishLoding,expression:"finishLoding"}],staticStyle:{display:"flex",margin:"0 auto",color:"#909399"},attrs:{type:"text"}},[t._v("已经没有更多啦~")])],2)},r=[],a=i("2909"),o=(i("a630"),i("3ca3"),{name:"ScrollPagination",props:{finishLoding:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}}},watch:{list:{deep:!0,handler:function(){this.isLoding=!1}}},data:function(){return{isLoding:!1}},created:function(){this.onScroll=this.debounce(this.scrollFn,500)},mounted:function(){},methods:{onScroll:function(){},scrollFn:function(){var t=this.$refs.content;t.scrollTop+t.clientHeight+2>=t.scrollHeight&&(this.finishLoding?this.isLoding=!1:this.loadMore())},loadMore:function(){var t=this;this.isLoding||(this.isLoding=!0,setTimeout((function(){t.$emit("load")}),500))},debounce:function(t,e){var i=null;return function(){var n=arguments;i&&(clearTimeout(i),i=null),i=setTimeout((function(){t.apply(void 0,Object(a["a"])(n))}),e)}},throttle:function(t,e){var i=null;return function(){var n=Array.from(arguments);null===i&&(i=setTimeout((function(){t.apply(void 0,n),clearTimeout(i),i=null}),e))}}}}),s=o,l=(i("3ad9"),i("2877")),c=Object(l["a"])(s,n,r,!1,null,"a9aed072",null);e["a"]=c.exports},"78e8":function(t,e,i){"use strict";i("715fe")},"7c6c":function(t,e,i){},a320:function(t,e,i){"use strict";i("7c6c")},a408:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isImage?i("div",[i("img",{attrs:{src:t.imgUrl,alt:"Image Preview"}})]):t._e(),t.isPdf?i("div",[i("object",{attrs:{data:t.fileUrl,type:"application/pdf",width:"100%",height:"750px"}},[i("p",[t._v("您的浏览器不支持 PDF 预览。"),i("a",{staticStyle:{color:"#3a7bfa"},attrs:{href:t.fileUrl,target:"_blank"}},[t._v("下载 PDF 文件")])])])]):t._e(),t.isDoc?i("div",[t.isDocShow?t._e():i("p",[t._v("文档无法直接预览，请下载查看。")]),t.isDocShow?i("vue-office-docx",{staticStyle:{height:"100vh"},attrs:{src:t.fileUrl},on:{rendered:t.renderedHandler,error:t.errorHandler}}):i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])],1):t._e(),t.isXls?i("div",[t.isDocShow?t._e():i("p",[t._v("文档无法直接预览，请下载查看。")]),t.isDocShow?i("vue-office-excel",{staticStyle:{height:"100vh"},attrs:{src:t.fileUrl,options:t.options},on:{rendered:t.renderedHandler,error:t.errorHandler}}):i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])],1):t._e(),t.isZipOrRar?i("div",[i("p",[t._v("压缩文件无法直接预览，请下载查看。")]),i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])]):t._e(),t.isCsv?i("div",[0==t.csvList.length?i("p",[t._v("CSV 文件无法直接预览，请下载查看。")]):t._e(),0==t.csvList.length?i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")]):t._e(),t.csvList.length>0?i("el-tabs",{attrs:{type:"border-card","tab-position":"bottom"}},t._l(t.csvList,(function(e,n){return i("el-tab-pane",{key:n,attrs:{label:e.sheetName}},[i("el-table",{attrs:{data:e.tableData,height:"75vh"}},t._l(e.column,(function(e,n){return i("el-table-column",{key:n,attrs:{label:e.label,prop:e.prop,"min-width":"120px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(n){return[i("div",[i("el-tooltip",{attrs:{content:e.label,placement:"top"}},[i("div",{staticClass:"oneLine"},[i("span",[t._v(t._s(e.label))])])])],1)]}}],null,!0)})})),1)],1)})),1):t._e()],1):t._e(),t.isSupported?t._e():i("div",[i("p",[t._v("不支持的文件格式")])])])},r=[],a=i("b85c"),o=i("c14f"),s=i("1da1"),l=(i("d81d"),i("14d9"),i("d3b7"),i("ac1f"),i("00b4"),i("5319"),i("5b81"),i("498a"),i("0643"),i("a573"),i("2d46")),c=i.n(l),u=(i("d457"),i("b690")),d=i.n(u),p=(i("2c3a"),{components:{VueOfficeDocx:c.a,VueOfficeExcel:d.a},props:{fileUrl:{type:String,required:!0},currentFile:{type:Object,required:!0}},data:function(){return{isDocShow:!0,options:{xls:!1,minColLength:0,minRowLength:0,widthOffset:10,heightOffset:10,beforeTransformData:function(t){return t},transformData:function(t){return t}},csvList:[],imgUrl:""}},computed:{isImage:function(){var t=/\.(jpg|jpeg|png|gif)$/i.test(this.fileUrl);return this.imgUrl=this.fileUrl,t&&(this.imgUrl=this.fileUrl.replaceAll("word","img")),t},isPdf:function(){return/\.pdf$/i.test(this.fileUrl)},isDoc:function(){return/\.(doc|docx)$/i.test(this.fileUrl)},isXls:function(){var t=/\.(xls|xlsx)$/i.test(this.fileUrl);return t&&(/\.(xlsx)$/i.test(this.fileUrl)?this.options.xls=!1:this.options.xls=!0),t},isZipOrRar:function(){return/\.(zip|rar)$/i.test(this.fileUrl)},isCsv:function(){var t=/\.csv$/i.test(this.fileUrl);return t&&this.loadCSVData(),t},isSupported:function(){return this.isImage||this.isPdf||this.isDoc||this.isZipOrRar||this.isCsv||this.isXls}},methods:{renderedHandler:function(){console.log("渲染完成"),this.isDocShow=!0,this.resetStyle()},errorHandler:function(){console.log("渲染失败"),this.isDocShow=!1},loadCSVData:function(){var t=this;return Object(s["a"])(Object(o["a"])().m((function e(){return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:t.$axios.post(t.$api.insOrderPlan.preview,{id:t.currentFile.id}).then((function(e){var i=e.data;i=i.map((function(e){var i={sheetName:e.sheetName,tableData:[],column:[]};for(var n in i.tableData=t.formatCSVToTable(e.content.replaceAll("null"," ")),i.tableData[0])i.column.push({label:n,prop:n});return i})),t.csvList=i})).catch((function(t){console.log(t)}));case 1:return e.a(2)}}),e)})))()},formatCSVToTable:function(t){var e=[],i=t.split("\n"),n=[];for(var r in i)if("string"===typeof i[r]&&i[r].length>0){var a="".concat(i[r]);if(a.trim().length>0){var o=i[r].split(",");if(0==r)n=o;else{for(var s={},l=0;l<n.length;l++){var c=String(n[l]);if(n[l]&&!s[c])try{o[l]?s[c]=String(o[l]):s[c]=""}catch(u){s[c]=""}}e.push(s)}}}return e},resetStyle:function(){var t,e=document.querySelectorAll('[style*="pt"]'),i=Object(a["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.getAttribute("style");r&&n.setAttribute("style",r.replace(/pt/g,"px"))}}catch(o){i.e(o)}finally{i.f()}}}}),f=p,h=(i("a529"),i("2877")),m=Object(h["a"])(f,n,r,!1,null,"397a2a88",null);e["a"]=m.exports},a529:function(t,e,i){"use strict";i("2433")},b9f5:function(t,e,i){},c489:function(t,e,i){},d16c:function(t,e,i){"use strict";i("b9f5")},e317:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"vabOnlyOffice"}})},r=[],a=i("c14f"),o=i("1da1"),s=(i("caad"),i("b0c0"),{name:"VabOnlyOffice",props:["options"],data:function(){return{doctype:"",docEditor:null,option:{url:"",isEdit:!1,fileType:"",title:"",lang:"zh-CN",isPrint:!0,user:{},editUrl:""}}},created:function(){if(this.options){var t=this.options;this.option.url=t.url,this.option.isEdit="true"===t.isEdit,this.option.fileType=t.fileType,this.option.title=t.title,this.option.lang=t.lang,this.option.isPrint=t.isPrint,this.option.user.id=t.user_id,this.option.user.name=t.user_name,this.option.editUrl=t.editUrl}else{var e=this.$route.query;this.option.url=e.url,this.option.isEdit="true"===e.isEdit,this.option.fileType=e.fileType,this.option.title=e.title,this.option.lang=e.lang,this.option.isPrint=e.isPrint,this.option.user.id=e.user_id,this.option.user.name=e.user_name,this.option.editUrl=e.editUrl}},beforeDestroy:function(){null!==this.docEditor&&(this.docEditor.destroyEditor(),this.docEditor=null)},watch:{option:{handler:function(t){this.setEditor(t),this.doctype=this.getFileType(t.fileType)},deep:!0}},mounted:function(){this.option.url&&this.setEditor(this.option)},methods:{setEditor:function(t){var e=this;return Object(o["a"])(Object(a["a"])().m((function i(){var n;return Object(a["a"])().w((function(i){while(1)switch(i.n){case 0:null!==e.docEditor&&(e.docEditor.destroyEditor(),e.docEditor=null),e.doctype=e.getFileType(t.fileType),n={document:{fileType:t.fileType,key:t.key||"",title:t.title,permissions:{edit:t.isEdit,print:t.isPrint,download:!1},url:t.url},documentType:e.doctype,editorConfig:{callbackUrl:t.editUrl,lang:t.lang,customization:{autosave:!0,chat:!0,comments:!1,help:!1,hideRightMenu:!1,plugins:!1},user:{id:t.user.id,name:t.user.name},mode:t.model?t.model:"edit"},width:"100%",height:"100%",token:t.token||""},e.docEditor=new DocsAPI.DocEditor("vabOnlyOffice",n);case 1:return i.a(2)}}),i)})))()},getFileType:function(t){var e="",i=["doc","docm","docx","dot","dotm","dotx","epub","fodt","htm","html","mht","odt","ott","pdf","rtf","txt","djvu","xps"],n=["csv","fods","ods","ots","xls","xlsm","xlsx","xlt","xltm","xltx"],r=["fodp","odp","otp","pot","potm","potx","pps","ppsm","ppsx","ppt","pptm","pptx"];return i.includes(t)&&(e="text"),n.includes(t)&&(e="spreadsheet"),r.includes(t)&&(e="presentation"),e}}}),l=s,c=(i("78e8"),i("2877")),u=Object(c["a"])(l,n,r,!1,null,"461b74be",null);e["a"]=u.exports},fd54:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{ref:"chart",style:t.chartStyle,attrs:{id:"id"}})])},r=[],a=(i("d3b7"),i("0643"),i("4e3e"),i("159b"),i("313e")),o=(i("eec4"),{name:"EChart",props:{options:{type:Object,default:function(){return{}}},chartStyle:{type:Object,default:function(){return{height:"80%",width:"100%"}}},dataset:{type:Object,default:function(){}},xAxis:{type:Array,default:function(){return[]}},yAxis:{type:Array,default:function(){return[]}},series:{type:Array,default:function(){return[]}},grid:{type:Object,default:function(){return{}}},legend:{type:Object,default:function(){return{}}},tooltip:{type:Object,default:function(){return{}}},lineColors:{type:Array,default:function(){return["#A4EEDA","#86C1F4","#91A0FC","#F6C18B","#F09595"]}},barColors:{type:Array,default:function(){return["#A4EEDA","#86C1F4","#91A0FC","#F6C18B","#F09595"]}},pieColors:{type:Array,default:function(){return["#A4EEDA","#86C1F4","#91A0FC","#F6C18B","#F09595"]}},loadingOption:{type:Object,default:function(){return{text:"数据加载中...",color:"#00BAFF",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0}}}},data:function(){return{chartInstance:null}},watch:{options:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},series:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},dataset:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},xAxis:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},yAxis:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},grid:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},legend:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},tooltip:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},lineColors:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},barColors:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}},pieColors:{deep:!0,handler:function(t){var e=this;this.$nextTick((function(){e.renderChart()}))}}},mounted:function(){this.chartInstance=a["init"](this.$refs.chart),this.renderChart(),window.addEventListener("resize",this.windowResizeListener)},beforeDestroy:function(){this.dispose()},methods:{windowResizeListener:function(){this.chartInstance&&(this.dispose(),this.chartInstance=a["init"](this.$refs.chart),this.renderChart(),this.chartInstance.resize())},renderChart:function(){var t={backgroundColor:this.options.backgroundColor||"#fff",xAxis:this.xAxis,yAxis:this.yAxis,dataset:this.dataset,series:this.series,grid:this.grid,legend:this.legend,tooltip:this.tooltip};this.generateChart(t)},generateChart:function(t){var e=this;t.series&&t.series.length>0&&t.series.forEach((function(t,i){"line"===t.type?(t.itemStyle={color:e.lineColors[i]||e.lineColors[0]},t.lineStyle={color:e.lineColors[i]||e.lineColors[0]}):"bar"===t.type&&(t.itemStyle={color:e.barColors[i]||e.barColors[0]})})),this.chartInstance.clear(),this.chartInstance.setOption(t)},dispose:function(){this.chartInstance&&(window.removeEventListener("resize",this.chartInstance.resize),this.chartInstance.dispose(),this.chartInstance=null)}}}),s=o,l=(i("d16c"),i("2877")),c=Object(l["a"])(s,n,r,!1,null,"9be3d31a",null);e["a"]=c.exports}}]);