(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8a7c8908"],{4201:function(e,t,o){"use strict";o("5cf5")},"4d5a":function(e,t,o){"use strict";o("cef0")},"5cf5":function(e,t,o){},9005:function(e,t,o){"use strict";o("dd06")},ad35:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"capacity-scope"},[o("div",{staticClass:"search"},[o("div",{staticClass:"search_box"},[o("div",{staticClass:"search_item"},[o("span",{staticClass:"search_label"},[e._v("模板名称")]),o("el-input",{attrs:{clearable:"",placeholder:"请输入",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable()}},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1),o("div",{staticClass:"search_button"},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.refreshTable}},[e._v("查询")]),o("el-button",{attrs:{size:"mini"},on:{click:e.refresh}},[e._v("重置")])],1)]),o("div",[e.checkPermi(["standard:model:add"])?o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.openAdd}},[e._v("新增")]):e._e()],1)]),o("lims-table",{attrs:{tableData:e.tableData,column:e.column,page:e.page,tableLoading:e.tableLoading,height:"calc(100vh - 250px)"},on:{pagination:e.pagination}}),o("el-dialog",{attrs:{"before-close":e.isClose,"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.isShow,title:"模板编制",width:"85%"},on:{"update:visible":function(t){e.isShow=t}}},[e.isShow?o("div",{staticStyle:{width:"100%",height:"82vh",overflow:"auto"}},[o("Excel",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.row.thing,execlTitle:e.row.name}})],1):e._e()]),o("el-dialog",{attrs:{"before-close":e.closeCopyTem,"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.isShowCopyTem,title:e.title,width:"35%","modal-append-to-body":!1},on:{"update:visible":function(t){e.isShowCopyTem=t}}},[o("el-form",{ref:"copyForm",attrs:{model:e.copyForm,rules:e.copyFormRules,"label-position":"right","label-width":"80px"}},[o("el-form-item",{attrs:{label:"模版编号",prop:"number"}},[o("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.copyForm.number,callback:function(t){e.$set(e.copyForm,"number",t)},expression:"copyForm.number"}})],1),o("el-form-item",{attrs:{label:"模版名称",prop:"name"}},[o("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.copyForm.name,callback:function(t){e.$set(e.copyForm,"name",t)},expression:"copyForm.name"}})],1),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.copyForm.remark,callback:function(t){e.$set(e.copyForm,"remark",t)},expression:"copyForm.remark"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeCopyTem}},[e._v("取 消")]),o("el-button",{attrs:{loading:e.submitCopyInfoLoading,type:"primary"},on:{click:e.submitCopyInfo}},[e._v("确 定")])],1)],1)],1)},n=[],i=o("5530"),r=(o("a434"),o("b0c0"),o("e9c4"),o("d3b7"),o("0643"),o("4e3e"),o("159b"),o("00d5")),l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"luckysheet"}})},s=[],c=(o("b64b"),{props:["data","execlTitle"],data:function(){return{}},mounted:function(){var e=this;this.$nextTick((function(){e.templateWrite()}))},methods:{templateWrite:function(){var e={};if(null!=this.data&&""!=this.data)e=JSON.parse(this.data);else{for(var t={},o={},a=0;a<50;a++)t[""+a]=40;for(var n=0;n<26;n++)o[""+n]=100;e={data:[{name:"模板",order:"0",config:{rowlen:t,columnlen:o}}],row:50,column:26}}e.title=this.execlTitle,e.container="luckysheet",e.lang="zh",e.showsheetbar=!1,e.defaultFontSize=14,e.showstatisticBarConfig={view:!1},e.enableAddRow=!1,e.enableAddBackTop=!1,e.showtoolbarConfig={chart:!1,pivotTable:!1,protection:!1,dataVerification:!1,frozenMode:!1,currencyFormat:!1,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,strikethrough:!1,underline:!1,italic:!1,textWrapMode:!0,textRotateMode:!1,conditionalFormat:!1,splitColumn:!1},e.cellRightClickConfig={copyAs:!1,hideRow:!1,hideColumn:!1,sort:!1,filter:!1,chart:!1,image:!1,matrix:!1,data:!1,cellFormat:!1},e.myFolderUrl=this.LOCATIONVUE+"/",e.functionButton='<i class="save_i el-icon-info" title="系统支持的变量：&#10样品编号&#10样品型号&#10序号&#10检验项&#10检验子项&#10设备名称&#10设备编码&#10单位&#10要求值&#10试验方法 | 检测方法&#10最终值&#10结论&#10计算值&#10检验值"></i><button onClick="returnView()" class="returnView">取消</button><button onClick="excelClosed()" class="save">保存</button>',console.log(luckysheet),luckysheet.create(e)}}}),d=c,u=(o("9005"),o("4d5a"),o("2877")),m=Object(u["a"])(d,l,s,!1,null,"158406c0",null),p=m.exports,h=o("b775");function f(e){return Object(h["a"])({url:"/StandardTemplate/selectStandardTemplatePageList",method:"get",params:e})}function b(e){return Object(h["a"])({url:"/StandardTemplate/copyStandardTemplate",method:"post",data:e})}function g(e){return Object(h["a"])({url:"/StandardTemplate/addStandardTemplate",method:"post",data:e})}function y(e){return Object(h["a"])({url:"/StandardTemplate/upStandardTemplate",method:"post",data:e})}function v(e){return Object(h["a"])({url:"/StandardTemplate/delStandardTemplate",method:"delete",params:e})}function w(e){return Object(h["a"])({url:"/StandardTemplate/getEditTemplatePreparation",method:"get",params:e})}var T={name:"Model",components:{Excel:p,limsTable:r["a"]},data:function(){var e=this;return{addPower:!0,isShow:!1,loading:!1,title:"新增",row:{id:null,thing:null,name:null},isShowCopyTem:!1,submitCopyInfoLoading:!1,copyForm:{number:"",name:"",remark:"",id:""},copyFormRules:{name:[{required:!0,message:"请输入模版名称",trigger:"blur"}]},queryParams:{name:null},tableData:[],column:[{label:"模板编号",prop:"number"},{label:"模板名称",prop:"name"},{label:"备注",prop:"remark"},{label:"创建用户",prop:"createUserName"},{label:"创建时间",prop:"createTime",width:"160"},{label:"更新用户",prop:"updateUserName"},{label:"修改时间",prop:"updateTime",width:"160"},{dataType:"action",label:"操作",operation:[{name:"编辑",type:"text",clickFun:function(t){e.title="编辑",e.copyForm=e.HaveJson(t),e.isShowCopyTem=!0},showHide:function(t){return e.checkPermi(["standard:model:edit"])}},{name:"删除",type:"text",clickFun:function(t){e.handleDelete(t)},showHide:function(t){return e.checkPermi(["standard:model:del"])}},{name:"复制模板",type:"text",clickFun:function(t){e.copyTemplate(t)},showHide:function(t){return e.checkPermi(["standard:model:copy"])}},{name:"模板编制",type:"text",clickFun:function(t){e.templateWrite(t)},showHide:function(t){return e.checkPermi(["standard:model:edit","standard:model:add"])}}]}],page:{total:0,size:10,current:0},tableLoading:!1}},mounted:function(){window.excelClosed=this.confirmSave,window.returnView=this.returnView,this.getList()},methods:{getList:function(){var e=this;this.tableLoading=!0;var t=Object(i["a"])(Object(i["a"])({},this.queryParams),this.page);delete t.total,f(Object(i["a"])({},t)).then((function(t){e.tableLoading=!1,200===t.code&&(e.tableData=t.data.records,e.page.total=t.data.total)})).catch((function(t){e.tableLoading=!1}))},pagination:function(e){var t=e.page,o=e.limit;this.page.current=t,this.page.size=o,this.getList()},refreshTable:function(e){e&&"function"===typeof e.preventDefault&&e.preventDefault(),this.page.current=1,this.getList()},refresh:function(){this.queryParams={},this.page.current=1,this.getList()},openAdd:function(){this.title="新增",this.copyForm={},this.isShowCopyTem=!0},copyTemplate:function(e){this.title="复制模版",this.isShowCopyTem=!0,this.copyForm.id=e.id},submitCopyInfo:function(){var e=this;this.$refs["copyForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.submitCopyInfoLoading=!0;var o={id:e.copyForm.id,name:e.copyForm.name,number:e.copyForm.number,remark:e.copyForm.remark};switch(e.title){case"新增":delete o.id,g(o).then((function(t){e.isShowCopyTem=!1,e.submitCopyInfoLoading=!1,e.$message.success("新增成功"),e.refreshTable("page")})).catch((function(t){console.log("copyTemplate----",t),e.submitCopyInfoLoading=!1}));break;case"编辑":o.thing=e.copyForm.thing?e.copyForm.thing:"",y(o).then((function(t){e.isShowCopyTem=!1,e.submitCopyInfoLoading=!1,e.$message.success("修改成功"),e.refreshTable("page")})).catch((function(t){console.log("copyTemplate----",t),e.submitCopyInfoLoading=!1}));break;case"复制模版":b(o).then((function(t){e.isShowCopyTem=!1,e.submitCopyInfoLoading=!1,e.$message.success("复制成功"),e.refreshTable("page")})).catch((function(t){console.log("copyTemplate----",t),e.submitCopyInfoLoading=!1}));break}}))},closeCopyTem:function(){this.$refs.copyForm.resetFields(),this.isShowCopyTem=!1},handleDelete:function(e){var t=this;this.$confirm("是否删除该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){v({id:e.id}).then((function(e){t.$message.success("删除成功"),t.refreshTable("page")}))})).catch((function(){}))},templateWrite:function(e){var t=this;w({id:e.id}).then((function(o){200==o.code&&(t.row=e,t.row.thing=o.data,t.isShow=!0)}))},returnView:function(){this.isShow=!1},confirmSave:function(){var e=this;this.$confirm("是否需要保存?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.closed()})).catch((function(){}))},closed:function(){var e=this;this.loading=!0;var t=luckysheet.toJson();if(delete t.title,delete t.container,delete t.lang,delete t.showsheetbar,delete t.showstatisticBarConfig,delete t.enableAddRow,delete t.enableAddBackTop,delete t.showtoolbarConfig,delete t.cellRightClickConfig,delete t.myFolderUrl,delete t.functionButton,void 0!=t.data[0].config.borderInfo)for(var o=0;o<t.data[0].config.borderInfo.length;o++){var a=t.data[0].config.borderInfo;"range"===a[o].rangeType&&"border-none"===a[o].borderType&&(t.data[0].config.borderInfo.splice(o,1),o-=1)}t.data[0].celldata.forEach((function(e){void 0==e.v.ps||"检验值"!==e.v.ps.value&&"设备名称"!==e.v.ps.value&&"设备编码"!==e.v.ps.value&&"结论"!==e.v.ps.value||void 0===e.v.v&&(e.v.v="")})),y({id:this.row.id,thing:JSON.stringify(t),name:luckysheet.getWorkbookName(["name"])}).then((function(t){e.loading=!1,e.$message.success("已保存"),e.isShow=!1}))},isClose:function(e){var t=this;this.$confirm("是否需要保存?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.closed()})).catch((function(){e()}))}}},k=T,C=(o("4201"),Object(u["a"])(k,a,n,!1,null,"d57b61b8",null));t["default"]=C.exports},cef0:function(e,t,o){},dd06:function(e,t,o){}}]);