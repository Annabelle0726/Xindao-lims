(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b15d3a4"],{1839:function(e,t,r){"use strict";r.d(t,"x",(function(){return i})),r.d(t,"n",(function(){return a})),r.d(t,"A",(function(){return o})),r.d(t,"z",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"i",(function(){return u})),r.d(t,"l",(function(){return c})),r.d(t,"u",(function(){return p})),r.d(t,"p",(function(){return m})),r.d(t,"y",(function(){return d})),r.d(t,"e",(function(){return b})),r.d(t,"m",(function(){return f})),r.d(t,"q",(function(){return h})),r.d(t,"t",(function(){return g})),r.d(t,"a",(function(){return v})),r.d(t,"h",(function(){return y})),r.d(t,"s",(function(){return w})),r.d(t,"g",(function(){return S})),r.d(t,"o",(function(){return j})),r.d(t,"v",(function(){return O})),r.d(t,"b",(function(){return k})),r.d(t,"w",(function(){return D})),r.d(t,"c",(function(){return x})),r.d(t,"k",(function(){return P})),r.d(t,"j",(function(){return I})),r.d(t,"r",(function(){return T})),r.d(t,"f",(function(){return L}));var n=r("b775");function i(e){return Object(n["a"])({url:"/fePowerStable/getLaboratoryFacilityPowerStablePage",method:"get",params:e})}function a(e){return Object(n["a"])({url:"/deviceScope/search",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/deviceScope/treeDevice",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/system/newUser/selectUserCondition",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/fePowerStable/addLaboratoryFacilityPowerStable",method:"post",data:e})}function u(e){return Object(n["a"])({url:"/fePowerStable/deleteFeMeasuredQuantity",method:"delete",params:e})}function c(e){return Object(n["a"])({url:"/fePowerStable/deleteLaboratoryFacilityPowerStable",method:"delete",params:e})}function p(e){return Object(n["a"])({url:"/fePowerStable/getFeMeasuredQuantityService",method:"get",params:e})}function m(e){return Object(n["a"])({url:"/fePowerStable/exportFePowerStable",method:"get",responseType:"blob",params:e})}function d(e){return Object(n["a"])({url:"/feLightningProtection/getLightningProtectionDetection",method:"get",params:e})}function b(e){return Object(n["a"])({url:"/feLightningProtection/addLightningProtectionDetection",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function f(e){return Object(n["a"])({url:"/feLightningProtection/deleteLightningProtectionDetection",method:"delete",params:e})}function h(e){return Object(n["a"])({url:"/feLightningProtection/exportOfLightningProtectionDetection",method:"get",responseType:"blob",params:e})}function g(e){return Object(n["a"])({url:"/feIllumination/getFeLightningProtection",method:"get",params:e})}function v(e){return Object(n["a"])({url:"/feIllumination/addFeLightningProtection",method:"post",data:e})}function y(e){return Object(n["a"])({url:"/feIllumination/deleteFeLightningProtection",method:"delete",params:e})}function w(e){return Object(n["a"])({url:"/feIllumination/getFeIlluminationDetectionArea",method:"get",params:e})}function S(e){return Object(n["a"])({url:"/feIllumination/deleteFeIlluminationDetectionArea",method:"delete",params:e})}function j(e){return Object(n["a"])({url:"/feIllumination/exportFeIllumination",method:"get",responseType:"blob",params:e})}function O(e){return Object(n["a"])({url:"/feTempHumDate/getFeTempHumDate",method:"get",params:e})}function k(e){return Object(n["a"])({url:"/feTempHumDate/addFeTempHumDate",method:"post",data:e})}function D(e){return Object(n["a"])({url:"/feTempHumDate/getFeTempHumRecordPage",method:"get",params:e})}function x(e){return Object(n["a"])({url:"/feTempHumDate/addFeTempHumRecord",method:"post",data:e})}function P(e){return Object(n["a"])({url:"/feTempHumDate/deleteFeTempHumRecord",method:"delete",params:e})}function I(e){return Object(n["a"])({url:"/feTempHumDate/deleteFeTempHumDate",method:"delete",params:e})}function T(e){return Object(n["a"])({url:"/feTempHumDate/exportTemperatureAndHumidityRecords",method:"get",responseType:"blob",params:e})}function L(e){return Object(n["a"])({url:"/feTempHumDate/affirmFeTempHumDate",method:"post",data:e})}},"8d19":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"view"},[r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[r("div",{staticStyle:{display:"flex"}},[r("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[r("span",{staticStyle:{width:"50px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("员工")]),r("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable(t)}},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),r("div",{staticStyle:{"line-height":"30px"}},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.refreshTable}},[e._v("查询")])],1)]),r("div",{staticStyle:{"line-height":"30px"}},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addPost}},[e._v("新增")])],1)]),r("div",{staticClass:"table"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"66.5vh","header-cell-style":{background:"#f8f8f9",color:"#515a6e"},border:""}},[r("el-table-column",{attrs:{label:"序号",type:"index",width:"60"}}),r("el-table-column",{attrs:{label:"员工编号","min-width":"120",prop:"account"}}),r("el-table-column",{attrs:{label:"岗位名称","min-width":"180",prop:"postName"}}),r("el-table-column",{attrs:{label:"所属部门","min-width":"180",prop:"departLimsName"}}),r("el-table-column",{attrs:{label:"工作目标","min-width":"180",prop:"jobObjective"}}),r("el-table-column",{attrs:{label:"岗位职责","min-width":"180",prop:"jobResponsibilities"}}),r("el-table-column",{attrs:{label:"任职人","min-width":"180",prop:"incumbentName"}}),r("el-table-column",{attrs:{label:"任职人审核日期","min-width":"180",prop:"incumbentDate"}}),r("el-table-column",{attrs:{label:"主管","min-width":"180",prop:"supervisorName"}}),r("el-table-column",{attrs:{label:"主管审核日期","min-width":"180",prop:"supervisorDate"}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDepartment&&"关闭"!==t.row.currentState?e._e():r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(r){return e.handleViewClick(t.row,"view")}}},[e._v("查看 ")]),e.isDepartment&&"关闭"!==t.row.currentState?r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(r){return e.handleViewClick(t.row,"edit")}}},[e._v("编辑 ")]):e._e(),r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(r){return e.downLoadPost(t.row)}}},[e._v("导出")]),e.isDepartment?r("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"small",type:"text"},on:{click:function(r){return e.deletePost(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),r("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":1,"page-size":e.search.size,"page-sizes":[10,20,30,50,100],total:e.search.total,layout:"->,total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.dialogVisible,title:"新增岗位职责",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[r("el-steps",{attrs:{active:e.currentStep,"align-center":"","finish-status":"success"}},e._l(e.steps,(function(t,n){return r("el-step",{key:n,staticStyle:{cursor:"pointer"},attrs:{title:t},nativeOn:{click:function(t){return e.choiceStep(n)}}})})),1),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"130px"}},[r("div",[r("el-card",{staticStyle:{"margin-top":"1em",height:"40vh","overflow-y":"scroll"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"岗位名称：",prop:"postName"}},[r("el-input",{attrs:{disabled:0!==e.currentStep||"view"===e.operationType,size:"small"},model:{value:e.form.postName,callback:function(t){e.$set(e.form,"postName",t)},expression:"form.postName"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"工作目标：",prop:"jobObjective"}},[r("el-input",{attrs:{disabled:0!==e.currentStep||"view"===e.operationType,size:"small",type:"textarea"},model:{value:e.form.jobObjective,callback:function(t){e.$set(e.form,"jobObjective",t)},expression:"form.jobObjective"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"岗位职责：",prop:"jobResponsibilities"}},[r("el-input",{attrs:{disabled:0!==e.currentStep||"view"===e.operationType,size:"small",type:"textarea"},model:{value:e.form.jobResponsibilities,callback:function(t){e.$set(e.form,"jobResponsibilities",t)},expression:"form.jobResponsibilities"}})],1)],1),0===e.currentStep||"view"===e.operationType?r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{rules:[{required:0===e.currentStep,message:"请选择任职人",trigger:"change"}],label:"任职人：",prop:"incumbentId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"view"===e.operationType,clearable:"",filterable:"",placeholder:"请选择任职人",size:"small"},model:{value:e.form.incumbentId,callback:function(t){e.$set(e.form,"incumbentId",t)},expression:"form.incumbentId"}},e._l(e.responsibleOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1):e._e(),1===e.currentStep||"view"===e.operationType?r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{rules:[{required:1===e.currentStep,message:"请选择主管",trigger:"blur"}],label:"主管：",prop:"supervisorId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{disabled:1!==e.currentStep||"view"===e.operationType,clearable:"",filterable:"",placeholder:"请选择主管",size:"small"},model:{value:e.form.supervisorId,callback:function(t){e.$set(e.form,"supervisorId",t)},expression:"form.supervisorId"}},e._l(e.responsibleOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1):e._e()],1)],1),r("el-row",{staticStyle:{"margin-top":"1em"}},[r("el-col",{attrs:{span:4}},[e._v(" 操作人："+e._s(e.form.submitPerson)+" ")]),r("el-col",{attrs:{span:6}},[e._v(" 日期："+e._s(e.form.submitDate)+" ")])],1)],1)]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[0!==e.currentStep&&3!==e.currentStep?r("el-button",{on:{click:function(t){return e.submitForm("3reject")}}},[e._v("驳回")]):e._e(),0===e.currentStep?r("el-button",{on:{click:function(t){return e.submitForm("2save")}}},[e._v("保存")]):e._e(),3!==e.currentStep?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("1submit")}}},[e._v(e._s(0===e.currentStep?"提交":"通过"))]):e._e()],1)],1)],1)},i=[],a=r("5530"),o=r("c14f"),s=r("1da1"),l=(r("b0c0"),r("a9e3"),r("ac1f"),r("841c"),r("c466")),u=r("b775");function c(e){return Object(u["a"])({url:"/personJobResponsibilities/personJobResponsibilitiesSelect",method:"get",params:e})}function p(e){return Object(u["a"])({url:"/personJobResponsibilities/personJobResponsibilitiesSave",method:"post",data:e})}function m(e){return Object(u["a"])({url:"/personJobResponsibilities/exportPersonJobResponsibilities",method:"post",params:e,responseType:"blob"})}function d(e){return Object(u["a"])({url:"/personJobResponsibilities/personJobResponsibilitiesDelete",method:"delete ",params:e})}var b=r("1839"),f=r("2f62"),h={data:function(){return{userName:"",tableData:[],tableLoading:!1,responsibleOptions:[],search:{size:20,current:1,total:0},dialogVisible:!1,currentStep:0,currentStepClick:0,operationType:"",steps:["提交","任职人确认","主管确认"],form:{postName:"",jobObjective:"",jobResponsibilities:"",incumbentId:"",supervisorId:""},rules:{postName:[{required:!0,message:"请输入岗位名称",trigger:"blur"}],jobObjective:[{required:!0,message:"请输入工作目标",trigger:"blur"}],jobResponsibilities:[{required:!0,message:"请输入岗位职责",trigger:"blur"}],incumbentId:[{required:!0,message:"请选择任职人",trigger:"change"}],supervisorId:[{required:!0,message:"请选择主管",trigger:"change"}]}}},props:{departId:{type:Number,default:function(){return null}},isDepartment:{type:Boolean,default:!1}},mounted:function(){this.getPostList(this.departId)},methods:{addPost:function(){this.dialogVisible=!0,this.form={postName:"",jobObjective:"",jobResponsibilities:"",incumbentId:"",supervisorId:"",submitPerson:"",submitDate:"",currentStep:0},this.currentStep=0,this.getUserList()},getPostList:function(e){var t=this;this.search.userId=e;var r=this.isDepartment?{userName:this.userName,departmentId:this.search.userId,size:this.search.size,current:this.search.current}:{userName:this.userName,userId:this.search.userId,size:this.search.size,current:this.search.current};this.tableLoading=!0,c(r).then((function(e){t.tableLoading=!1,t.tableData=e.data.records,t.search.total=e.data.total})).catch((function(e){t.tableLoading=!1}))},submitForm:function(e){var t=this;return Object(s["a"])(Object(o["a"])().m((function r(){return Object(o["a"])().w((function(r){while(1)switch(r.n){case 0:t.$refs.form.validate((function(r){if(!0===r||"1submit"!==e){var n,i=t.nickName,a=Object(l["a"])(new Date);switch(t.currentStep){case 0:t.form.submittingOperator=i.name,t.form.submittingDate=a;break;case 1:t.form.incumbentOperator=i.name,t.form.incumbentDate=a;break;case 2:t.form.supervisorOperator=i.name,t.form.supervisorDate=a;break;default:break}switch("3reject"===e?t.currentStep-1:t.currentStep){case 1:t.form.currentResponsible=t.form.submittingOperator;break;case 2:t.form.currentResponsible=t.form.incumbentOperator;break;default:break}switch(e){case"1submit":n=t.currentStep+1;break;case"2save":n=t.currentStep;break;case"3reject":n=t.currentStep-1;break;default:break}t.form.currentState=3===n?"关闭":t.steps[n],p(t.form).then((function(e){200==e.code&&(t.$message.success("提交成功"),t.getPostList(t.departId),t.dialogVisible=!1)}))}else{var o=t.steps[t.currentStep];t.$message.warning(o+"  流程中有必填项未填！")}}));case 1:return r.a(2)}}),r)})))()},handleViewClick:function(e,t){switch(this.operationType=t,this.getUserList(),e.incumbentId=Number(e.incumbentId),this.form=Object(a["a"])({},e),e.currentState){case"提交":this.currentStep=0;break;case"任职人确认":this.currentStep=1,this.form.submitPerson=e.submittingOperator,this.form.submitDate=e.submittingDate;break;case"主管确认":this.currentStep=2,this.form.submitPerson=e.incumbentOperator,this.form.submitDate=e.incumbentDate;break;case"关闭":this.currentStep=3,this.form.submitPerson=e.supervisorOperator,this.form.submitDate=e.supervisorDate;break;default:break}this.form.currentState=this.currentStep,this.currentStepClick=3===this.currentStep?0:this.currentStep,console.log("this.form---",this.form),this.dialogVisible=!0},downLoadPost:function(e){var t=this;m({id:e.id}).then((function(r){var n=new Blob([r],{type:"application/octet-stream"});t.$download.saveAs(n,e.incumbentName+"-岗位职责.docx")}))},deletePost:function(e){var t=this;this.$confirm("此操作将永久删除此数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d({id:e.id}).then((function(e){200==e.code&&(t.$message.success("删除成功"),t.getPostList(t.departId))}))})).catch((function(){t.$message.error("删除失败")}))},resetForm:function(){this.$refs.form.resetFields()},refreshTable:function(){this.getPostList(this.departId)},getUserList:function(){var e=this;Object(b["z"])({type:2}).then((function(t){200==t.code&&(e.responsibleOptions=t.data)}))},choiceStep:function(e){this.currentStepClick=e},handleSizeChange:function(e){this.search.size=e,this.getPostList(this.departId)},handleCurrentChange:function(e){this.search.current=e,this.getPostList(this.departId)}},watch:{departId:{handler:function(e,t){this.getPostList(e)}}},computed:Object(a["a"])({},Object(f["b"])(["nickName"]))},g=h,v=r("2877"),y=Object(v["a"])(g,n,i,!1,null,"712b2867",null);t["default"]=y.exports},c466:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a}));r("4d63"),r("c607"),r("ac1f"),r("2c3e"),r("00b4"),r("25f0"),r("5319");function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),r=e.getMonth()+1;r<10?r="0"+r+"-":r+="-",t+="-";var n=e.getDate();return n=n<10?"0"+n:n,t+r+n}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";if("Invalid Date"!==e){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)));return t}return""}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),r=e.getMonth(),n=e.getDate();return 26===n&&(r++,r>11&&(r=0,t++)),r+=1,r=r<10?"0"+r+"-":r+"-",t+="-",n=n<10?"0"+n:n,t+r+n}}}]);