(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f25fb6","chunk-33ae2478"],{"0e9a":function(e,t,i){"use strict";var a=i("c14f"),r=i("1da1"),n=(i("c19f"),i("ace4"),i("2c66"),i("249d"),i("40e9"),i("d3b7"),i("ac1f"),i("5319"),i("5cc6"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("986a"),i("1d02"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("6ce5"),i("2834"),i("72f7"),i("4ea1"),i("c343")),l=i("acff"),o=i("2b0e");t["a"]={convertFileToHtml:function(e){return Object(r["a"])(Object(a["a"])().m((function t(){var i,l;return Object(a["a"])().w((function(t){while(1)switch(t.n){case 0:return i=new XMLHttpRequest,i.open("GET",o["default"].prototype.javaApi+e,!0),i.send(),i.responseType="blob",l=new Promise((function(e,t){i.onload=Object(r["a"])(Object(a["a"])().m((function t(){var l,o,s,c,f;return Object(a["a"])().w((function(t){while(1)switch(t.n){case 0:if(200!==this.status){t.n=2;break}return l=new Blob([this.response],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=new FileReader,o.readAsArrayBuffer(l),s=new Promise((function(e,t){o.onload=Object(r["a"])(Object(a["a"])().m((function t(){var r,l,o;return Object(a["a"])().w((function(t){while(1)switch(t.n){case 0:return r=i.response,t.n=1,Object(n["convertToHtml"])({arrayBuffer:r});case 1:l=t.v,o=l.value.replace(//g,"").replace("<h1>",'<h1 style="text-align: center;">').replace(/<table>/g,'<table style="border-collapse: collapse;border: 1px solid #000;">').replace(/<tr>/g,'<tr style="height: 30px;">').replace(/<td>/g,'<td style="border: 1px solid #000;">').replace(/<p>/g,'<p style="text-indent: 2em;">').replace(/<a [^>]*>/g,"").replace(/<\/a>/g,""),e(o);case 2:return t.a(2)}}),t)})))})),c=e,t.n=1,s;case 1:f=t.v,c(f);case 2:return t.a(2)}}),t,this)})))})),t.n=1,l;case 1:return t.a(2,t.v)}}),t)})))()},downloadIamge:function(e,t){var i=new Image;i.setAttribute("crossOrigin","anonymous"),i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var a=e.getContext("2d");a.drawImage(i,0,0,i.width,i.height);var r=e.toDataURL("image/png"),n=document.createElement("a"),l=new MouseEvent("click");n.download=t||"photo",n.href=r,n.dispatchEvent(l)},i.src=e},compressBlob:function(e){var t=new FileReader;return t.readAsArrayBuffer(e),new Promise((function(i){t.onload=function(){var a=t.result,r=new Uint8Array(a),n=l["a"].deflate(r),o=new Blob([n],{type:e.type});i(o)}}))}}},"6cf7":function(e,t,i){},"6e52":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isImage?i("div",[i("img",{attrs:{src:e.imgUrl,alt:"Image Preview"}})]):e._e(),e.isPdf?i("div",[i("object",{attrs:{data:e.fileUrl,type:"application/pdf",width:"100%",height:"750px"}},[i("p",[e._v("您的浏览器不支持 PDF 预览。"),i("a",{attrs:{href:e.fileUrl}},[e._v("下载 PDF 文件")])])])]):e._e(),e.isDoc?i("div",[e.isDocShow?e._e():i("p",[e._v("文档无法直接预览，请下载查看。")]),e.isDocShow?i("vue-office-docx",{staticStyle:{height:"100vh"},attrs:{src:e.fileUrl},on:{rendered:e.renderedHandler,error:e.errorHandler}}):i("a",{attrs:{href:e.fileUrl}},[e._v("下载文件")])],1):e._e(),e.isXls?i("div",[e.isDocShow?e._e():i("p",[e._v("文档无法直接预览，请下载查看。")]),e.isDocShow?i("vue-office-excel",{staticStyle:{height:"100vh"},attrs:{src:e.fileUrl,options:e.options},on:{rendered:e.renderedHandler,error:e.errorHandler}}):i("a",{attrs:{href:e.fileUrl}},[e._v("下载文件")])],1):e._e(),e.isZipOrRar?i("div",[i("p",[e._v("压缩文件无法直接预览，请下载查看。")]),i("a",{attrs:{href:e.fileUrl}},[e._v("下载文件")])]):e._e(),e.isCsv?i("div",[0==e.csvList.length?i("p",[e._v("CSV 文件无法直接预览，请下载查看。")]):e._e(),0==e.csvList.length?i("a",{attrs:{href:e.fileUrl}},[e._v("下载文件")]):e._e(),e.csvList.length>0?i("el-tabs",{attrs:{type:"border-card","tab-position":"bottom"}},e._l(e.csvList,(function(t,a){return i("el-tab-pane",{key:a,attrs:{label:t.sheetName}},[i("el-table",{attrs:{data:t.tableData,height:"75vh"}},e._l(t.column,(function(t,a){return i("el-table-column",{key:a,attrs:{label:t.label,prop:t.prop,"min-width":"120px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"header",fn:function(a){return[i("div",[i("el-tooltip",{attrs:{content:t.label,placement:"top"}},[i("div",{staticClass:"oneLine"},[i("span",[e._v(e._s(t.label))])])])],1)]}}],null,!0)})})),1)],1)})),1):e._e()],1):e._e(),e.isSupported?e._e():i("div",[i("p",[e._v("不支持的文件格式")])])])},r=[],n=i("b85c"),l=i("c14f"),o=i("1da1"),s=(i("d81d"),i("14d9"),i("d3b7"),i("ac1f"),i("00b4"),i("5319"),i("5b81"),i("498a"),i("0643"),i("a573"),i("2d46")),c=i.n(s),f=(i("d457"),i("b690")),u=i.n(f),d=(i("2c3a"),{components:{VueOfficeDocx:c.a,VueOfficeExcel:u.a},props:{fileUrl:{type:String,required:!0},currentFile:{type:Object,required:!0}},data:function(){return{isDocShow:!0,options:{xls:!1,minColLength:0,minRowLength:0,widthOffset:10,heightOffset:10,beforeTransformData:function(e){return e},transformData:function(e){return e}},csvList:[],imgUrl:""}},computed:{isImage:function(){var e=/\.(jpg|jpeg|png|gif)$/i.test(this.fileUrl);return this.imgUrl=this.fileUrl,e&&(this.imgUrl=this.fileUrl.replaceAll("word","img")),e},isPdf:function(){return/\.pdf$/i.test(this.fileUrl)},isDoc:function(){return/\.(doc|docx)$/i.test(this.fileUrl)},isXls:function(){var e=/\.(xls|xlsx)$/i.test(this.fileUrl);return e&&(/\.(xlsx)$/i.test(this.fileUrl)?this.options.xls=!1:this.options.xls=!0),e},isZipOrRar:function(){return/\.(zip|rar)$/i.test(this.fileUrl)},isCsv:function(){var e=/\.csv$/i.test(this.fileUrl);return e&&this.loadCSVData(),e},isSupported:function(){return this.isImage||this.isPdf||this.isDoc||this.isZipOrRar||this.isCsv||this.isXls}},methods:{renderedHandler:function(){console.log("渲染完成"),this.isDocShow=!0,this.resetStyle()},errorHandler:function(){console.log("渲染失败"),this.isDocShow=!1},loadCSVData:function(){var e=this;return Object(o["a"])(Object(l["a"])().m((function t(){return Object(l["a"])().w((function(t){while(1)switch(t.n){case 0:e.$axios.post(e.$api.insOrderPlan.preview,{id:e.currentFile.id}).then((function(t){var i=t.data;i=i.map((function(t){var i={sheetName:t.sheetName,tableData:[],column:[]};for(var a in i.tableData=e.formatCSVToTable(t.content.replaceAll("null"," ")),i.tableData[0])i.column.push({label:a,prop:a});return i})),e.csvList=i})).catch((function(e){console.log(e)}));case 1:return t.a(2)}}),t)})))()},formatCSVToTable:function(e){var t=[],i=e.split("\n"),a=[];for(var r in i)if("string"===typeof i[r]&&i[r].length>0){var n="".concat(i[r]);if(n.trim().length>0){var l=i[r].split(",");if(0==r)a=l;else{for(var o={},s=0;s<a.length;s++){var c=String(a[s]);if(a[s]&&!o[c])try{l[s]?o[c]=String(l[s]):o[c]=""}catch(f){o[c]=""}}t.push(o)}}}return t},resetStyle:function(){var e,t=document.querySelectorAll('[style*="pt"]'),i=Object(n["a"])(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,r=a.getAttribute("style");r&&a.setAttribute("style",r.replace(/pt/g,"px"))}}catch(l){i.e(l)}finally{i.f()}}}}),h=d,p=(i("f71c"),i("2877")),v=Object(p["a"])(h,a,r,!1,null,"5966505f",null);t["default"]=v.exports},"8fbb":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.filesDialogVisible,title:"查看上岗证",width:"80%"},on:{"update:visible":function(t){e.filesDialogVisible=t},closed:e.closeFilesLook}},[i("div",[i("limsTable",{ref:"yearTable",staticStyle:{"margin-top":"0.5em"},attrs:{column:e.columnData,height:"calc(100vh - 400px)",highlightCurrentRow:!0,"table-data":e.tableData,"table-loading":e.tableLoading}})],1)]),i("el-dialog",{attrs:{visible:e.lookDialogVisible,fullscreen:"",title:"查看附件",top:"5vh",width:"800px"},on:{"update:visible":function(t){e.lookDialogVisible=t}}},[e.lookDialogVisible?i("filePreview",{staticStyle:{"max-height":"90vh","overflow-y":"auto"},attrs:{currentFile:{},fileUrl:e.javaApi+"/img/"+e.currentInfo.fileUrl}}):e._e()],1)],1)},r=[],n=i("0e9a"),l=i("6e52"),o=i("00d5"),s={name:"viewWorkPermitDia",components:{filePreview:l["default"],limsTable:o["a"]},data:function(){var e=this;return{filesDialogVisible:!1,tableLoading:!1,filesLookInfo:{},columnData:[{label:"文件名称",prop:"fileName",minWidth:"150px"},{label:"持有人",prop:"userName",minWidth:"150px"},{dataType:"action",minWidth:"100",label:"操作",fixed:"right",operation:[{name:"预览",type:"text",clickFun:function(t){e.handleLook(t)}},{name:"下载",type:"text",clickFun:function(t){e.upload(t)}}]}],tableData:[],info:{},currentInfo:{},lookDialogVisible:!1}},mounted:function(){},methods:{openDia:function(e){this.filesDialogVisible=!0,this.info=e,this.tableData=this.info.workFileList},closeFilesLook:function(){this.filesDialogVisible=!1},handleLook:function(e){this.currentInfo=e,this.lookDialogVisible=!0},upload:function(e){var t="";if(1==e.type)t=this.javaApi+"/img/"+e.fileUrl,n["a"].downloadIamge(t,e.fileName);else{t=this.javaApi+"/word/"+e.fileUrl;var i=document.createElement("a");i.href=t,i.download=e.fileName,i.click()}}}},c=s,f=i("2877"),u=Object(f["a"])(c,a,r,!1,null,"0d9b5a50",null);t["default"]=u.exports},f71c:function(e,t,i){"use strict";i("6cf7")}}]);