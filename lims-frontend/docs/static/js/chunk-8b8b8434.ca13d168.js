(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8b8b8434","chunk-3341e541","chunk-2d0c8617"],{"07f7":function(e,t,n){"use strict";n("4b7c")},"127c":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"search"},[n("div",[n("el-form",{ref:"searchForm",attrs:{model:e.searchForm,size:"small",inline:!0}},[n("el-form-item",{attrs:{label:"受审部门",prop:"department"}},[n("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.searchForm.department,callback:function(t){e.$set(e.searchForm,"department",t)},expression:"searchForm.department"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchList}},[e._v("查询")]),n("el-button",{attrs:{size:"mini"},on:{click:e.resetSearchForm}},[e._v("重置")])],1)],1)],1),n("div",[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.openFormDia("add")}}},[e._v("新 增")])],1)]),n("div",{staticClass:"table"},[n("limsTable",{attrs:{column:e.tableColumn,height:"calc(100vh - 23em)","table-data":e.tableData,"table-loading":e.tableLoading,page:e.page},on:{pagination:e.pagination}})],1),e.auditInspectionDia?n("audit-inspection-dia",{ref:"auditInspectionDia",on:{closeImplementDia:e.closeImplementDia}}):e._e()],1)},r=[],o=n("5530"),i=n("00d5"),l=n("a082"),c=n("5545"),u={name:"auditInspection",components:{AuditInspectionDia:l["default"],limsTable:i["a"]},data:function(){var e=this;return{searchForm:{department:""},tableColumn:[{label:"受审部门",prop:"department"},{label:"部门负责人",prop:"departmentHead"},{label:"审核员",prop:"auditor"},{label:"审核日期",prop:"reviewDate"},{dataType:"tag",label:"批准状态",prop:"ratifyStatus",minWidth:"100",formatData:function(e){return 0===e?"不批准":1===e?"批准":null},formatType:function(e){return 0===e?"danger":1===e?"success":null}},{label:"批准内容",prop:"ratifyRemark",minWidth:"140"},{dataType:"action",minWidth:"220",label:"操作",operation:[{name:"导出",type:"text",clickFun:function(t){e.handleDown(t)},disabled:function(e){return 1!==e.ratifyStatus}},{name:"编辑",type:"text",clickFun:function(t){e.openFormDia("edit",t)},disabled:function(e){return 1===e.ratifyStatus}},{name:"批准",type:"text",clickFun:function(t){e.openFormDia("ratify",t)},disabled:function(e){return 1===e.ratifyStatus}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.delPlan(t)},disabled:function(e){return 1===e.ratifyStatus}}]}],tableData:[],tableLoading:!1,page:{size:20,current:1,total:0},auditInspectionDia:!1}},mounted:function(){this.searchList()},methods:{searchList:function(){var e=this,t=this.searchForm,n=this.page;this.tableLoading=!0,Object(c["B"])(Object(o["a"])(Object(o["a"])({},t),n)).then((function(t){e.tableLoading=!1,e.tableData=t.data.records,e.page.total=t.data.total})).catch((function(t){console.log("err---",t),e.tableLoading=!1}))},openFormDia:function(e,t){var n=this;this.auditInspectionDia=!0,this.$nextTick((function(){n.$refs.auditInspectionDia.openDia(e,t)}))},closeImplementDia:function(){this.auditInspectionDia=!1,this.searchList()},resetSearchForm:function(){this.searchForm.department="",this.searchList()},delPlan:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.tableLoading=!0,Object(c["g"])({checkId:e.checkId}).then((function(e){t.tableLoading=!1,t.$message.success("删除成功"),t.searchList()})).catch((function(e){t.tableLoading=!1,console.log("err---",e)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleDown:function(e){var t=this;Object(c["o"])({checkId:e.checkId}).then((function(e){t.outLoading=!1;var n=new Blob([e],{type:"application/msword"});t.$download.saveAs(n,"内审检查.docx")}))},pagination:function(e){var t=e.page,n=e.limit;this.page.current=t,this.page.size=n,this.searchList()}}},s=u,d=(n("07f7"),n("2877")),p=Object(d["a"])(s,a,r,!1,null,"66e822cc",null);t["default"]=p.exports},"4b7c":function(e,t,n){},5545:function(e,t,n){"use strict";n.d(t,"F",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"s",(function(){return i})),n.d(t,"z",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"O",(function(){return u})),n.d(t,"m",(function(){return s})),n.d(t,"K",(function(){return d})),n.d(t,"D",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"q",(function(){return f})),n.d(t,"x",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"M",(function(){return g})),n.d(t,"J",(function(){return y})),n.d(t,"E",(function(){return v})),n.d(t,"j",(function(){return I})),n.d(t,"r",(function(){return k})),n.d(t,"y",(function(){return D})),n.d(t,"d",(function(){return O})),n.d(t,"N",(function(){return j})),n.d(t,"B",(function(){return w})),n.d(t,"g",(function(){return L})),n.d(t,"o",(function(){return x})),n.d(t,"u",(function(){return T})),n.d(t,"a",(function(){return C})),n.d(t,"L",(function(){return R})),n.d(t,"I",(function(){return _})),n.d(t,"C",(function(){return $})),n.d(t,"p",(function(){return F})),n.d(t,"v",(function(){return z})),n.d(t,"b",(function(){return P})),n.d(t,"l",(function(){return M})),n.d(t,"G",(function(){return S})),n.d(t,"t",(function(){return H})),n.d(t,"A",(function(){return N})),n.d(t,"f",(function(){return q})),n.d(t,"P",(function(){return A})),n.d(t,"n",(function(){return J})),n.d(t,"H",(function(){return B})),n.d(t,"w",(function(){return E})),n.d(t,"h",(function(){return W}));var a=n("b775");function r(e){return Object(a["a"])({url:"/internalPlan/pageInternalPlan",method:"get",params:e})}function o(e){return Object(a["a"])({url:"/internalPlan/delInternalPlan",method:"delete",params:e})}function i(e){return Object(a["a"])({url:"/internalPlan/exportInternalPlan",method:"get",responseType:"blob",params:e})}function l(e){return Object(a["a"])({url:"/internalPlan/getInternalPlanOne",method:"get",params:e})}function c(e){return Object(a["a"])({url:"/internalPlan/addInternalPlan",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/internalPlan/updateInternalPlan",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/internalPlan/examineInternalPlan",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/internalPlan/ratifyInternalPlan",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/internalImplement/pageInternalImplement",method:"get",params:e})}function m(e){return Object(a["a"])({url:"/internalImplement/delInternalImplement",method:"delete",params:e})}function f(e){return Object(a["a"])({url:"/internalImplement/exportInternalImplement",method:"get",responseType:"blob",params:e})}function h(e){return Object(a["a"])({url:"/internalImplement/getInternalImplementOne",method:"get",params:e})}function b(e){return Object(a["a"])({url:"/internalImplement/addInternalImplement",method:"post",data:e})}function g(e){return Object(a["a"])({url:"/internalImplement/updateInternalImplement",method:"post",data:e})}function y(e){return Object(a["a"])({url:"/internalImplement/ratifyInternalImplement",method:"post",data:e})}function v(e){return Object(a["a"])({url:"/internalMeeting/pageInternalMeeting",method:"get",params:e})}function I(e){return Object(a["a"])({url:"/internalMeeting/delInternalMeeting",method:"delete",params:e})}function k(e){return Object(a["a"])({url:"/internalMeeting/exportInternalMeeting",method:"get",responseType:"blob",params:e})}function D(e){return Object(a["a"])({url:"/internalMeeting/getInternalMeetingOne",method:"get",params:e})}function O(e){return Object(a["a"])({url:"/internalMeeting/addInternalMeeting",method:"post",data:e})}function j(e){return Object(a["a"])({url:"/internalMeeting/updateInternalMeeting",method:"post",data:e})}function w(e){return Object(a["a"])({url:"/internalCheck/pageInternalCheck",method:"get",params:e})}function L(e){return Object(a["a"])({url:"/internalCheck/delInternalCheck",method:"delete",params:e})}function x(e){return Object(a["a"])({url:"/internalCheck/exportInternalCheck",method:"get",responseType:"blob",params:e})}function T(e){return Object(a["a"])({url:"/internalCheck/getInternalCheckOne",method:"get",params:e})}function C(e){return Object(a["a"])({url:"/internalCheck/addInternalCheck",method:"post",data:e})}function R(e){return Object(a["a"])({url:"/internalCheck/updateInternalCheck",method:"post",data:e})}function _(e){return Object(a["a"])({url:"/internalCheck/ratifyInternalCheck",method:"post",data:e})}function $(e){return Object(a["a"])({url:"/internalCorrect/pageInternalCorrect",method:"get",params:e})}function F(e){return Object(a["a"])({url:"/internalCorrect/exportInternalCorrect",method:"get",responseType:"blob",params:e})}function z(e){return Object(a["a"])({url:"/internalCorrect/getInternalCorrect",method:"get",params:e})}function P(e){return Object(a["a"])({url:"/internalCorrect/addInternalCorrect",method:"post",data:e})}function M(e){return Object(a["a"])({url:"/internalReport/delInternalReport",method:"delete",params:e})}function S(e){return Object(a["a"])({url:"/internalReport/pageInternalReport",method:"get",params:e})}function H(e){return Object(a["a"])({url:"/internalReport/exportInternalReport",method:"get",responseType:"blob",params:e})}function N(e){return Object(a["a"])({url:"/internalReport/getInternalReportOne",method:"get",params:e})}function q(e){return Object(a["a"])({url:"/internalReport/addInternalReport",method:"post",data:e})}function A(e){return Object(a["a"])({url:"/internalReport/updateInternalReport",method:"post",data:e})}function J(e){return Object(a["a"])({url:"/internalReport/examineInternalReport",method:"post",data:e})}function B(e){return Object(a["a"])({url:"/internalReport/qualityInternalReport",method:"post",data:e})}function E(e){return Object(a["a"])({url:"/internalCorrect/getInternalCorrectFileList",method:"get",params:e})}function W(e){return Object(a["a"])({url:"/internalCorrect/delInternalCorrectFile",method:"delete",params:e})}},a082:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.diaLoading,expression:"diaLoading"}],attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.formDia,title:"内部审核实施计划",width:"80%"},on:{"update:visible":function(t){e.formDia=t},close:e.closeImplementDia}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"auto"}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"受审部门",prop:"department"}},[n("el-input",{attrs:{disabled:"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"部门负责人",prop:"departmentHead"}},[n("el-input",{attrs:{disabled:"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.departmentHead,callback:function(t){e.$set(e.form,"departmentHead",t)},expression:"form.departmentHead"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"审核员",prop:"auditor"}},[n("el-input",{attrs:{disabled:"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.auditor,callback:function(t){e.$set(e.form,"auditor",t)},expression:"form.auditor"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"审核日期",prop:"reviewDate"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:"ratify"===e.operationType,clearable:"",format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.reviewDate,callback:function(t){e.$set(e.form,"reviewDate",t)},expression:"form.reviewDate"}})],1)],1)],1),"ratify"!==e.operationType?n("div",{staticStyle:{"text-align":"right","margin-bottom":"10px"}},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addRow}},[e._v("添加")]),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.clearTable}},[e._v("清空")])],1):e._e(),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkDetailList,border:"",height:"300","header-cell-style":{background:"#f8f8f9",color:"#515a6e"}}},[n("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"60"}}),n("el-table-column",{attrs:{"header-align":"center",label:"涉及要素和质量体系文件条款",prop:"element"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{attrs:{disabled:"ratify"===e.operationType,size:"small"},model:{value:a.element,callback:function(t){e.$set(a,"element",t)},expression:"row.element"}})]}}])}),n("el-table-column",{attrs:{"header-align":"center",label:"审核内容",prop:"content"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{attrs:{disabled:"ratify"===e.operationType,size:"small"},model:{value:a.content,callback:function(t){e.$set(a,"content",t)},expression:"row.content"}})]}}])}),n("el-table-column",{attrs:{"header-align":"center",label:"审核方式",prop:"method"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{attrs:{disabled:"ratify"===e.operationType,size:"small"},model:{value:a.method,callback:function(t){e.$set(a,"method",t)},expression:"row.method"}})]}}])}),n("el-table-column",{attrs:{"header-align":"center",label:"审核结果记录",prop:"resultRecords",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{attrs:{disabled:"ratify"===e.operationType,size:"small"},model:{value:a.resultRecords,callback:function(t){e.$set(a,"resultRecords",t)},expression:"row.resultRecords"}})]}}])}),n("el-table-column",{attrs:{"header-align":"center",label:"不符合性质",prop:"nonNature",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{attrs:{disabled:"ratify"===e.operationType,size:"small"},model:{value:a.nonNature,callback:function(t){e.$set(a,"nonNature",t)},expression:"row.nonNature"}})]}}])})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["ratify"===e.operationType?n("el-button",{attrs:{loading:e.loading},on:{click:function(t){return e.ratify(0)}}},[e._v("不批准")]):e._e(),"ratify"===e.operationType?n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.ratify(1)}}},[e._v("批 准")]):e._e(),"ratify"!==e.operationType?n("el-button",{on:{click:e.closeImplementDia}},[e._v("取 消")]):e._e(),"ratify"!==e.operationType?n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleEdit}},[e._v("提 交")]):e._e()],1)],1),n("el-dialog",{attrs:{visible:e.approvalDialog,title:"批准",width:"30%"},on:{"update:visible":function(t){e.approvalDialog=t},close:function(t){e.approvalDialog=!1}}},[n("span",[e._v(" 批准备注： "),n("el-input",{attrs:{type:"textarea"},model:{value:e.ratifyRemark,callback:function(t){e.ratifyRemark=t},expression:"ratifyRemark"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{loading:e.approvalLoading},on:{click:function(t){e.approvalDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{loading:e.approvalLoading,type:"primary"},on:{click:function(t){return e.handleApproval(0)}}},[e._v("确 定")])],1)])],1)},r=[],o=(n("14d9"),n("5545")),i={name:"auditInspectionDia",components:{},data:function(){return{formDia:!1,diaLoading:!1,loading:!1,form:{department:"",departmentHead:"",auditor:"",reviewDate:""},rules:{department:[{required:!0,message:"请填写受审部门",trigger:"blur"}],departmentHead:[{required:!0,message:"请填写部门负责人",trigger:"blur"}],auditor:[{required:!0,message:"请填写审核员",trigger:"blur"}],reviewDate:[{required:!0,message:"请填写审核日期",trigger:"blur"}]},checkDetailList:[],operationType:"",approvalDialog:!1,approvalLoading:!1,ratifyRemark:""}},methods:{openDia:function(e,t){this.formDia=!0,this.operationType=e,"add"!==e&&this.searchInfo(t)},searchInfo:function(e){var t=this;this.diaLoading=!0,Object(o["u"])({checkId:e.checkId}).then((function(e){t.diaLoading=!1,t.form=e.data,t.checkDetailList=t.form.checkDetailList})).catch((function(e){console.log(e),t.diaLoading=!1}))},handleEdit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return console.log("error submit!!"),!1;if(0!==e.checkDetailList.length){e.loading=!0;var n=e.HaveJson(e.form);n.checkDetailList=e.HaveJson(e.checkDetailList),"add"===e.operationType?Object(o["a"])(n).then((function(t){e.loading=!1,e.$message.success("操作成功"),e.closeImplementDia()})).catch((function(t){console.log("err---",t),e.loading=!1})):"edit"===e.operationType&&Object(o["L"])(n).then((function(t){e.loading=!1,e.$message.success("操作成功"),e.closeImplementDia()})).catch((function(t){console.log("err---",t),e.loading=!1}))}else e.$message.warning("请添加表格数据")}))},ratify:function(e){0===e?this.approvalDialog=!0:this.handleApproval(e)},handleApproval:function(e){var t=this;this.approvalLoading=!0;var n=this.HaveJson(this.form);n.ratifyStatus=e,n.ratifyRemark=0===e?this.ratifyRemark:"",Object(o["I"])(n).then((function(e){200===e.code&&(t.$message.success("提交成功！"),t.approvalDialog=!1,t.closeImplementDia(t.departId)),t.approvalLoading=!1})).catch((function(){t.approvalLoading=!1}))},addRow:function(){this.checkDetailList.push({element:"",content:"",method:"",resultRecords:"",nonNature:""})},clearTable:function(){this.checkDetailList=[]},closeImplementDia:function(){this.$refs.form.resetFields(),this.formDia=!1,this.$emit("closeImplementDia")}}},l=i,c=n("2877"),u=Object(c["a"])(l,a,r,!1,null,"ccc71550",null);t["default"]=u.exports}}]);