(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b3441e8"],{"5e56":function(e,a,t){"use strict";t.d(a,"e",(function(){return n})),t.d(a,"a",(function(){return i})),t.d(a,"c",(function(){return r})),t.d(a,"f",(function(){return l})),t.d(a,"g",(function(){return o})),t.d(a,"d",(function(){return d})),t.d(a,"b",(function(){return u})),t.d(a,"h",(function(){return c}));var s=t("b775");function n(e){return Object(s["a"])({url:"/insOrderPlan/getFactoryVerify",method:"get",params:e})}function i(e){return Object(s["a"])({url:"/insOrderPlan/addFactoryVerify",method:"post",data:e})}function r(e){return Object(s["a"])({url:"/insOrderPlan/addUnqualifiedRetest",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/insOrder/getInsOrder",method:"get",params:e})}function o(e){return Object(s["a"])({url:"/unqualifiedHandler/getUnqualifiedHandler",method:"get",params:e})}function d(e){return Object(s["a"])({url:"/unqualifiedHandler/downFile",method:"get",params:e})}function u(e){return Object(s["a"])({url:"/unqualifiedHandler/addUnqualifiedHandler",method:"post",data:e})}function c(e){return Object(s["a"])({url:"/unPass/pageInsUnPass",method:"post",data:e})}},"6ddf":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-dialog",{attrs:{title:"新增不合格处理",visible:e.isShow,width:"740px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(a){e.isShow=a}}},[t("div",{staticClass:"search"},[t("el-form",{ref:"unPassForm",staticClass:"form-inline",attrs:{inline:!0,model:e.unPassForm,rules:e.unPassFormRules,"label-width":"120px"}},[t("div",[t("el-form-item",{staticClass:"headLine",staticStyle:{width:"100%"},attrs:{label:"标题:",prop:"headline"}},[t("el-input",{attrs:{clearable:"",size:"small",disabled:"view"===e.type,type:"textarea",placeholder:"请输入"},model:{value:e.unPassForm.headline,callback:function(a){e.$set(e.unPassForm,"headline",a)},expression:"unPassForm.headline"}})],1)],1),t("el-form-item",{attrs:{label:"供应商名称:"}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.supplierName,callback:function(a){e.$set(e.unPassForm,"supplierName",a)},expression:"unPassForm.supplierName"}})],1),t("el-form-item",{attrs:{label:"物料名称:"}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:e.unPassForm.materialName}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.materialName,callback:function(a){e.$set(e.unPassForm,"materialName",a)},expression:"unPassForm.materialName"}})],1)],1),t("el-form-item",{attrs:{label:"生产批次:"}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.productionBatch,callback:function(a){e.$set(e.unPassForm,"productionBatch",a)},expression:"unPassForm.productionBatch"}})],1),t("el-form-item",{attrs:{label:"到货数量:"}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.cargoQuantity,callback:function(a){e.$set(e.unPassForm,"cargoQuantity",a)},expression:"unPassForm.cargoQuantity"}})],1),t("el-form-item",{attrs:{label:"规格型号:"}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.specsModels,callback:function(a){e.$set(e.unPassForm,"specsModels",a)},expression:"unPassForm.specsModels"}})],1),t("el-form-item",{attrs:{label:"报检时间:"}},[t("el-date-picker",{staticStyle:{width:"175px"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small",disabled:"",type:"date",placeholder:"选择日期"},model:{value:e.unPassForm.inspectTime,callback:function(a){e.$set(e.unPassForm,"inspectTime",a)},expression:"unPassForm.inspectTime"}})],1),t("el-form-item",{attrs:{label:"反馈人:"}},[t("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.feedbackUser,callback:function(a){e.$set(e.unPassForm,"feedbackUser",a)},expression:"unPassForm.feedbackUser"}})],1),t("el-form-item",{attrs:{label:"反馈时间:",prop:"feedbackTime"}},[t("el-date-picker",{staticStyle:{width:"175px"},attrs:{disabled:"view"===e.type,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",type:"date",placeholder:"选择日期"},model:{value:e.unPassForm.feedbackTime,callback:function(a){e.$set(e.unPassForm,"feedbackTime",a)},expression:"unPassForm.feedbackTime"}})],1),t("el-form-item",{attrs:{label:"分类:",prop:"classification"}},[t("el-select",{attrs:{disabled:"view"===e.type,size:"small",placeholder:"请选择"},model:{value:e.unPassForm.classification,callback:function(a){e.$set(e.unPassForm,"classification",a)},expression:"unPassForm.classification"}},e._l(e.classificationOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"不合格归属:",prop:"offGradeAscription"}},[t("el-select",{attrs:{disabled:"view"===e.type,size:"small",placeholder:"请选择"},model:{value:e.unPassForm.offGradeAscription,callback:function(a){e.$set(e.unPassForm,"offGradeAscription",a)},expression:"unPassForm.offGradeAscription"}},e._l(e.offGradeAscriptionOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"不合格情况描述:",prop:"unqualifiedDesc"}},[t("el-input",{staticStyle:{width:"484px"},attrs:{clearable:"",type:"textarea",disabled:"view"===e.type,size:"small",placeholder:"请输入"},model:{value:e.unPassForm.unqualifiedDesc,callback:function(a){e.$set(e.unPassForm,"unqualifiedDesc",a)},expression:"unPassForm.unqualifiedDesc"}})],1)],1),"add"===e.type?t("el-upload",{ref:"upload",attrs:{action:e.action2,"on-change":e.beforeUpload,"on-error":e.onError,"on-remove":e.handleRemoveFile,"on-success":e.getUnpassUrl,headers:e.uploadHeader,"file-list":e.unPassFilesList}},[t("el-button",{staticStyle:{"text-align":"left"},attrs:{size:"small",type:"primary"}},[e._v("附件上传")])],1):e._e(),"add"!==e.type?t("div",[t("div",{staticStyle:{"padding-left":"40px","margin-bottom":"4px"}},[e._v("附件：")]),e._l(e.unqualifiedHandlerFiles,(function(a){return t("div",{staticStyle:{"padding-left":"40px","margin-bottom":"4px"}},[t("span",[e._v(e._s(a.fileName))]),t("el-link",{staticStyle:{"margin-left":"20px","vertical-align":"top"},attrs:{type:"primary",underline:!1},on:{click:function(t){return e.handleDown(a)}}},[e._v("下载")])],1)}))],2):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){return e.$emit("resetForm")}}},[e._v("取 消")]),"add"===e.type?t("el-button",{attrs:{type:"primary",loading:e.handlunPassLoading},on:{click:e.handlunPass}},[e._v("确 定")]):e._e()],1)])],1)},n=[],i=t("5530"),r=(t("99af"),t("c740"),t("14d9"),t("a434"),t("d3b7"),t("0643"),t("4e3e"),t("159b"),t("5e56")),l=t("2f62"),o={name:"unPassDialog",components:{},props:{unPassDialog:{type:Boolean,default:function(){return!1}},orderId:{type:String,default:function(){return null}}},data:function(){return{type:"",isShow:this.unPassDialog,unPassForm:{headline:"",inventoryQuantityId:"",supplierName:"",materialName:"",productionBatch:"",cargoQuantity:"",specsModels:"",inspectTime:"",feedbackUser:"",feedbackTime:"",classification:"",offGradeAscription:"",unqualifiedDesc:"",unqualifiedHandlerFiles:[]},unPassFormRules:{offGradeAscription:[{required:!0,message:"请选择不合格归属",trigger:"change"}],headline:[{required:!0,message:"请填写标题",trigger:"blur"}]},unPassFilesList:[],classificationOptions:[],offGradeAscriptionOptions:[],handlunPassLoading:!1,unqualifiedHandlerFiles:[]}},mounted:function(){this.getClassificationOptions(),this.getOffGradeAscriptionOptions()},methods:{getInsOrder:function(e,a){var t=this;this.type=e,"add"===e?Object(r["f"])({orderId:this.orderId}).then((function(e){200===e.code&&(t.unPassForm.headline="No.0005-中天装备电线-外购品不合格反馈评审及纠正预防流程(正式版)-".concat(t.nickName,"-").concat((new Date).toISOString().substring(0,10)),t.unPassForm.feedbackTime=(new Date).toISOString().substring(0,10),t.unPassForm.feedbackUser=t.nickName,t.unPassForm.insOrderId=e.data.insOrder.id,t.unPassForm.materialName=e.data.insOrder.sampleType,t.unPassForm.specsModels=e.data.insOrder.partDetail,t.unPassForm.inventoryQuantityId=e.data.insOrderTemplate.inventoryQuantityId,t.unPassForm.supplierName=e.data.insOrderTemplate.supplierName,t.unPassForm.productionBatch=e.data.insOrderTemplate.updateBatchNo,t.unPassForm.cargoQuantity=e.data.insOrderTemplate.qtyArrived+e.data.insOrderTemplate.buyUnitMeas,t.unPassForm.inspectTime=e.data.insOrderTemplate.sendTime.substring(0,10))})):(this.getInfo(a.handlerId),this.unPassForm=Object(i["a"])({},a))},getInfo:function(e){var a=this;Object(r["g"])({id:e}).then((function(e){200===e.code&&(a.unqualifiedHandlerFiles=a.HaveJson(e.data.unqualifiedHandlerFiles))}))},handleDown:function(e){var a=this;Object(r["d"])({id:e.id}).then((function(t){a.$download.saveAs(t.data.fileUrl,e.fileName)})).catch((function(e){}))},handlunPass:function(){var e=this;this.$refs["unPassForm"].validate((function(a){if(!a)return console.log("error submit!!"),!1;e.unPassForm.unqualifiedHandlerFiles.forEach((function(e){delete e.orderBy})),e.handlunPassLoading=!0,Object(r["b"])(e.unPassForm).then((function(a){200===a.code&&(e.$message.success("提交成功"),e.$emit("resetForm")),e.handlunPassLoading=!1}))}))},getUnpassUrl:function(e,a,t){200==e.code&&(this.$message.success("上传成功"),this.unPassForm.unqualifiedHandlerFiles.push(e.data))},handleRemoveFile:function(e){var a=this.unPassForm.unqualifiedHandlerFiles.findIndex((function(a){return a===e.response.data}));a>-1&&this.unPassForm.unqualifiedHandlerFiles.splice(a,1)},beforeUpload:function(e){return e.size>10485760?(this.$message.error("上传文件不超过10M"),this.$refs.upload.clearFiles(),!1):(this.upLoading=!0,!0)},onError:function(e,a,t){this.$message.error("上传失败"),this.$refs.upload.clearFiles()},getClassificationOptions:function(){var e=this;this.getDicts("categories_no_conformities").then((function(a){e.classificationOptions=e.dictToValue(a.data)}))},getOffGradeAscriptionOptions:function(){var e=this;this.getDicts("attribution_no_conformities").then((function(a){e.offGradeAscriptionOptions=e.dictToValue(a.data)}))}},computed:Object(i["a"])(Object(i["a"])({},Object(l["b"])(["nickName"])),{},{action2:function(){return this.javaApi+"/unqualifiedHandler/uploadFileByUnqualified"}})},d=o,u=(t("7bd8"),t("2877")),c=Object(u["a"])(d,s,n,!1,null,"438d04df",null);a["default"]=c.exports},"7bd8":function(e,a,t){"use strict";t("f617")},f617:function(e,a,t){}}]);