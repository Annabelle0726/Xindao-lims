(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33ae2478"],{"6cf7":function(t,e,i){},"6e52":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isImage?i("div",[i("img",{attrs:{src:t.imgUrl,alt:"Image Preview"}})]):t._e(),t.isPdf?i("div",[i("object",{attrs:{data:t.fileUrl,type:"application/pdf",width:"100%",height:"750px"}},[i("p",[t._v("您的浏览器不支持 PDF 预览。"),i("a",{attrs:{href:t.fileUrl}},[t._v("下载 PDF 文件")])])])]):t._e(),t.isDoc?i("div",[t.isDocShow?t._e():i("p",[t._v("文档无法直接预览，请下载查看。")]),t.isDocShow?i("vue-office-docx",{staticStyle:{height:"100vh"},attrs:{src:t.fileUrl},on:{rendered:t.renderedHandler,error:t.errorHandler}}):i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])],1):t._e(),t.isXls?i("div",[t.isDocShow?t._e():i("p",[t._v("文档无法直接预览，请下载查看。")]),t.isDocShow?i("vue-office-excel",{staticStyle:{height:"100vh"},attrs:{src:t.fileUrl,options:t.options},on:{rendered:t.renderedHandler,error:t.errorHandler}}):i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])],1):t._e(),t.isZipOrRar?i("div",[i("p",[t._v("压缩文件无法直接预览，请下载查看。")]),i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")])]):t._e(),t.isCsv?i("div",[0==t.csvList.length?i("p",[t._v("CSV 文件无法直接预览，请下载查看。")]):t._e(),0==t.csvList.length?i("a",{attrs:{href:t.fileUrl}},[t._v("下载文件")]):t._e(),t.csvList.length>0?i("el-tabs",{attrs:{type:"border-card","tab-position":"bottom"}},t._l(t.csvList,(function(e,r){return i("el-tab-pane",{key:r,attrs:{label:e.sheetName}},[i("el-table",{attrs:{data:e.tableData,height:"75vh"}},t._l(e.column,(function(e,r){return i("el-table-column",{key:r,attrs:{label:e.label,prop:e.prop,"min-width":"120px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(r){return[i("div",[i("el-tooltip",{attrs:{content:e.label,placement:"top"}},[i("div",{staticClass:"oneLine"},[i("span",[t._v(t._s(e.label))])])])],1)]}}],null,!0)})})),1)],1)})),1):t._e()],1):t._e(),t.isSupported?t._e():i("div",[i("p",[t._v("不支持的文件格式")])])])},s=[],n=i("b85c"),l=i("c14f"),a=i("1da1"),o=(i("d81d"),i("14d9"),i("d3b7"),i("ac1f"),i("00b4"),i("5319"),i("5b81"),i("498a"),i("0643"),i("a573"),i("2d46")),c=i.n(o),f=(i("d457"),i("b690")),u=i.n(f),h=(i("2c3a"),{components:{VueOfficeDocx:c.a,VueOfficeExcel:u.a},props:{fileUrl:{type:String,required:!0},currentFile:{type:Object,required:!0}},data:function(){return{isDocShow:!0,options:{xls:!1,minColLength:0,minRowLength:0,widthOffset:10,heightOffset:10,beforeTransformData:function(t){return t},transformData:function(t){return t}},csvList:[],imgUrl:""}},computed:{isImage:function(){var t=/\.(jpg|jpeg|png|gif)$/i.test(this.fileUrl);return this.imgUrl=this.fileUrl,t&&(this.imgUrl=this.fileUrl.replaceAll("word","img")),t},isPdf:function(){return/\.pdf$/i.test(this.fileUrl)},isDoc:function(){return/\.(doc|docx)$/i.test(this.fileUrl)},isXls:function(){var t=/\.(xls|xlsx)$/i.test(this.fileUrl);return t&&(/\.(xlsx)$/i.test(this.fileUrl)?this.options.xls=!1:this.options.xls=!0),t},isZipOrRar:function(){return/\.(zip|rar)$/i.test(this.fileUrl)},isCsv:function(){var t=/\.csv$/i.test(this.fileUrl);return t&&this.loadCSVData(),t},isSupported:function(){return this.isImage||this.isPdf||this.isDoc||this.isZipOrRar||this.isCsv||this.isXls}},methods:{renderedHandler:function(){console.log("渲染完成"),this.isDocShow=!0,this.resetStyle()},errorHandler:function(){console.log("渲染失败"),this.isDocShow=!1},loadCSVData:function(){var t=this;return Object(a["a"])(Object(l["a"])().m((function e(){return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:t.$axios.post(t.$api.insOrderPlan.preview,{id:t.currentFile.id}).then((function(e){var i=e.data;i=i.map((function(e){var i={sheetName:e.sheetName,tableData:[],column:[]};for(var r in i.tableData=t.formatCSVToTable(e.content.replaceAll("null"," ")),i.tableData[0])i.column.push({label:r,prop:r});return i})),t.csvList=i})).catch((function(t){console.log(t)}));case 1:return e.a(2)}}),e)})))()},formatCSVToTable:function(t){var e=[],i=t.split("\n"),r=[];for(var s in i)if("string"===typeof i[s]&&i[s].length>0){var n="".concat(i[s]);if(n.trim().length>0){var l=i[s].split(",");if(0==s)r=l;else{for(var a={},o=0;o<r.length;o++){var c=String(r[o]);if(r[o]&&!a[c])try{l[o]?a[c]=String(l[o]):a[c]=""}catch(f){a[c]=""}}e.push(a)}}}return e},resetStyle:function(){var t,e=document.querySelectorAll('[style*="pt"]'),i=Object(n["a"])(e);try{for(i.s();!(t=i.n()).done;){var r=t.value,s=r.getAttribute("style");s&&r.setAttribute("style",s.replace(/pt/g,"px"))}}catch(l){i.e(l)}finally{i.f()}}}}),p=h,d=(i("f71c"),i("2877")),v=Object(d["a"])(p,r,s,!1,null,"5966505f",null);e["default"]=v.exports},f71c:function(t,e,i){"use strict";i("6cf7")}}]);