(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15392078"],{"116c":function(e,t,s){},"13fe":function(e,t,s){},"38f5":function(e,t,s){"use strict";s("116c")},6750:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:"edit"===e.operationType?"编辑":"新增",visible:e.formDia,width:"80%"},on:{"update:visible":function(t){e.formDia=t},close:e.closeDia}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"140px"}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"监督日期",prop:"superviseTime"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:"",format:"yyyy.M",placeholder:"选择日期",size:"small",type:"month","value-format":"yyyy.M"},model:{value:e.form.superviseTime,callback:function(t){e.$set(e.form,"superviseTime",t)},expression:"form.superviseTime"}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"监督目的",prop:"supervisePurpose"}},[s("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.form.supervisePurpose,callback:function(t){e.$set(e.form,"supervisePurpose",t)},expression:"form.supervisePurpose"}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"监控项目",prop:"superviseProject"}},[s("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.form.superviseProject,callback:function(t){e.$set(e.form,"superviseProject",t)},expression:"form.superviseProject"}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"被监督人员",prop:"supervisedUserId"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small"},on:{change:e.usePersonName},model:{value:e.form.supervisedUserId,callback:function(t){e.$set(e.form,"supervisedUserId",t)},expression:"form.supervisedUserId"}},e._l(e.userList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"监督原因",prop:"superviseReason"}},[s("el-input",{attrs:{clearable:"",disabled:"",size:"small"},model:{value:e.form.superviseReason,callback:function(t){e.$set(e.form,"superviseReason",t)},expression:"form.superviseReason"}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"备注",prop:"remark"}},[s("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeDia}},[e._v("取 消")]),s("el-button",{attrs:{loading:e.upLoad,type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)],1)},i=[],r=s("5530"),o=(s("c740"),s("b0c0"),s("4e71a")),n=s("b558"),l={name:"detailFormDialog",components:{},props:["superviseId"],data:function(){return{formDia:!1,form:{qualityMonitorDetailsId:"",superviseTime:"",supervisePurpose:"",superviseProject:"",supervisee:"",supervisedUserId:"",superviseReason:"",remark:"",superviseDetailsId:""},rules:{superviseTime:[{required:!0,message:"请输入监督日期",trigger:"blur"}],supervisePurpose:[{required:!0,message:"请输入监督目的",trigger:"blur"}],superviseProject:[{required:!1,message:"请输入监控项目",trigger:"blur"}]},upLoad:!1,operationType:"",userList:[]}},methods:{openDia:function(e,t,s){this.formDia=!0,this.operationType=e,this.getUserList(),this.form.superviseReason=1==s?"定期监督":"动态监督","edit"===e&&this.searchInfo(t)},usePersonName:function(e){var t=this.userList.findIndex((function(t){return t.id===e}));t>-1&&(this.form.supervisee=this.userList[t].name)},searchInfo:function(e){this.form=Object(r["a"])({},e)},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&("add"===e.operationType?e.handleAdd():e.handleEdit())}))},handleAdd:function(){var e=this,t=this.HaveJson(this.form);t.superviseId=this.superviseId,this.upLoad=!0,Object(o["c"])(t).then((function(t){e.upLoad=!1,e.$message.success("新增成功"),e.closeDia()})).catch((function(t){console.log("err---",t),e.upLoad=!1}))},handleEdit:function(){var e=this,t=this.HaveJson(this.form);this.upLoad=!0,Object(o["u"])(t).then((function(t){e.upLoad=!1,e.$message.success("修改成功"),e.closeDia()})).catch((function(t){console.log("err---",t),e.upLoad=!1}))},closeDia:function(){this.$refs.form.resetFields(),this.formDia=!1,this.$emit("closeDia")},getUserList:function(){var e=this;Object(n["w"])({type:2}).then((function(t){e.userList=t.data}))}}},c=l,d=(s("38f5"),s("2877")),p=Object(d["a"])(c,a,i,!1,null,"da768634",null);t["default"]=p.exports},"7e39":function(e,t,s){"use strict";s("9f41")},"8dc4":function(e,t,s){"use strict";s("13fe")},"9f41":function(e,t,s){},b2cc:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.formDia,title:"纠正措施处理单",width:"60%"},on:{"update:visible":function(t){e.formDia=t},close:e.closeRectifyDia}},[s("el-steps",{attrs:{active:e.currentStep,"align-center":"","finish-status":"success"}},[s("el-step",{attrs:{title:"不合格或偏离事实的描述"},nativeOn:{click:function(t){return e.setStep(0)}}}),s("el-step",{attrs:{title:"批准"},nativeOn:{click:function(t){return e.setStep(2)}}})],1),s("div",{staticStyle:{height:"510px","overflow-y":"auto"}},[s("table",{staticClass:"tables",attrs:{border:"1",cellspacing:"10"}},[s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("培训计划：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",disabled:0!==e.currentStep,placeholder:"请选择",size:"small"},model:{value:e.form.personTrainingDetailedId,callback:function(t){e.$set(e.form,"personTrainingDetailedId",t)},expression:"form.personTrainingDetailedId"}},e._l(e.yearTrainingDetailed,(function(e){return s("el-option",{key:e.id,attrs:{label:e.trainingObjectives,value:e.id}})})),1)],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("不合格或偏离事实的描述：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[0===e.currentStep?s("el-input",{attrs:{rows:2,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.raiseResult,callback:function(t){e.$set(e.form,"raiseResult",t)},expression:"form.raiseResult"}}):e._e(),0!==e.currentStep?s("span",{staticClass:"td-info1"},[e._v(" "+e._s(e.form.raiseResult))]):e._e()],1)]),0!==e.currentStep?s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("提出人：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.raiseUserName)+" ")]),s("td",{staticClass:"td-title"},[s("p",[e._v("提出部门：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.raiseDepartment)+" ")])]):e._e(),s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("提出日期：")])]),0===e.currentStep?s("td",{staticClass:"td-info"},[s("el-date-picker",{staticStyle:{width:"80%"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.raiseTime,callback:function(t){e.$set(e.form,"raiseTime",t)},expression:"form.raiseTime"}})],1):e._e(),0!==e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[e._v(" "+e._s(e.form.raiseTime)+" ")]):e._e()]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("原因分析：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[0===e.currentStep?s("el-input",{attrs:{rows:2,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.causeResult,callback:function(t){e.$set(e.form,"causeResult",t)},expression:"form.causeResult"}}):e._e(),0!==e.currentStep?s("span",{staticClass:"td-info1"},[e._v(" "+e._s(e.form.causeResult))]):e._e()],1)]),0!==e.currentStep?s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("原因分析人：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.causeUserName)+" ")]),s("td",{staticClass:"td-title"},[s("p",[e._v("责任部门：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.causeDepartment)+" ")])]):e._e(),s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("原因分析日期：")])]),0===e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[s("el-date-picker",{staticStyle:{width:"80%"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.causeTime,callback:function(t){e.$set(e.form,"causeTime",t)},expression:"form.causeTime"}})],1):e._e(),0!==e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[e._v(" "+e._s(e.form.causeTime)+" ")]):e._e()]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("纠正措施：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[0===e.currentStep?s("el-input",{attrs:{rows:2,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.correctResult,callback:function(t){e.$set(e.form,"correctResult",t)},expression:"form.correctResult"}}):e._e(),0!==e.currentStep?s("span",{staticClass:"td-info1"},[e._v(" "+e._s(e.form.correctResult))]):e._e()],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("提出要求部门确认：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[0===e.currentStep?s("el-input",{attrs:{rows:2,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.raiseDepartmentAffirm,callback:function(t){e.$set(e.form,"raiseDepartmentAffirm",t)},expression:"form.raiseDepartmentAffirm"}}):e._e(),0!==e.currentStep?s("span",{staticClass:"td-info1"},[e._v(" "+e._s(e.form.raiseDepartmentAffirm))]):e._e()],1)]),0!==e.currentStep?s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("纠正人：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.correctUserName)+" ")]),s("td",{staticClass:"td-title"},[s("p",[e._v("责任部门：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.correctDepartment)+" ")])]):e._e(),s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("纠正日期：")])]),0===e.currentStep?s("td",{staticClass:"td-info"},[s("el-date-picker",{staticStyle:{width:"80%"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.correctTime,callback:function(t){e.$set(e.form,"correctTime",t)},expression:"form.correctTime"}})],1):e._e(),0!==e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[e._v(" "+e._s(e.form.correctTime)+" ")]):e._e()]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("实施验证结果：")])]),s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[0===e.currentStep?s("el-input",{attrs:{rows:2,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.validationResult,callback:function(t){e.$set(e.form,"validationResult",t)},expression:"form.validationResult"}}):e._e(),0!==e.currentStep?s("span",{staticClass:"td-info1"},[e._v(" "+e._s(e.form.validationResult))]):e._e()],1)]),0!==e.currentStep?s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("验证人：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.validationUserName)+" ")]),s("td",{staticClass:"td-title"},[s("p",[e._v("责任部门：")])]),s("td",{staticClass:"td-info"},[e._v(" "+e._s(e.form.validationDepartment)+" ")])]):e._e(),s("tr",[s("td",{staticClass:"td-title"},[s("p",[e._v("验证日期：")])]),0===e.currentStep?s("td",{staticClass:"td-info"},[s("el-date-picker",{staticStyle:{width:"80%"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.validationTime,callback:function(t){e.$set(e.form,"validationTime",t)},expression:"form.validationTime"}})],1):e._e(),0!==e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[e._v(" "+e._s(e.form.validationTime)+" ")]):e._e()]),0===e.currentStep?s("tr",[0===e.currentStep?s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("请选择批准人：")])]):e._e(),0===e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"3"}},[s("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择",size:"small"},model:{value:e.form.approverUserId,callback:function(t){e.$set(e.form,"approverUserId",t)},expression:"form.approverUserId"}},e._l(e.personList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()]):e._e()])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeRectifyDia}},[e._v("取 消")]),0===e.currentStep&&e.userId==e.supervisedUserId?s("el-button",{attrs:{loading:e.editLoad,type:"primary"},on:{click:e.handleEdit}},[e._v("提 交")]):e._e(),1===e.currentStep&&e.userId==e.approverUserId?s("el-button",{attrs:{loading:e.editLoad},on:{click:function(t){return e.handleEdit(0)}}},[e._v("不通过")]):e._e(),1===e.currentStep&&e.userId==e.approverUserId?s("el-button",{attrs:{loading:e.editLoad,type:"primary"},on:{click:function(t){return e.handleEdit(1)}}},[e._v("通 过")]):e._e()],1)],1)],1)},i=[],r=s("5530"),o=(s("14d9"),s("b0c0"),s("d3b7"),s("0643"),s("4e3e"),s("159b"),s("4e71a")),n=s("b558"),l=s("bb61"),c=s("2f62"),d={name:"rectifyDialog",components:{},data:function(){return{formDia:!1,currentStep:0,form:{superviseDetailsId:"",raiseResult:"",vdeRaiseResult:"",raiseUserName:"",raiseDepartment:"",raiseTime:"",causeResult:"",causeUserName:"",causeDepartment:"",causeTime:"",correctResult:"",raiseDepartmentAffirm:"",correctUserName:"",correctDepartment:"",correctTime:"",approverUserId:"",validationResult:"",validationUserName:"",validationDepartment:"",validationTime:"",superviseDetailsCorrectId:"",approveId:"",personTrainingDetailedId:""},editLoad:!1,personList:[],yearTrainingDetailed:[],supervisedUserId:"",approverUserId:""}},computed:Object(r["a"])({},Object(c["b"])(["userId"])),methods:{openDia:function(e){this.formDia=!0,this.searchInfo(e),this.form.superviseDetailsId=e.superviseDetailsId,this.form.approveId=e.approveId,this.supervisedUserId=e.supervisedUserId,this.getAuthorizedPerson(),this.getYearTrainingDetailed()},searchInfo:function(e){var t=this;this.form.qualityMonitorDetailsId=e.qualityMonitorDetailsId,Object(o["o"])({superviseDetailsId:e.superviseDetailsId}).then((function(e){e.data.approverUserId?1!=e.data.isFinish?t.currentStep=1:1==e.data.isFinish&&(t.currentStep=2):t.currentStep=0,t.form=e.data,t.approverUserId=e.data.approverUserId})).catch((function(e){console.log("err---",e)}))},handleEdit:function(e){var t=this;if(0===this.currentStep){if(!this.form.raiseResult)return void this.$message.warning("请填写不合格描述");if(!this.form.causeResult)return void this.$message.warning("请填写原因分析");if(!this.form.correctResult)return void this.$message.warning("请填写纠正措施");if(!this.form.validationResult)return void this.$message.warning("请填写实施验证结果")}this.editLoad=!0,this.form.flowType=this.currentStep,0===this.currentStep?Object(o["b"])(this.form).then((function(e){t.editLoad=!1,t.$message.success("提交成功"),t.closeRectifyDia()})).catch((function(e){console.log("err---",e),t.editLoad=!1})):(this.form.isFinish=e,Object(o["f"])(this.form).then((function(e){t.editLoad=!1,t.$message.success("批准成功"),t.closeRectifyDia()})).catch((function(e){console.log("err---",e),t.editLoad=!1})))},closeRectifyDia:function(){this.formDia=!1,this.$emit("closeRectifyDia")},setStep:function(e){this.showStep=e},getAuthorizedPerson:function(){var e=this;Object(n["w"])({type:2}).then((function(t){var s=[];t.data.forEach((function(e){s.push({label:e.name,value:e.id})})),e.personList=s}))},getYearTrainingDetailed:function(){var e=this;Object(l["e"])().then((function(t){e.yearTrainingDetailed=t.data}))}}},p=d,u=(s("8dc4"),s("2877")),f=Object(u["a"])(p,a,i,!1,null,"5bc78a81",null);t["default"]=f.exports},bb61:function(e,t,s){"use strict";s.d(t,"f",(function(){return i})),s.d(t,"b",(function(){return r})),s.d(t,"d",(function(){return o})),s.d(t,"a",(function(){return n})),s.d(t,"c",(function(){return l})),s.d(t,"e",(function(){return c}));var a=s("b775");function i(e){return Object(a["a"])({url:"/qualitySupervise/pageSuperviseDetailCorrect",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/qualitySupervise/exportSuperviseDetaillCorrect",method:"get",responseType:"blob",params:e})}function o(e){return Object(a["a"])({url:"/qualitySupervise/getSuperviseDetailCorrectFileList",method:"get",params:e})}function n(e){return Object(a["a"])({url:"/qualitySupervise/delSuperviseDetailCorrectFile",method:"delete",params:e})}function l(e){return Object(a["a"])({url:"/qualitySupervise/getSuperviseDetailCorrect",method:"get",params:e})}function c(e){return Object(a["a"])({url:"/personTraining/getThisYearTrainingDetailed",method:"get",params:e})}},d4a0:function(e,t,s){},e407:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.formDia,title:"检测工作监督记录表",width:"70%"},on:{"update:visible":function(t){e.formDia=t},close:e.closeRecordsDia}},[s("el-steps",{attrs:{active:e.currentStep,"align-center":"","finish-status":"success"}},[s("el-step",{attrs:{title:"实施"}}),s("el-step",{attrs:{title:"批准"}})],1),s("div",{staticStyle:{height:"470px","overflow-y":"auto"}},[s("table",{staticClass:"tables",attrs:{border:"1",cellspacing:"10"}},[s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测人员：")])]),s("td",{attrs:{colspan:"2"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.testMember,callback:function(t){e.$set(e.form,"testMember",t)},expression:"form.testMember"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.testMember))])],1),s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("监督员：")])]),s("td",{attrs:{colspan:"2"}},[0===e.currentStep?s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small"},on:{change:e.usePersonName},model:{value:e.form.supervisor,callback:function(t){e.$set(e.form,"supervisor",t)},expression:"form.supervisor"}},e._l(e.recordUserList,(function(e){return s("el-option",{key:e.userName,attrs:{label:e.userName,value:e.userName}})})),1):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.supervisor))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测项目：")])]),s("td",[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.testItem,callback:function(t){e.$set(e.form,"testItem",t)},expression:"form.testItem"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.testItem))])],1),s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("样品编号：")])]),s("td",[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.sampleNumber,callback:function(t){e.$set(e.form,"sampleNumber",t)},expression:"form.sampleNumber"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.sampleNumber))])],1),s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测日期：")])]),s("td",[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.testDate,callback:function(t){e.$set(e.form,"testDate",t)},expression:"form.testDate"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.testDate))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("人员：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.personnel,callback:function(t){e.$set(e.form,"personnel",t)},expression:"form.personnel"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.personnel))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("仪器设备：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.device,callback:function(t){e.$set(e.form,"device",t)},expression:"form.device"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.device))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("工作环境：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.environment,callback:function(t){e.$set(e.form,"environment",t)},expression:"form.environment"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.environment))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("样品采集：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.sampleCollection,callback:function(t){e.$set(e.form,"sampleCollection",t)},expression:"form.sampleCollection"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.sampleCollection))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("样品的准备：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.samplePreparation,callback:function(t){e.$set(e.form,"samplePreparation",t)},expression:"form.samplePreparation"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.samplePreparation))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测方法：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.detectionMethod,callback:function(t){e.$set(e.form,"detectionMethod",t)},expression:"form.detectionMethod"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.detectionMethod))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测记录：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.inspectionRecord,callback:function(t){e.$set(e.form,"inspectionRecord",t)},expression:"form.inspectionRecord"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.inspectionRecord))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("检测报告：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.form.examiningReport,callback:function(t){e.$set(e.form,"examiningReport",t)},expression:"form.examiningReport"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.examiningReport))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("监督情况评价：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{rows:4,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.supervisionEvaluation,callback:function(t){e.$set(e.form,"supervisionEvaluation",t)},expression:"form.supervisionEvaluation"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.supervisionEvaluation))])],1)]),s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("不符合处理意见：")])]),s("td",{attrs:{colspan:"5"}},[0===e.currentStep?s("el-input",{attrs:{rows:4,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.handlingAdvice,callback:function(t){e.$set(e.form,"handlingAdvice",t)},expression:"form.handlingAdvice"}}):s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.handlingAdvice))])],1)]),s("tr",[0===e.currentStep?s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("请选择下一步批准人：")])]):e._e(),0===e.currentStep?s("td",{attrs:{colspan:"5"}},[s("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择",size:"small"},model:{value:e.form.ratifyUserId,callback:function(t){e.$set(e.form,"ratifyUserId",t)},expression:"form.ratifyUserId"}},e._l(e.personList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),1===e.currentStep?s("td",{staticClass:"td-title"},[s("p",[e._v("批准负责人：")])]):e._e(),1===e.currentStep?s("td",{staticClass:"td-info",attrs:{colspan:"5"}},[e._v(" "+e._s(e.form.ratifyUserName)+" ")]):e._e()]),1===e.currentStep||2===e.currentStep?s("tr",[s("td",{staticClass:"td-title"},[s("p",[s("span",{staticClass:"required-span"},[e._v("* ")]),e._v("审批结论：")])]),s("td",{attrs:{colspan:"2"}},[1===e.currentStep?s("el-input",{attrs:{rows:4,placeholder:"请输入内容",size:"small",type:"textarea"},model:{value:e.form.ratifyOpinion,callback:function(t){e.$set(e.form,"ratifyOpinion",t)},expression:"form.ratifyOpinion"}}):e._e(),2===e.currentStep?s("span",{staticClass:"td-info"},[e._v(" "+e._s(e.form.ratifyOpinion))]):e._e()],1),s("td",{staticClass:"td-title"},[1===e.currentStep?s("p",[e._v("请选择是否符合：")]):e._e(),2===e.currentStep?s("p",[e._v("是否符合：")]):e._e()]),s("td",{attrs:{colspan:"2"}},[1===e.currentStep?s("el-radio-group",{model:{value:e.form.isAccording,callback:function(t){e.$set(e.form,"isAccording",t)},expression:"form.isAccording"}},[s("el-radio",{attrs:{label:0}},[e._v("不符合")]),s("el-radio",{attrs:{label:1}},[e._v("符合")])],1):e._e(),2===e.currentStep?s("span",{staticClass:"td-info"},[e._v(" "+e._s(0===e.form.isAccording?"不符合":"符合"))]):e._e()],1)]):e._e()])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeRecordsDia}},[e._v("取 消")]),0===e.currentStep&&e.userId==e.supervisedUserId?s("el-button",{attrs:{loading:e.editLoad,type:"primary"},on:{click:e.handleEdit}},[e._v("提 交")]):e._e(),1===e.currentStep&&e.userId==e.ratifyUserId?s("el-button",{attrs:{loading:e.editLoad},on:{click:function(t){return e.handleEdit(0)}}},[e._v("不通过")]):e._e(),1===e.currentStep&&e.userId==e.ratifyUserId?s("el-button",{attrs:{loading:e.editLoad,type:"primary"},on:{click:function(t){return e.handleEdit(1)}}},[e._v("通 过")]):e._e()],1)],1)],1)},i=[],r=s("5530"),o=(s("c740"),s("14d9"),s("b0c0"),s("d3b7"),s("0643"),s("4e3e"),s("159b"),s("4e71a")),n=s("b558"),l=s("2f62"),c={name:"recordsDialog",components:{},data:function(){return{formDia:!1,form:{superviseDetailsId:"",superviseDetailsRecordId:"",testMember:"",supervisor:"",supervisorId:"",testItem:"",sampleNumber:"",testDate:"",personnel:"",device:"",environment:"",sampleCollection:"",samplePreparation:"",detectionMethod:"",inspectionRecord:"",examiningReport:"",supervisionEvaluation:"",handlingAdvice:"",ratifyUserId:"",ratifyUserName:"",ratifyOpinion:"",isAccording:""},currentStep:0,editLoad:!1,personList:[],recordUserList:[],supervisedUserId:"",ratifyUserId:""}},computed:Object(r["a"])({},Object(l["b"])(["userId"])),methods:{openDia:function(e){this.formDia=!0,this.supervisedUserId=e.supervisedUserId,this.searchInfo(e),this.getAuthorizedPerson()},usePersonName:function(e){var t=this.recordUserList.findIndex((function(t){return t.userId===e}));t>-1&&(this.form.supervisor=this.recordUserList[t].userName)},searchInfo:function(e){var t=this;Object(o["p"])({superviseDetailsId:e.superviseDetailsId}).then((function(s){s.data.ratifyUserId?1!=s.data.isFinish?t.currentStep=1:1==s.data.isFinish&&(t.currentStep=2):t.currentStep=0,t.form=s.data,t.form.superviseDetailsId=e.superviseDetailsId,t.ratifyUserId=s.data.ratifyUserId,t.getRecordUser()})).catch((function(e){console.log("err---",e)}))},handleEdit:function(e){this.form.testMember&&this.form.supervisor&&this.form.testItem&&this.form.sampleNumber&&this.form.testDate?0===this.currentStep?this.addInfo():this.editInfo(e):this.$message.warning("请填写完整")},addInfo:function(){var e=this;this.editLoad=!0,Object(o["d"])(this.form).then((function(t){e.editLoad=!1,e.$message.success("操作成功"),e.closeRecordsDia()})).catch((function(t){console.log("err---",t),e.editLoad=!1}))},editInfo:function(e){var t=this;this.form.ratifyOpinion?null!==this.form.isAccording?(this.editLoad=!0,this.form.isFinish=e,Object(o["e"])(this.form).then((function(e){t.editLoad=!1,t.$message.success("操作成功"),t.closeRecordsDia()})).catch((function(e){console.log("err---",e),t.editLoad=!1}))):this.$message.warning("请选择是否符合"):this.$message.warning("请填写审批意见")},closeRecordsDia:function(){this.formDia=!1,this.$emit("closeRecordsDia")},getAuthorizedPerson:function(){var e=this;Object(n["w"])({type:2}).then((function(t){var s=[];t.data.forEach((function(e){s.push({label:e.name,value:e.id})})),e.personList=s}))},getRecordUser:function(){var e=this;Object(o["m"])({superviseDetailsId:this.form.superviseDetailsId}).then((function(t){e.recordUserList=t.data}))}}},d=c,p=(s("7e39"),s("2877")),u=Object(p["a"])(d,a,i,!1,null,"5b5c4b24",null);t["default"]=u.exports},e861:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"table-card"},[s("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[s("div",{staticStyle:{display:"flex"}},[s("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[s("span",{staticStyle:{width:"88px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("计划名称")]),s("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getYearPlanList(t)}},model:{value:e.yearForm.superviseName,callback:function(t){e.$set(e.yearForm,"superviseName",t)},expression:"yearForm.superviseName"}})],1),s("div",{staticStyle:{"line-height":"30px"}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getYearPlanList}},[e._v("查询")]),s("el-button",{attrs:{size:"mini"},on:{click:e.clearYear}},[e._v("重置")])],1)]),s("div",{staticStyle:{"line-height":"30px"}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.record}},[e._v("导入")])],1)]),s("lims-table",{key:"yearTableData",attrs:{tableData:e.yearTableData,column:e.yearColumnData,page:e.yearPage,tableLoading:e.yearLoading,height:"40vh",rowClick:e.rowClick},on:{pagination:e.pagination}})],1),s("div",{staticStyle:{"margin-top":"20px"}},[s("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[s("div",{staticStyle:{display:"flex"}},[s("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[s("el-radio-group",{attrs:{size:"small"},on:{change:e.getYearDetailPlan},model:{value:e.yearDetailForm.causeType,callback:function(t){e.$set(e.yearDetailForm,"causeType",t)},expression:"yearDetailForm.causeType"}},[s("el-radio-button",{attrs:{label:1}},[e._v("定期监督")]),s("el-radio-button",{attrs:{label:2}},[e._v("动态监督")])],1)],1),s("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[s("span",{staticStyle:{width:"88px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("监控目的")]),s("el-input",{attrs:{placeholder:"请输入",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getYearDetailPlan(t)}},model:{value:e.yearDetailForm.supervisePurpose,callback:function(t){e.$set(e.yearDetailForm,"supervisePurpose",t)},expression:"yearDetailForm.supervisePurpose"}})],1),s("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[s("span",{staticStyle:{width:"88px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("监控项目")]),s("el-input",{attrs:{placeholder:"请输入",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getYearDetailPlan(t)}},model:{value:e.yearDetailForm.superviseProject,callback:function(t){e.$set(e.yearDetailForm,"superviseProject",t)},expression:"yearDetailForm.superviseProject"}})],1),s("div",{staticStyle:{"line-height":"30px"}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getYearDetailPlan}},[e._v("查询")]),s("el-button",{attrs:{size:"mini"},on:{click:e.clearDetail}},[e._v("重置")])],1)]),s("div",{staticStyle:{"line-height":"30px"}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.showDialog("add")}}},[e._v("新增")])],1)]),s("lims-table",{key:"yearDetailColumnData",attrs:{tableData:e.yearDetailTableData,column:e.yearDetailColumnData,page:e.yearDetailPage,tableLoading:e.yearDetailLoading,height:"40vh"},on:{pagination:e.pagination1}})],1),e.formDia?s("detail-form-dialog",{ref:"formDia",attrs:{superviseId:e.superviseId},on:{closeDia:e.closeDia}}):e._e(),e.recordsDia?s("records-dialog",{ref:"recordsDia",attrs:{superviseId:e.superviseId},on:{closeRecordsDia:e.closeRecordsDia}}):e._e(),e.processingDia?s("processing-sheet",{ref:"processingDia",attrs:{superviseId:e.superviseId},on:{closeProcessingDia:e.closeProcessingDia}}):e._e(),e.rectifyDia?s("rectify-dialog-new",{ref:"rectifyDia",attrs:{superviseId:e.superviseId},on:{closeRectifyDia:e.closeRectifyDia}}):e._e(),s("el-dialog",{attrs:{visible:e.ratifyDialog,title:"批准",width:"30%"},on:{"update:visible":function(t){e.ratifyDialog=t},close:e.closeRatifyDia}},[s("span",[e._v(" 批准备注： "),s("el-input",{attrs:{type:"textarea"},model:{value:e.ratifyInfo.ratifyRemark,callback:function(t){e.$set(e.ratifyInfo,"ratifyRemark",t)},expression:"ratifyInfo.ratifyRemark"}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{loading:e.ratifyLoading},on:{click:function(t){return e.handleRatify(0)}}},[e._v("不批准")]),s("el-button",{attrs:{loading:e.ratifyLoading,type:"primary"},on:{click:function(t){return e.handleRatify(1)}}},[e._v("批 准")])],1)]),s("el-dialog",{attrs:{visible:e.downloadDialog,title:"导出",width:"600px"},on:{"update:visible":function(t){e.downloadDialog=t}}},[s("span",[s("el-button",{attrs:{plain:"",type:"primary",disabled:3!==e.download.recordStatus},on:{click:e.controlDown}},[e._v("记录单导出")]),s("el-button",{attrs:{plain:"",type:"primary",disabled:3!==e.download.accordingStatus},on:{click:e.processingDown}},[e._v("处理单导出")]),s("el-button",{attrs:{plain:"",type:"primary",disabled:3!==e.download.correctStatus},on:{click:e.supervisoryDown}},[e._v("纠正单导出")])],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.downloadDialog=!1}}},[e._v("取 消")])],1)]),s("el-dialog",{attrs:{visible:e.uploadDia,title:"数据导入",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.uploadDia=t}}},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("span",{staticStyle:{width:"80px"}},[e._v("年份：")]),s("el-date-picker",{attrs:{type:"year","value-format":"yyyy",clearable:"",size:"small",format:"yyyy",placeholder:"选择年"},model:{value:e.superviseYear,callback:function(t){e.superviseYear=t},expression:"superviseYear"}}),s("span",{staticStyle:{width:"110px"}},[e._v("监督员：")]),s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small","multiple-limit":2,filterable:"",multiple:""},on:{change:e.splitList},model:{value:e.recordUserIds,callback:function(t){e.recordUserIds=t},expression:"recordUserIds"}},e._l(e.userList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),s("div",{staticStyle:{display:"flex","align-items":"center",margin:"10px 0"}},[s("div",{staticStyle:{width:"60px"}},[e._v("批准人：")]),s("el-select",{staticStyle:{width:"50%"},attrs:{clearable:"",filterable:"",size:"small"},model:{value:e.ratifyUserId,callback:function(t){e.ratifyUserId=t},expression:"ratifyUserId"}},e._l(e.userList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),s("div",{staticStyle:{margin:"0 auto"}},[s("el-upload",{ref:"upload1",attrs:{action:e.action,"auto-upload":!1,"file-list":e.fileList,headers:e.uploadHeader,limit:1,accept:".jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.zip,.rar","on-change":e.beforeUpload,"on-error":e.onError,"on-success":e.handleSuccessUp,drag:"",data:{recordUserIds:e.recordUserIds1,superviseYear:e.superviseYear,ratifyUserId:e.ratifyUserId},name:"file"}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])])])],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeUploadDia}},[e._v("取 消")]),s("el-button",{attrs:{loading:e.uploading,type:"primary"},on:{click:function(t){return e.submitUpload()}}},[e._v("上 传")])],1)])],1)},i=[],r=s("5530"),o=(s("a15b"),s("6750")),n=s("e407"),l=s("5d2d"),c=s("b2cc"),d=s("00d5"),p=s("4e71a"),u=s("b558"),f=s("2f62"),m={name:"QualityControlPlan",components:{limsTable:d["a"],RectifyDialogNew:c["default"],ProcessingSheet:l["default"],RecordsDialog:n["default"],DetailFormDialog:o["default"]},data:function(){var e=this;return{yearForm:{superviseName:""},yearPage:{current:1,size:20,total:0},yearColumnData:[{label:"计划名称",prop:"superviseName",width:"150px"},{label:"编制人",prop:"writeUserName"},{label:"编制日期",prop:"writeTime",width:"160"},{dataType:"tag",label:"批准状态",prop:"ratifyStatus",width:"100",formatData:function(e){return 0===e?"不批准":1===e?"批准":null},formatType:function(e){return 0===e?"danger":1===e?"success":null}},{label:"批准内容",prop:"ratifyRemark"},{label:"批准人",prop:"ratifyUserName"},{label:"批准日期",prop:"ratifyTime",width:"160"},{dataType:"action",label:"操作",operation:[{name:"批准",type:"text",disabled:function(t){return 1===t.ratifyStatus||e.userId!=t.ratifyUserId},clickFun:function(t){e.approvalPlan(t)}},{name:"导出",type:"text",clickFun:function(t){e.handleDown(t)},disabled:function(e){return 1!==e.ratifyStatus}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.delPlan(t)},disabled:function(e){return 1===e.ratifyStatus}}]}],yearTableData:[],yearLoading:!1,yearDetailForm:{supervisePurpose:"",superviseProject:"",causeType:1},yearDetailColumnData:[{label:"监督日期",prop:"superviseTime",width:"120px"},{label:"监督目的",prop:"supervisePurpose",width:"180px"},{label:"监控项目",prop:"superviseProject",width:"180px"},{label:"被监督人员",prop:"supervisee",width:"120px"},{label:"监督原因",prop:"superviseReason",width:"150px"},{dataType:"tag",label:"记录状态",prop:"recordStatus",width:"100",formatData:function(e){return 0===e?"未开始":1===e?"待评价":2===e?"不批准":3===e?"已批准":null},formatType:function(e){return 0===e?"":1===e?"warning":2===e?"danger":3===e?"success":null}},{dataType:"tag",label:"控制状态",prop:"accordingStatus",width:"100",formatData:function(e){return 0===e?"未开始":1===e?"待评价":2===e?"不批准":3===e?"已批准":null},formatType:function(e){return 0===e?"":1===e?"warning":2===e?"danger":3===e?"success":null}},{dataType:"tag",label:"纠正状态",prop:"correctStatus",width:"100",formatData:function(e){return 0===e?"未开始":1===e?"待评价":2===e?"不批准":3===e?"已批准":null},formatType:function(e){return 0===e?"":1===e?"warning":2===e?"danger":3===e?"success":null}},{label:"备注",prop:"remark"},{dataType:"action",fixed:"right",label:"操作",operation:[{name:"编辑",type:"text",clickFun:function(t){e.showDialog("edit",t)}},{name:"记录",type:"text",clickFun:function(t){e.records(t)}},{name:"处理",type:"text",clickFun:function(t){e.processing(t)},disabled:function(e){return 1===e.isAccording||null===e.isAccording}},{name:"纠正",type:"text",clickFun:function(t){e.rectify(t)},disabled:function(e){return 1===e.isAccording||null===e.isAccording||null===e.isCorrect||0===e.isCorrect}},{name:"导出",type:"text",clickFun:function(t){e.openDownloadDia(t)}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.delYearPlanDetail(t)}}]}],yearDetailTableData:[],yearDetailLoading:!1,yearDetailPage:{current:1,size:20,total:0},currentScrollPosition:0,superviseId:"",formDia:!1,recordsDia:!1,processingDia:!1,rectifyDia:!1,ratifyDialog:!1,ratifyLoading:!1,ratifyInfo:{},downloadDialog:!1,download:{},uploadDia:!1,uploading:!1,fileList:[],userList:[],recordUserIds:[],recordUserIds1:"",superviseYear:"",ratifyUserId:""}},mounted:function(){this.getYearPlanList()},methods:{getYearPlanList:function(){var e=this,t={superviseName:this.yearForm.superviseName},s=this.yearPage;this.yearLoading=!0,Object(p["q"])(Object(r["a"])(Object(r["a"])({},t),s)).then((function(t){e.yearLoading=!1,e.yearTableData=t.data.records,e.yearPage.total=t.data.total,e.yearTableData.length>0&&e.rowClick(e.yearTableData[0])})).catch((function(t){console.log("err---",t),e.yearLoading=!1}))},clearYear:function(){this.yearForm.superviseName="",this.getYearPlanList()},pagination:function(e){var t=e.page,s=e.limit;this.yearPage.current=t,this.yearPage.size=s,this.getYearPlanList()},beforeUpload:function(e){if(e.size>10485760)return this.$message.error("上传文件不超过10M"),this.$refs.upload1.clearFiles(),!1},onError:function(e,t,s){this.$message.error("上传失败"),this.$refs.upload1.clearFiles()},handleSuccessUp:function(e){var t=this;this.uploading=!1,200==e.code&&(this.$message.success("上传成功"),this.recordUserIds=[],this.superviseYear="",this.fileList=[],this.timer=setTimeout((function(){t.closeUploadDia()}),1e3))},splitList:function(e){var t=this.HaveJson(e);this.recordUserIds1=t.join(","),console.log(this.recordUserIds1)},submitUpload:function(){this.superviseYear?0!==this.recordUserIds.length?this.ratifyUserId?(this.uploading=!0,this.$refs.upload1.submit()):this.$message.warning("请选择批准人"):this.$message.warning("请选择监督员"):this.$message.warning("请选择年份")},closeUploadDia:function(){this.uploadDia=!1,this.recordUserIds=[],this.ratifyUserId="",this.superviseYear="",this.getYearPlanList()},record:function(e){this.uploadDia=!0,this.getUserList()},getUserList:function(){var e=this;Object(u["w"])({type:2}).then((function(t){e.userList=t.data}))},approvalPlan:function(e){this.ratifyDialog=!0,this.ratifyInfo=e},handleRatify:function(e){var t=this;this.ratifyInfo.ratifyStatus=e,this.ratifyLoading=!0,Object(p["s"])(this.ratifyInfo).then((function(e){t.ratifyLoading=!1,t.$message.success("操作成功"),t.closeRatifyDia()})).catch((function(e){console.log("err---",e),t.ratifyLoading=!1}))},closeRatifyDia:function(){this.ratifyDialog=!1,this.ratifyInfo.ratifyRemark="",this.getYearPlanList()},handleDown:function(e){var t=this;Object(p["j"])({superviseId:e.superviseId}).then((function(s){try{t.outLoading=!1;var a=new Blob([s],{type:"application/msword"});t.$download.saveAs(a,e.superviseName+".docx")}catch(i){console.error("创建Blob对象时出错:",i)}}))},delPlan:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.yearLoading=!0,Object(p["h"])({superviseId:e.superviseId}).then((function(e){t.yearLoading=!1,t.$message.success("删除成功"),t.getYearPlanList()})).catch((function(e){t.yearLoading=!1,console.log("err---",e)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},rowClick:function(e){this.superviseId=e.superviseId,this.getYearDetailPlan()},getYearDetailPlan:function(){this.yearDetailPage.current=1,this.yearDetailPage.size=20,this.getYearDetailPlanList()},getYearDetailPlanList:function(){var e=this,t={superviseId:this.superviseId,supervisePurpose:this.yearDetailForm.supervisePurpose,superviseProject:this.yearDetailForm.superviseProject,causeType:this.yearDetailForm.causeType},s=this.yearDetailPage;this.yearDetailLoading=!0,Object(p["r"])(Object(r["a"])(Object(r["a"])({},t),s)).then((function(t){e.yearDetailLoading=!1,e.yearDetailTableData=t.data.records,e.yearDetailPage.total=t.data.total})).catch((function(t){console.log("err---",t),e.yearDetailLoading=!1}))},pagination1:function(e){this.yearDetailPage.size=e.limit,this.getYearDetailPlanList()},clearDetail:function(){this.yearDetailForm.supervisePurpose="",this.yearDetailForm.superviseProject="",this.getYearDetailPlanList()},showDialog:function(e,t){var s=this;this.formDia=!0,this.$nextTick((function(){s.$refs.formDia.openDia(e,t,s.yearDetailForm.causeType)}))},closeDia:function(){this.formDia=!1,this.getYearDetailPlanList()},records:function(e){var t=this;this.recordsDia=!0,this.$nextTick((function(){t.$refs.recordsDia.openDia(e)}))},closeRecordsDia:function(){this.recordsDia=!1,this.getYearDetailPlanList()},processing:function(e){var t=this;this.processingDia=!0,this.$nextTick((function(){t.$refs.processingDia.openDia(e)}))},closeProcessingDia:function(){this.processingDia=!1,this.getYearDetailPlanList()},rectify:function(e){var t=this;this.rectifyDia=!0,this.$nextTick((function(){t.$refs.rectifyDia.openDia(e)}))},closeRectifyDia:function(){this.rectifyDia=!1,this.getYearDetailPlanList()},openDownloadDia:function(e){this.downloadDialog=!0,this.download=e},controlDown:function(){var e=this;Object(p["k"])({superviseDetailsId:this.download.superviseDetailsId}).then((function(t){var s=new Blob([t],{type:"application/msword"});e.$download.saveAs(s,"记录导出.docx")})).catch((function(e){console.log("err---",e)}))},processingDown:function(){var e=this;Object(p["t"])({superviseDetailsId:this.download.superviseDetailsId}).then((function(t){var s=new Blob([t],{type:"application/msword"});e.$download.saveAs(s,"不符合项导出.docx")})).catch((function(e){console.log("err---",e)}))},supervisoryDown:function(){var e=this;Object(p["l"])({superviseDetailsCorrectId:this.download.superviseDetailsCorrectId}).then((function(t){var s=new Blob([t],{type:"application/msword"});e.$download.saveAs(s,"监督纠正措施.docx")}))},delYearPlanDetail:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.yearDetailLoading=!0,Object(p["i"])({superviseDetailsId:e.superviseDetailsId}).then((function(e){t.yearDetailLoading=!1,t.$message.success("删除成功"),t.getYearDetailPlanList()})).catch((function(e){t.yearDetailLoading=!1,console.log("err---",e)}))}))}},computed:Object(r["a"])({action:function(){return this.javaApi+"/qualitySupervise/importQualitySupervise"}},Object(f["b"])(["userId"]))},v=m,h=(s("edce"),s("2877")),y=Object(h["a"])(v,a,i,!1,null,"33dbc8ed",null);t["default"]=y.exports},edce:function(e,t,s){"use strict";s("d4a0")}}]);