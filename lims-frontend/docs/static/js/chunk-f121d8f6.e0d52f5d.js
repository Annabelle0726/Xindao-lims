(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f121d8f6"],{"05d3":function(e,t,a){},"0e9a":function(e,t,a){"use strict";var n=a("c14f"),i=a("1da1"),r=(a("c19f"),a("ace4"),a("2c66"),a("249d"),a("40e9"),a("d3b7"),a("ac1f"),a("5319"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("6ce5"),a("2834"),a("72f7"),a("4ea1"),a("c343")),l=a("acff"),o=a("2b0e");t["a"]={convertFileToHtml:function(e){return Object(i["a"])(Object(n["a"])().m((function t(){var a,l;return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:return a=new XMLHttpRequest,a.open("GET",o["default"].prototype.javaApi+e,!0),a.send(),a.responseType="blob",l=new Promise((function(e,t){a.onload=Object(i["a"])(Object(n["a"])().m((function t(){var l,o,s,c,d;return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:if(200!==this.status){t.n=2;break}return l=new Blob([this.response],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=new FileReader,o.readAsArrayBuffer(l),s=new Promise((function(e,t){o.onload=Object(i["a"])(Object(n["a"])().m((function t(){var i,l,o;return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:return i=a.response,t.n=1,Object(r["convertToHtml"])({arrayBuffer:i});case 1:l=t.v,o=l.value.replace(//g,"").replace("<h1>",'<h1 style="text-align: center;">').replace(/<table>/g,'<table style="border-collapse: collapse;border: 1px solid #000;">').replace(/<tr>/g,'<tr style="height: 30px;">').replace(/<td>/g,'<td style="border: 1px solid #000;">').replace(/<p>/g,'<p style="text-indent: 2em;">').replace(/<a [^>]*>/g,"").replace(/<\/a>/g,""),e(o);case 2:return t.a(2)}}),t)})))})),c=e,t.n=1,s;case 1:d=t.v,c(d);case 2:return t.a(2)}}),t,this)})))})),t.n=1,l;case 1:return t.a(2,t.v)}}),t)})))()},downloadIamge:function(e,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var n=e.getContext("2d");n.drawImage(a,0,0,a.width,a.height);var i=e.toDataURL("image/png"),r=document.createElement("a"),l=new MouseEvent("click");r.download=t||"photo",r.href=i,r.dispatchEvent(l)},a.src=e},compressBlob:function(e){var t=new FileReader;return t.readAsArrayBuffer(e),new Promise((function(a){t.onload=function(){var n=t.result,i=new Uint8Array(n),r=l["a"].deflate(i),o=new Blob([r],{type:e.type});a(o)}}))}}},"2b63":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex_column"},[!e.editPlanShow&&e.isDepartment?a("div",[e._m(0),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[a("span",{staticStyle:{width:"88px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("编制人")]),a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getYearPlanList(e.departId)}},model:{value:e.page.compilerName,callback:function(t){e.$set(e.page,"compilerName",t)},expression:"page.compilerName"}})],1),a("div",{staticStyle:{"line-height":"30px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.getYearPlanList(e.departId)}}},[e._v("查询")])],1)]),a("div",{staticStyle:{"line-height":"30px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.uploadDia=!0,e.getUserList()}}},[e._v("导入")])],1)]),a("lims-table",{attrs:{tableData:e.yearPlanTableData,column:e.yearPlanColumn,currentChange:e.currentChange,height:"40vh",page:e.page,tableLoading:e.yearLoading},on:{pagination:e.pagination}})],1):e._e(),e.editPlanShow?e._e():a("div",{staticClass:"table"},[a("div",[e._m(1),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[a("span",{staticStyle:{width:"88px","font-size":"14px","font-weight":"700",color:"#606266"}},[e._v("培训讲师")]),a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchTable(t)}},model:{value:e.inDetailForm.trainingLecturerName,callback:function(t){e.$set(e.inDetailForm,"trainingLecturerName",t)},expression:"inDetailForm.trainingLecturerName"}})],1),a("div",{staticStyle:{"line-height":"30px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.searchTable}},[e._v("查询")])],1)]),a("div",{staticStyle:{"line-height":"30px"}},[e.isDepartment&&e.currentChangeRow&&e.isOperation?a("el-button",{attrs:{size:"small"},on:{click:e.batchDelete}},[e._v("批量删除")]):e._e(),e.isDepartment&&e.currentChangeRow&&e.isOperation?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.addTrainingPlan("add")}}},[e._v("新增")]):e._e()],1)]),a("lims-table",{attrs:{tableData:e.inDetailPlanTableData,column:e.inDetailPlanColumn,height:e.isDepartment?"40vh":"62vh",isSelection:!0,handleSelectionChange:e.handleSelectionChange,page:e.inDetailPagination,tableLoading:e.yearDetailLoading},on:{pagination:e.pagination1}})],1)]),a("Add",{ref:"addPlan",attrs:{currentChangeRow:e.currentChangeRow},on:{search:function(t){return e.getInDetailPlan(e.currentRowId,e.departId)}}}),e.editPlanShow?a("Edit",{ref:"editPlan",attrs:{currentRow:e.currentRow},on:{del:function(t){return e.getInDetailPlan(e.currentRowId,e.departId)},goBack:e.goBack}}):e._e(),a("el-dialog",{attrs:{visible:e.reviewDialog,title:"审核",width:"30%"},on:{"update:visible":function(t){e.reviewDialog=t},close:function(t){e.auditRemarks=""}}},[a("span",[e._v(" 审核备注： "),a("el-input",{attrs:{type:"textarea"},model:{value:e.auditRemarks,callback:function(t){e.auditRemarks=t},expression:"auditRemarks"}})],1),a("span",{staticStyle:{"margin-top":"10px",display:"inline-block"}},[e._v(" 批准人： "),a("el-select",{staticStyle:{width:"70%"},attrs:{clearable:"",filterable:"",size:"small"},model:{value:e.approverId,callback:function(t){e.approverId=t},expression:"approverId"}},e._l(e.responsibleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.reviewLoading},on:{click:function(t){return e.handleReview(2)}}},[e._v("不通过")]),a("el-button",{attrs:{loading:e.reviewLoading,type:"primary"},on:{click:function(t){return e.handleReview(1)}}},[e._v("通 过")])],1)]),a("el-dialog",{attrs:{visible:e.approvalDialog,title:"批准",width:"30%"},on:{"update:visible":function(t){e.approvalDialog=t},close:function(t){e.approvalRemarks=""}}},[a("span",[e._v(" 批准备注： "),a("el-input",{attrs:{type:"textarea"},model:{value:e.approvalRemarks,callback:function(t){e.approvalRemarks=t},expression:"approvalRemarks"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.approvalLoading},on:{click:function(t){return e.handleApproval(2)}}},[e._v("不批准")]),a("el-button",{attrs:{loading:e.reviewLoading,type:"primary"},on:{click:function(t){return e.handleApproval(1)}}},[e._v("批 准")])],1)]),a("el-dialog",{attrs:{visible:e.uploadDia,title:"数据导入",width:"500px"},on:{"update:visible":function(t){e.uploadDia=t}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("div",{staticStyle:{width:"70px"}},[a("span",{staticClass:"required-span"},[e._v("* ")]),e._v("年份：")]),a("el-date-picker",{attrs:{type:"year","value-format":"yyyy",clearable:"",size:"small",format:"yyyy",placeholder:"选择年"},model:{value:e.planYear,callback:function(t){e.planYear=t},expression:"planYear"}})],1),a("div",{staticStyle:{display:"flex","align-items":"center",margin:"10px 0"}},[a("div",{staticStyle:{width:"70px"}},[a("span",{staticClass:"required-span"},[e._v("* ")]),e._v("审核人：")]),a("el-select",{staticStyle:{width:"50%"},attrs:{clearable:"",filterable:"",size:"small"},model:{value:e.reviewerId,callback:function(t){e.reviewerId=t},expression:"reviewerId"}},e._l(e.responsibleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("div",{staticStyle:{margin:"0 auto"}},[a("el-upload",{ref:"upload",attrs:{action:e.javaApi+"/personTraining/personTrainingImport?planYear="+e.planYear+"&reviewerId="+e.reviewerId,"auto-upload":!1,"before-upload":e.beforeUpload,"file-list":e.fileList,headers:e.uploadHeader,limit:1,"on-error":e.onError,"on-success":e.onSuccess,accept:".xlsx",drag:"",name:"file"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.uploadDia=!1}}},[e._v("取 消")]),a("el-button",{attrs:{loading:e.uploading,type:"primary"},on:{click:function(t){return e.submitUpload()}}},[e._v("上 传")])],1)]),e.ViewRecord?a("view-record",{ref:"ViewRecord"}):e._e()],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("年度计划")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("年度计划明细")])])}],r=a("5530"),l=(a("a15b"),a("14d9"),a("fb6a"),a("a9e3"),a("d3b7"),a("0643"),a("4e3e"),a("159b"),a("4dd5")),o=a("896b"),s=a("c600"),c=a("00d5"),d=a("2f62"),u=a("9695"),p=a("c0c7"),h={name:"PersonnelTraining",components:{limsTable:c["a"],ViewRecord:s["default"],Add:l["default"],Edit:o["default"]},props:{departId:{type:Number,default:function(){return null}},isDepartment:{type:Boolean,default:!1}},computed:Object(r["a"])({},Object(d["b"])(["userId"])),data:function(){var e=this;return{planYear:"",reviewerId:"",responsibleOptions:[],search:{},superviseForm:{},inDetailForm:{trainingLecturerName:"",trainingDate:""},yearLoading:!1,yearDetailLoading:!1,yearPlanTableData:[],yearPlanColumn:[{label:"文件名称",width:"160px",prop:"fileName"},{label:"创建时间",width:"160px",prop:"createTime"},{label:"编制人",prop:"compilerName"},{label:"编制日期",width:"160px",prop:"compilationDate"},{label:"审核人",prop:"reviewerName",minWidth:"100px"},{dataType:"tag",label:"审核状态",prop:"reviewerStatus",width:"100px",formatData:function(e){return 1==e?"通过":2==e?"不通过":null},formatType:function(e){return 1==e?"success":2==e?"danger":null}},{label:"审核备注",prop:"auditRemarks",minWidth:"100px"},{label:"审核日期",width:"160px",prop:"auditDate"},{label:"批准人",prop:"approverName",minWidth:"100px"},{label:"批准备注",prop:"approvalRemarks",minWidth:"100px"},{dataType:"tag",label:"批准状态",minWidth:"100px",prop:"approvalStatus",formatData:function(e){return 1==e?"批准":2==e?"不批准":null},formatType:function(e){return 1==e?"success":2==e?"danger":null}},{label:"批准日期",width:"160px",prop:"approvalDate"},{dataType:"action",width:"180px",label:"操作",fixed:"right",operation:[{name:"导出",type:"text",disabled:function(e){return 1!==e.approvalStatus||1!==e.reviewerStatus},clickFun:function(t){e.downLoadPost(t)}},{name:"审核",type:"text",disabled:function(t){return 1===t.reviewerStatus||e.userId!=t.reviewerId},clickFun:function(t){e.handleCheck(t.id)}},{name:"批准",type:"text",disabled:function(t){return 1===t.approvalStatus||e.userId!=t.approverId||1!=t.reviewerStatus},clickFun:function(t){e.handleApprove(t.id)}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.deleteFun(t.id)},disabled:function(e){return 1===e.reviewerStatus}}]}],inDetailPlanTableData:[],inDetailPlanColumn:[{label:"培训目标",prop:"trainingObjectives",width:"100px"},{label:"培训内容",prop:"trainingContent",width:"100px"},{label:"培训方式",prop:"trainingMode",width:"100px"},{dataType:"tag",label:"课程状态",width:"100px",prop:"state",formatData:function(e){return 1==e?"已完成":2==e?"待评价":3==e?"未开始":null},formatType:function(e){return 1==e?"success":2==e?"warning":3==e?"primary":4==e?"info":null}},{label:"参加对象",prop:"participants",width:"100px"},{label:"举办部门",prop:"holdingDepartment",width:"100px"},{label:"培训讲师",prop:"trainingLecturerName",width:"100px"},{label:"培训日期",prop:"trainingDate",width:"100px"},{label:"开始时间",prop:"openingTime",width:"100px"},{label:"课时",prop:"classHour",width:"100px"},{label:"备注",prop:"remarks",width:"100px"},{dataType:"action",width:"200",label:"操作",fixed:"right",operation:[{name:"编辑",type:"text",clickFun:function(t){e.addTrainingPlan("edit",t)}},{name:"结果明细",type:"text",clickFun:function(t){e.editInDetail(t)},showHide:function(){return!!e.isDepartment}},{name:"附件",type:"text",clickFun:function(t){e.viewRecord(t)}},{name:"导出",type:"text",clickFun:function(t){e.downLoadInDetail(t)}}]}],page:{total:0,size:10,current:1,compilerName:""},inDetailPagination:{total:0,size:10,current:1},editPlanShow:!1,currentRow:{},currentRowId:null,auditRemarks:"",reviewDialog:!1,reviewLoading:!1,approvalRemarks:"",approvalDialog:!1,approvalLoading:!1,multipleSelection:[],uploadDia:!1,uploading:!1,isOperation:!1,ViewRecord:!1,fileList:[],currentChangeRow:{},approverId:""}},mounted:function(){this.isDepartment?this.getYearPlanList(this.departId):this.getInDetailPlan("",this.departId)},methods:{searchTable:function(){this.getInDetailPlan(this.currentRowId)},getYearPlanList:function(e){var t=this;this.yearLoading=!0;var a=this.isDepartment?{departmentId:e,size:this.page.size,current:this.page.current,compilerName:this.page.compilerName}:{userId:e,size:this.page.size,current:this.page.current,compilerName:this.page.compilerName};Object(u["k"])(a).then((function(e){t.yearLoading=!1,t.yearPlanTableData=e.data.records,t.pagination.total=e.data.total,t.yearPlanTableData.length>0&&(t.currentRowId=t.yearPlanTableData[0].id,t.currentChange(t.yearPlanTableData[0]))})).catch((function(e){t.yearLoading=!1}))},pagination:function(e){this.page.size=e.limit,this.getYearPlanList()},currentChange:function(e){var t=new Date,a=t.getFullYear();e&&(this.currentChangeRow=e,this.currentRowId=e.id,e.createTime.slice(0,4)==a?this.isOperation=!0:this.isOperation=!1,this.getInDetailPlan(e.id))},getInDetailPlan:function(e){var t=this;null===this.inDetailForm.trainingDate&&(this.inDetailForm.trainingDate="");var a=this.isDepartment?"":this.departId,n={userId:a,size:this.inDetailPagination.pageSize,current:this.inDetailPagination.current,id:e,trainingLecturerName:this.inDetailForm.trainingLecturerName,trainingDate:this.inDetailForm.trainingDate};this.yearDetailLoading=!0,Object(u["m"])(n).then((function(e){t.yearDetailLoading=!1,t.inDetailPlanTableData=e.data.records,t.inDetailPagination.total=e.data.total})).catch((function(e){t.yearDetailLoading=!1}))},pagination1:function(e){this.inDetailPagination.size=e.limit,this.getInDetailPlan(this.currentRowId)},addTrainingPlan:function(e,t){this.currentRowId?this.$refs.addPlan.showDialog(this.currentRowId,e,t):this.$message.warning("请选择一条计划进行新增")},deleteFun:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["l"])({id:e}).then((function(e){t.$message.success("删除成功！"),t.getYearPlanList(t.departId)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleCheck:function(e){this.currentRowId=e,this.reviewDialog=!0,this.getUserList()},handleReview:function(e){var t=this,a={id:this.currentRowId,auditRemarks:this.auditRemarks,reviewerStatus:e,approverId:this.approverId};this.reviewLoading=!0,Object(u["n"])(a).then((function(e){200===e.code&&(t.$message.success("提交成功！"),t.reviewDialog=!1,t.getYearPlanList(t.departId)),t.reviewLoading=!1})).catch((function(){t.reviewLoading=!1}))},handleApprove:function(e){this.currentRowId=e,this.approvalDialog=!0},handleApproval:function(e){var t=this,a={id:this.currentRowId,approvalRemarks:this.approvalRemarks,approvalStatus:e};this.approvalLoading=!0,Object(u["b"])(a).then((function(e){200===e.code&&(t.$message.success("提交成功！"),t.approvalDialog=!1,t.getYearPlanList(t.departId)),t.approvalLoading=!1})).catch((function(){t.approvalLoading=!1}))},downLoadPost:function(e){var t=this;Object(u["f"])({id:e.id}).then((function(a){t.outLoading=!1;var n=new Blob([a],{type:"application/msword"});t.$download.saveAs(n,e.fileName+".docx")}))},submitUpload:function(){this.planYear?this.reviewerId?0!=this.$refs.upload.uploadFiles.length?(this.uploading=!0,this.$refs.upload.submit(),this.uploading=!1):this.$message.error("未选择文件"):this.$message.error("请选择审核人"):this.$message.error("请选择年份")},onSuccess:function(e,t,a){this.$refs.upload.clearFiles(),this.uploadDia=!1,this.uploading=!1,200==e.code?(this.$message.success("上传成功"),this.standardList=[],this.productList=[],this.getYearPlanList(this.departId)):this.$message.error(e.msg)},onError:function(e,t,a){this.$message.error("上传失败"),this.$refs.upload.clearFiles(),this.uploading=!1},beforeUpload:function(e,t){if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type)return this.$message.error("上传文件格式不正确"),this.$refs.upload.clearFiles(),!1},editInDetail:function(e){this.editPlanShow=!0,this.currentRow=e},goBack:function(){this.editPlanShow=!1,this.getInDetailPlan(this.currentRowId)},viewRecord:function(e){var t=this;this.ViewRecord=!0,this.$nextTick((function(){t.$refs.ViewRecord.openDia(e)}))},downLoadInDetail:function(e){var t=this;Object(u["g"])({id:e.id}).then((function(e){t.outLoading=!1;var a=new Blob([e],{type:"application/msword"});t.$download.saveAs(a,"人员培训与考核记录.docx")}))},handleSelectionChange:function(e){this.multipleSelection=e},batchDelete:function(){var e=this;if(this.multipleSelection.length>0){var t=[];this.multipleSelection.forEach((function(e){t.push(e.id)})),this.$confirm("是否确认删除所选择的数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["d"])({ids:t.join(",")}).then((function(t){200==t.code&&(e.$message.success("删除成功"),e.getInDetailPlan(e.currentRowId))}))})).catch((function(){e.$message.warning("取消删除")}))}else this.$message.warning("请选择需要删除的数据")},handleSizeChange:function(e){this.inDetailPagination.size=e,this.getInDetailPlan(this.currentChangeRow.id)},handleCurrentChange:function(e){this.inDetailPagination.current=e,this.getInDetailPlan(this.currentChangeRow.id)},getUserList:function(){var e=this;Object(p["o"])().then((function(t){200==t.code&&(e.responsibleOptions=t.data)}))}},watch:{departId:{handler:function(e,t){this.isDepartment?this.getYearPlanList(e):this.getInDetailPlan("")}},currentRowId:{handler:function(e,t){e&&(console.log("newId",e),this.inDetailPagination.current=1,this.getInDetailPlan(this.currentChangeRow.id))}}}},f=h,g=(a("5f2c"),a("2877")),m=Object(g["a"])(f,n,i,!1,null,"10a538b5",null);t["default"]=m.exports},"4dd5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.addTrainingPlanDia,title:"新增培训计划",width:"50%"},on:{"update:visible":function(t){e.addTrainingPlanDia=t},close:e.closeAdd}},[a("div",{staticClass:"body"},[a("el-form",{ref:"trainingPlanForm",attrs:{model:e.trainingPlan,"label-position":"right","label-width":"90px",rules:e.trainingPlanRules}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"培训日期:",prop:"trainingDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{format:"yyyy-MM",placeholder:"选择日期",size:"small","value-format":"yyyy-MM",type:"month"},model:{value:e.trainingPlan.trainingDate,callback:function(t){e.$set(e.trainingPlan,"trainingDate",t)},expression:"trainingPlan.trainingDate"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"课时:",prop:"classHour"}},[a("el-input",{attrs:{type:"number",label:"描述文字",size:"small"},model:{value:e.trainingPlan.classHour,callback:function(t){e.$set(e.trainingPlan,"classHour",t)},expression:"trainingPlan.classHour"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"培训目标:",prop:"trainingObjectives"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.trainingObjectives,callback:function(t){e.$set(e.trainingPlan,"trainingObjectives",t)},expression:"trainingPlan.trainingObjectives"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"参加对象:",prop:"participants"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.participants,callback:function(t){e.$set(e.trainingPlan,"participants",t)},expression:"trainingPlan.participants"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"培训内容:",prop:"trainingContent"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.trainingContent,callback:function(t){e.$set(e.trainingPlan,"trainingContent",t)},expression:"trainingPlan.trainingContent"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"培训讲师:",prop:"trainingLecturerId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:"请选择",size:"small"},model:{value:e.trainingPlan.trainingLecturerId,callback:function(t){e.$set(e.trainingPlan,"trainingLecturerId",t)},expression:"trainingPlan.trainingLecturerId"}},e._l(e.responsibleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"培训方式:",prop:"trainingMode"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.trainingMode,callback:function(t){e.$set(e.trainingPlan,"trainingMode",t)},expression:"trainingPlan.trainingMode"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"举办部门:",prop:"holdingDepartment"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.holdingDepartment,callback:function(t){e.$set(e.trainingPlan,"holdingDepartment",t)},expression:"trainingPlan.holdingDepartment"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注:",prop:"remarks"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.trainingPlan.remarks,callback:function(t){e.$set(e.trainingPlan,"remarks",t)},expression:"trainingPlan.remarks"}})],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeAdd}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.submitAddLoading},on:{click:e.submitAdd}},[e._v("确 定")])],1)])],1)},i=[],r=a("9695"),l=a("c0c7"),o={props:{currentChangeRow:{type:Object,default:function(){return{}}}},name:"Add",components:{},data:function(){return{addTrainingPlanDia:!1,submitAddLoading:!1,trainingPlan:{planId:"",id:"",trainingDate:"",classHour:"",trainingObjectives:"",participants:"",trainingContent:"",trainingLecturerId:"",trainingMode:"",holdingDepartment:"",remarks:""},trainingPlanRules:{trainingDate:[{required:!0,message:"请选择培训日期",trigger:"change"}],trainingContent:[{required:!0,message:"请输入培训内容",trigger:"blur"}],trainingLecturerId:[{required:!0,message:"请选择培训讲师",trigger:"blur"}]},responsibleOptions:[],operationType:""}},methods:{showDialog:function(e,t,a){this.addTrainingPlanDia=!0,this.operationType=t,"edit"===this.operationType?this.trainingPlan=this.HaveJson(a):this.trainingPlan={id:"",trainingDate:"",classHour:"",trainingObjectives:"",participants:"",trainingContent:"",trainingLecturerId:"",trainingMode:"",holdingDepartment:"",remarks:""},this.trainingPlan.planId=e,this.getUserList()},submitAdd:function(){var e=this;this.$refs.trainingPlanForm.validate((function(t){if(t){e.submitAddLoading=!0,e.trainingPlan.planId=e.currentChangeRow.id;var a=e.trainingPlan;Object(r["a"])(a).then((function(t){e.submitAddLoading=!1,200==t.code&&(e.$message.success("提交成功"),e.closeAdd())})).catch((function(){e.submitAddLoading=!1}))}}))},closeAdd:function(){this.$refs["trainingPlanForm"].resetFields(),this.$emit("search"),this.addTrainingPlanDia=!1},getUserList:function(){var e=this;Object(l["o"])({type:2}).then((function(t){200==t.code&&(e.responsibleOptions=t.data)}))}}},s=o,c=a("2877"),d=Object(c["a"])(s,n,i,!1,null,"41007913",null);t["default"]=d.exports},"5f2c":function(e,t,a){"use strict";a("05d3")},"5fd5":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return o}));var n=a("b775");function i(e){return Object(n["a"])({url:"/system/custom/selectCustomPageList",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/system/custom/addCustom",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/system/custom/upCustom",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/system/custom/delCustomById",method:"delete",params:e})}},c0c7:function(e,t,a){"use strict";a.d(t,"j",(function(){return r})),a.d(t,"h",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"r",(function(){return s})),a.d(t,"e",(function(){return c})),a.d(t,"k",(function(){return d})),a.d(t,"d",(function(){return u})),a.d(t,"i",(function(){return p})),a.d(t,"s",(function(){return h})),a.d(t,"t",(function(){return f})),a.d(t,"u",(function(){return g})),a.d(t,"g",(function(){return m})),a.d(t,"q",(function(){return b})),a.d(t,"f",(function(){return v})),a.d(t,"l",(function(){return w})),a.d(t,"n",(function(){return y})),a.d(t,"b",(function(){return D})),a.d(t,"m",(function(){return x})),a.d(t,"a",(function(){return P})),a.d(t,"p",(function(){return k})),a.d(t,"o",(function(){return I}));var n=a("b775"),i=a("c38a");function r(e){return Object(n["a"])({url:"/system/user/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/system/user/"+Object(i["e"])(e),method:"get"})}function o(e){return Object(n["a"])({url:"/system/user",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/system/user",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/system/user/"+e,method:"delete"})}function d(e,t){var a={userId:e,password:t};return Object(n["a"])({url:"/system/user/resetPwd",method:"put",data:a})}function u(e,t){var a={userId:e,status:t};return Object(n["a"])({url:"/system/user/changeStatus",method:"put",data:a})}function p(){return Object(n["a"])({url:"/system/user/profile",method:"get"})}function h(e){return Object(n["a"])({url:"/system/user/profile",method:"put",data:e})}function f(e,t){var a={oldPassword:e,newPassword:t};return Object(n["a"])({url:"/system/user/profile/updatePwd",method:"put",data:a})}function g(e){return Object(n["a"])({url:"/system/user/profile/avatar",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:e})}function m(e){return Object(n["a"])({url:"/system/user/authRole/"+e,method:"get"})}function b(e){return Object(n["a"])({url:"/system/user/authRole",method:"put",params:e})}function v(){return Object(n["a"])({url:"/system/user/deptTree",method:"get"})}function w(){return Object(n["a"])({url:"/companies/selectCompaniesList",method:"get"})}function y(e){return Object(n["a"])({url:"/companies/selectSimpleList",method:"post",params:e})}function D(e){return Object(n["a"])({url:"/companies/addPersonUser",method:"post",data:e})}function x(){return Object(n["a"])({url:"/system/custom/selectCustomEnum",method:"get"})}function P(e){return Object(n["a"])({url:"/department/addDepartment",method:"post",data:e})}function k(e){return Object(n["a"])({url:"/system/newUser/selectUserDepartmentLimsName",method:"get"})}function I(e){return Object(n["a"])({url:"/system/newUser/selectUserCondition",method:"get",params:e})}},c600:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.filesDialogVisible,title:"附件上传",width:"80%"},on:{"update:visible":function(t){e.filesDialogVisible=t},closed:e.closeFilesLook}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("el-upload",{ref:"upload",staticStyle:{width:"80px !important"},attrs:{action:e.fileAction,"auto-upload":!0,"before-upload":e.fileBeforeUpload,data:{trainingDetailedId:e.info.id},headers:e.uploadHeader,"on-error":e.onError,"on-success":e.handleSuccessUp,"show-file-list":!1,accept:".jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.zip,.rar"}},[a("el-button",{staticStyle:{height:"38px"},attrs:{size:"small",type:"primary"}},[e._v("附件上传")])],1)],1),a("div",[a("lims-table",{attrs:{tableData:e.tableData,column:e.columnData,height:"calc(100vh - 47em)",highlightCurrentRow:!0,tableLoading:e.tableLoading}})],1)]),a("el-dialog",{attrs:{visible:e.lookDialogVisible,fullscreen:"",title:"查看附件",width:"800px"},on:{"update:visible":function(t){e.lookDialogVisible=t}}},[e.lookDialogVisible?a("filePreview",{staticStyle:{height:"90vh","overflow-y":"auto",top:"0"},attrs:{currentFile:{},fileUrl:e.javaApi+"/word/"+e.currentInfo.fileUrl}}):e._e()],1)],1)},i=[],r=(a("d3b7"),a("0e9a")),l=a("a408"),o=a("00d5"),s=a("9695"),c=(a("5fd5"),{name:"ViewRecord",components:{limsTable:o["a"],filePreview:l["a"]},data:function(){var e=this;return{filesDialogVisible:!1,tableLoading:!1,filesLookInfo:{},columnData:[{label:"文件名称",prop:"fileName",minWidth:"150px"},{dataType:"action",minWidth:"100",label:"操作",fixed:"right",operation:[{name:"预览",type:"text",clickFun:function(t){e.handleLook(t)}},{name:"下载",type:"text",clickFun:function(t){e.upload(t)}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(t){e.delete(t)}}]}],tableData:[],info:{},currentInfo:{},lookDialogVisible:!1}},methods:{openDia:function(e){this.filesDialogVisible=!0,this.info=e,this.searchTableList()},searchTableList:function(){var e=this;this.tableLoading=!0,Object(s["h"])({trainingDetailedId:this.info.id}).then((function(t){e.tableLoading=!1,e.tableData=t.data})).catch((function(t){e.tableLoading=!1,console.log("err---",t)}))},closeFilesLook:function(){this.filesDialogVisible=!1},upload:function(e){var t="";if(1==e.type)t=this.javaApi+"/img/"+e.fileUrl,r["a"].downloadIamge(t,e.fileName);else{t=this.javaApi+"/word/"+e.fileUrl;var a=document.createElement("a");a.href=t,a.download=e.fileName,a.click()}},delete:function(e){var t=this;this.$confirm("是否删除当前数据?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.tableLoading=!0,Object(s["c"])({detailedFileId:e.detailedFileId}).then((function(e){t.tableLoading=!1,t.$message.success("删除成功"),t.searchTableList()})).catch((function(e){t.tableLoading=!1,console.log("err---",e)}))})).catch((function(){}))},fileBeforeUpload:function(e){var t=!0;if(e.size>10485760&&(this.$message.error("上传文件不超过10M"),this.$refs.upload.clearFiles(),t=!1),!t)return Promise.reject(t)},onError:function(e,t,a,n){this.$message.error("上传失败"),this.$refs.upload.clearFiles()},handleSuccessUp:function(e){this.upLoading=!1,200==e.code&&(this.$message.success("上传成功"),this.searchTableList())},handleLook:function(e){this.currentInfo=e,this.lookDialogVisible=!0}},computed:{fileAction:function(){return this.javaApi+"/personTraining/uploadTrainingDetailedFile"}}}),d=c,u=a("2877"),p=Object(u["a"])(d,n,i,!1,null,"013314ba",null);t["default"]=p.exports}}]);