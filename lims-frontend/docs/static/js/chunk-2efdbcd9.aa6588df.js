(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2efdbcd9"],{"09d1":function(e,a,t){},"3bf5":function(e,a,t){"use strict";t("7accf")},"7accf":function(e,a,t){},"93dd":function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"search"},[t("div",[t("el-form",{ref:"searchForm",attrs:{model:e.searchForm,size:"small",inline:!0}},[t("el-form-item",{attrs:{label:"审核目的",prop:"laboratoryName"}},[t("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.searchForm.purposes,callback:function(a){e.$set(e.searchForm,"purposes",a)},expression:"searchForm.purposes"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchList}},[e._v("查询")]),t("el-button",{attrs:{size:"mini"},on:{click:e.resetSearchForm}},[e._v("重置")])],1)],1)],1),t("div",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.openFormDia("add")}}},[e._v("新 增")])],1)]),t("div",{staticClass:"table"},[t("limsTable",{staticStyle:{padding:"0 10px","margin-bottom":"16px"},attrs:{column:e.tableColumn,height:"calc(100vh - 23em)","table-data":e.tableData,"table-loading":e.tableLoading,page:e.page},on:{pagination:e.pagination}})],1),e.auditReportDia?t("audit-report-dia",{ref:"auditReportDia",on:{closeImplementDia:e.closeImplementDia}}):e._e()],1)},i=[],r=t("5530"),l=t("00d5"),n=t("b02e"),s=t("5545"),p={name:"auditReport",components:{AuditReportDia:n["default"],limsTable:l["a"]},data:function(){var e=this;return{searchForm:{purposes:""},tableColumn:[{label:"审核目的",prop:"purposes"},{label:"审核依据",prop:"basis"},{label:"审核日期",prop:"reviewDate"},{label:"审核方法",prop:"method"},{label:"审核范围",prop:"scope"},{label:"审核责任者",prop:"responsible"},{label:"审核组长",prop:"leader"},{label:"审核员",prop:"auditor"},{label:"审核组分工情况",prop:"division"},{dataType:"tag",label:"审核状态",prop:"examineStatus",minWidth:"100",formatData:function(e){return 0===e?"不通过":1===e?"通过":null},formatType:function(e){return 0===e?"danger":1===e?"success":null}},{label:"审核内容",prop:"examineRemark",minWidth:"140"},{dataType:"tag",label:"质量负责人状态",prop:"qualityStatus",minWidth:"100",formatData:function(e){return 0===e?"不通过":1===e?"通过":null},formatType:function(e){return 0===e?"danger":1===e?"success":null}},{label:"质量负责人意见",prop:"qualityRemark",minWidth:"140"},{dataType:"action",minWidth:"220",fixed:"right",label:"操作",operation:[{name:"导出",type:"text",clickFun:function(a){e.handleDown(a)}},{name:"编辑",type:"text",clickFun:function(a){e.openFormDia("edit",a)},disabled:function(e){return 1===e.examineStatus||1===e.examineStatus}},{name:"审核",type:"text",clickFun:function(a){e.openFormDia("examine",a)},disabled:function(e){return 1===e.examineStatus}},{name:"意见",type:"text",clickFun:function(a){e.openFormDia("ratify",a)},disabled:function(e){return 1===e.qualityStatus||0===e.examineStatus||null===e.examineStatus}},{name:"删除",type:"text",color:"#f56c6c",clickFun:function(a){e.delPlan(a)},disabled:function(e){return 1===e.qualityStatus}}]}],tableData:[],tableLoading:!1,page:{size:20,current:1,total:0},auditReportDia:!1}},mounted:function(){this.searchList()},methods:{searchList:function(){var e=this,a=this.searchForm,t=this.page;this.tableLoading=!0,Object(s["G"])(Object(r["a"])(Object(r["a"])({},a),t)).then((function(a){e.tableLoading=!1,e.tableData=a.data.records,e.page.total=a.data.total})).catch((function(a){console.log("err---",a),e.tableLoading=!1}))},openFormDia:function(e,a){var t=this;this.auditReportDia=!0,this.$nextTick((function(){t.$refs.auditReportDia.openDia(e,a)}))},closeImplementDia:function(){this.auditReportDia=!1,this.searchList()},resetSearchForm:function(){this.searchForm.purposes="",this.searchList()},delPlan:function(e){var a=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.tableLoading=!0,Object(s["l"])({reportId:e.reportId}).then((function(e){a.tableLoading=!1,a.$message.success("删除成功"),a.searchList()})).catch((function(e){a.tableLoading=!1,console.log("err---",e)}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},handleDown:function(e){var a=this;Object(s["t"])({reportId:e.reportId}).then((function(e){a.outLoading=!1;var t=new Blob([e],{type:"application/msword"});a.$download.saveAs(t,"内审报告.docx")}))},pagination:function(e){var a=e.page,t=e.limit;this.page.current=a,this.page.size=t,this.searchList()}}},c=p,m=(t("3bf5"),t("2877")),u=Object(m["a"])(c,o,i,!1,null,"17af383a",null);a["default"]=u.exports},b02e:function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.diaLoading,expression:"diaLoading"}],attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.formDia,title:"内部审核报告",width:"80%"},on:{"update:visible":function(a){e.formDia=a},close:e.closeImplementDia}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"top","label-width":"auto"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核目的",prop:"purposes"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.purposes,callback:function(a){e.$set(e.form,"purposes",a)},expression:"form.purposes"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核依据",prop:"basis"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.basis,callback:function(a){e.$set(e.form,"basis",a)},expression:"form.basis"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核日期",prop:"reviewDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",format:"yyyy-MM-dd",placeholder:"选择日期",size:"small",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.reviewDate,callback:function(a){e.$set(e.form,"reviewDate",a)},expression:"form.reviewDate"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核方法",prop:"method"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.method,callback:function(a){e.$set(e.form,"method",a)},expression:"form.method"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核范围",prop:"scope"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.scope,callback:function(a){e.$set(e.form,"scope",a)},expression:"form.scope"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核责任者",prop:"responsible"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.responsible,callback:function(a){e.$set(e.form,"responsible",a)},expression:"form.responsible"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核组长",prop:"leader"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.leader,callback:function(a){e.$set(e.form,"leader",a)},expression:"form.leader"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核员",prop:"auditor"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.auditor,callback:function(a){e.$set(e.form,"auditor",a)},expression:"form.auditor"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核组分工情况",prop:"division"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,clearable:"",size:"small"},model:{value:e.form.division,callback:function(a){e.$set(e.form,"division",a)},expression:"form.division"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"审核概况",prop:"overview"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.overview,callback:function(a){e.$set(e.form,"overview",a)},expression:"form.overview"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"内审组对中心管理体系的结论性评价",prop:"conclusion"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.conclusion,callback:function(a){e.$set(e.form,"conclusion",a)},expression:"form.conclusion"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"改进意见",prop:"suggest"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.suggest,callback:function(a){e.$set(e.form,"suggest",a)},expression:"form.suggest"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"预计受审核部门完成纠正措施所需时间",prop:"actionDate"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.actionDate,callback:function(a){e.$set(e.form,"actionDate",a)},expression:"form.actionDate"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"不符合情况整改总体跟进确认人",prop:"followUser"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.followUser,callback:function(a){e.$set(e.form,"followUser",a)},expression:"form.followUser"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"不符合情况整改总体跟进确认记录",prop:"followRecord"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.followRecord,callback:function(a){e.$set(e.form,"followRecord",a)},expression:"form.followRecord"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"本报告发放范围",prop:"reportScope"}},[t("el-input",{attrs:{disabled:"examine"===e.operationType||"ratify"===e.operationType,rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.reportScope,callback:function(a){e.$set(e.form,"reportScope",a)},expression:"form.reportScope"}})],1)],1),"ratify"===e.operationType?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"质量负责人意见",prop:"qualityRemark"}},[t("el-input",{attrs:{rows:3,clearable:"",size:"small",type:"textarea"},model:{value:e.form.qualityRemark,callback:function(a){e.$set(e.form,"qualityRemark",a)},expression:"form.qualityRemark"}})],1)],1):e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["examine"===e.operationType?t("el-button",{attrs:{loading:e.loading},on:{click:function(a){return e.examine(0)}}},[e._v("不通过")]):e._e(),"examine"===e.operationType?t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(a){return e.examine(1)}}},[e._v("通 过")]):e._e(),"ratify"===e.operationType?t("el-button",{attrs:{loading:e.loading},on:{click:function(a){return e.handleApproval(0)}}},[e._v("不批准")]):e._e(),"ratify"===e.operationType?t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(a){return e.handleApproval(1)}}},[e._v("批 准")]):e._e(),"ratify"!==e.operationType&&"examine"!==e.operationType?t("el-button",{on:{click:e.closeImplementDia}},[e._v("取 消")]):e._e(),"ratify"!==e.operationType&&"examine"!==e.operationType?t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleEdit}},[e._v("提 交")]):e._e()],1)],1),t("el-dialog",{attrs:{visible:e.examineDialog,title:"审核",width:"30%"},on:{"update:visible":function(a){e.examineDialog=a},close:function(a){e.examineDialog=!1}}},[t("span",[e._v(" 审核备注： "),t("el-input",{attrs:{type:"textarea"},model:{value:e.examineRemark,callback:function(a){e.examineRemark=a},expression:"examineRemark"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.examineLoading},on:{click:function(a){e.examineDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{loading:e.examineLoading,type:"primary"},on:{click:function(a){return e.handleExamine(0)}}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{visible:e.approvalDialog,title:"批准",width:"30%"},on:{"update:visible":function(a){e.approvalDialog=a},close:function(a){e.approvalDialog=!1}}},[t("span",[e._v(" 批准备注： "),t("el-input",{attrs:{type:"textarea"},model:{value:e.qualityRemark,callback:function(a){e.qualityRemark=a},expression:"qualityRemark"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.approvalLoading},on:{click:function(a){e.approvalDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{loading:e.approvalLoading,type:"primary"},on:{click:function(a){return e.handleApproval(0)}}},[e._v("确 定")])],1)])],1)},i=[],r=t("5545"),l={name:"auditReportDia",components:{},data:function(){return{formDia:!1,diaLoading:!1,loading:!1,form:{purposes:"",basis:"",reviewDate:"",method:"",scope:"",responsible:"",leader:"",auditor:"",division:"",overview:"",conclusion:"",suggest:"",actionDate:"",followUser:"",followRecord:"",reportScope:"",qualityRemark:""},rules:{purposes:[{required:!0,message:"请填写审核目的",trigger:"blur"}],basis:[{required:!0,message:"请填写审核依据",trigger:"blur"}],reviewDate:[{required:!0,message:"请填写审核日期",trigger:"change"}],method:[{required:!0,message:"请填写审核方法",trigger:"blur"}],scope:[{required:!0,message:"请填写审核范围",trigger:"blur"}],responsible:[{required:!0,message:"请填写审核责任者",trigger:"blur"}],leader:[{required:!0,message:"请填写审核组长",trigger:"blur"}],auditor:[{required:!0,message:"请填写审核员",trigger:"blur"}],division:[{required:!0,message:"请填写审核组分工情况",trigger:"blur"}],overview:[{required:!0,message:"请填写审核概况",trigger:"blur"}],conclusion:[{required:!0,message:"请填写",trigger:"blur"}],suggest:[{required:!0,message:"请填写",trigger:"blur"}],actionDate:[{required:!0,message:"请填写",trigger:"blur"}],followUser:[{required:!0,message:"请填写",trigger:"blur"}],followRecord:[{required:!0,message:"请填写",trigger:"blur"}],reportScope:[{required:!0,message:"请填写",trigger:"blur"}],qualityRemark:[{required:!0,message:"请填写",trigger:"blur"}]},operationType:"",approvalDialog:!1,approvalLoading:!1,examineDialog:!1,examineLoading:!1,qualityRemark:"",examineRemark:""}},mounted:function(){},methods:{openDia:function(e,a){this.formDia=!0,this.operationType=e,"add"!==e&&this.searchInfo(a)},searchInfo:function(e){var a=this;this.diaLoading=!0,Object(r["A"])({reportId:e.reportId}).then((function(e){a.diaLoading=!1,a.form=e.data})).catch((function(e){console.log(e),a.diaLoading=!1}))},handleEdit:function(){var e=this;this.$refs["form"].validate((function(a){if(!a)return console.log("error submit!!"),!1;e.loading=!0;var t=e.HaveJson(e.form);"add"===e.operationType?Object(r["f"])(t).then((function(a){e.loading=!1,e.$message.success("操作成功"),e.closeImplementDia()})).catch((function(a){console.log("err---",a),e.loading=!1})):"edit"===e.operationType&&Object(r["P"])(t).then((function(a){e.loading=!1,e.$message.success("操作成功"),e.closeImplementDia()})).catch((function(a){console.log("err---",a),e.loading=!1}))}))},examine:function(e){0===e?this.examineDialog=!0:this.handleExamine(e)},handleExamine:function(e){var a=this;this.examineLoading=!0;var t=this.HaveJson(this.form);t.examineStatus=e,Object(r["n"])(t).then((function(e){200===e.code&&(a.$message.success("提交成功！"),a.approvalDialog=!1,a.closeImplementDia(a.departId)),a.examineLoading=!1})).catch((function(){a.examineLoading=!1}))},handleApproval:function(e){var a=this;this.approvalLoading=!0;var t=this.HaveJson(this.form);t.qualityStatus=e,Object(r["H"])(t).then((function(e){200===e.code&&(a.$message.success("提交成功！"),a.approvalDialog=!1,a.closeImplementDia(a.departId)),a.approvalLoading=!1})).catch((function(){a.approvalLoading=!1}))},closeImplementDia:function(){this.$refs.form.resetFields(),this.formDia=!1,this.$emit("closeImplementDia")}}},n=l,s=(t("f6cb"),t("2877")),p=Object(s["a"])(n,o,i,!1,null,"7dafd9b1",null);a["default"]=p.exports},f6cb:function(e,a,t){"use strict";t("09d1")}}]);