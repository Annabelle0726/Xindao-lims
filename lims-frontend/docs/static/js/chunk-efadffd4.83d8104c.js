(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-efadffd4","chunk-3b3441e8","chunk-2e219286"],{"0813":function(e,t,a){},"22df":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{"close-on-press-escape":!1,visible:e.isShow,title:"不合格处理",width:"1040px"},on:{"update:visible":function(t){e.isShow=t},close:function(t){return e.$emit("closeOAProcess")}}},[a("table",{staticClass:"table",attrs:{border:!0}},[a("tr",[a("th",{staticClass:"th-title"},[e._v("1检验员")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.oneOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.oneInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.oneName)),e.oneName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.oneTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("2检测主管确认")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.twoOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.twoInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.twoName)),e.twoName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.twoTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("3物流部确认")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.threeOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.threeInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.threeName)),e.threeName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.threeTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("4产品工程师处理意见")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.fourOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.fourInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.fourName)),e.fourName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.fourTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("5.总工或者副经理的处理意见")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.fiveOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.fiveInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.fiveName)),e.fiveName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.fiveTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("6质量部")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.sixOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.sixInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.sixName)),e.sixName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.sixTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("7质量部经理")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.sevenOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.sevenInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.sevenName)),e.sevenName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.sevenTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("8核算员")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.eightOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.eightInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.eightName)),e.eightName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.eightTime))])]),a("tr",[a("th",{staticClass:"th-title"},[e._v("9物流部索赔结果")]),a("th",{staticClass:"th-titleSec"},[e._v("处理结果")]),a("th",{staticClass:"th-info1"},[e._v(e._s(e.nineOperation))]),a("th",{staticClass:"th-titleSec"},[e._v("处理意见")]),a("th",{staticClass:"th-info",attrs:{colspan:"3"}},[e._v(e._s(e.nineInfo))]),a("th",{staticStyle:{display:"none"}}),a("th",{staticStyle:{display:"none"}}),a("th",[e._v(e._s(e.nineName)),e.nineName?a("span",[e._v("：")]):e._e(),e._v(e._s(e.nineTime))])])])])],1)},i=[],n=(a("d3b7"),a("0643"),a("4e3e"),a("159b"),{name:"OAProcess",components:{},props:{OAProcess:{type:Boolean,default:function(){return!1}}},data:function(){return{isShow:this.OAProcess,oneInfo:"",twoInfo:"",threeInfo:"",fourInfo:"",fiveInfo:"",sixInfo:"",sevenInfo:"",eightInfo:"",nineInfo:"",oneTime:"",twoTime:"",threeTime:"",fourTime:"",fiveTime:"",sixTime:"",sevenTime:"",eightTime:"",nineTime:"",oneName:"",twoName:"",threeName:"",fourName:"",fiveName:"",sixName:"",sevenName:"",eightName:"",nineName:"",oneOperation:"",twoOperation:"",threeOperation:"",fourOperation:"",fiveOperation:"",sixOperation:"",sevenOperation:"",eightOperation:"",nineOperation:""}},methods:{getInfo:function(e){var t=this;this.$axios.post(this.$api.unqualifiedHandler.getOaFlow,{id:e}).then((function(e){if(200===e.code){var a=e.data;a.length>0&&a.forEach((function(e){"1检验员"===e.nodeName?(t.oneInfo=e.approvalOpinion,t.oneTime=e.approvalDate,t.oneName=e.approver,t.oneOperation=e.operation):"2检测主管确认"===e.nodeName?(t.twoInfo=e.approvalOpinion,t.twoTime=e.approvalDate,t.twoName=e.approver,t.twoOperation=e.operation):"3物流部确认"===e.nodeName?(t.threeInfo=e.approvalOpinion,t.threeTime=e.approvalDate,t.threeName=e.approver,t.threeOperation=e.operation):"4产品工程师处理意见"===e.nodeName?(t.fourInfo=e.approvalOpinion,t.fourTime=e.approvalDate,t.fourName=e.approver,t.fourOperation=e.operation):"5.总工或者副经理的处理意见"===e.nodeName?(t.fiveInfo=e.approvalOpinion,t.fiveTime=e.approvalDate,t.fiveName=e.approver,t.fiveOperation=e.operation):"6质量部"===e.nodeName?(t.sixInfo=e.approvalOpinion,t.sixTime=e.approvalDate,t.sixName=e.approver,t.sixOperation=e.operation):"7质量部经理"===e.nodeName?(t.sevenInfo=e.approvalOpinion,t.sevenTime=e.approvalDate,t.sevenName=e.approver,t.sevenOperation=e.operation):"8核算员"===e.nodeName?(t.eightInfo=e.approvalOpinion,t.eightTime=e.approvalDate,t.eightName=e.approver,t.eightOperation=e.operation):"9物流部索赔结果"===e.nodeName&&(t.nineInfo=e.approvalOpinion,t.nineTime=e.approvalDate,t.nineName=e.approver,t.nineOperation=e.operation)}))}})).catch((function(e){t.submitDeclareLoading=!1,console.log(e)}))}}}),o=n,l=(a("64f3"),a("2877")),r=Object(l["a"])(o,s,i,!1,null,"58d12044",null);t["default"]=r.exports},"3e77":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"capacity-scope"},[a("div",{staticClass:"search"},[a("div",[a("el-form",{ref:"entity",attrs:{model:e.entity,size:"small",inline:!0}},[a("el-form-item",{attrs:{label:"订单编号",prop:"no"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable()}},model:{value:e.entity.no,callback:function(t){e.$set(e.entity,"no",t)},expression:"entity.no"}})],1),a("el-form-item",{attrs:{label:"规格型号",prop:"model"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable()}},model:{value:e.entity.model,callback:function(t){e.$set(e.entity,"model",t)},expression:"entity.model"}})],1),a("el-form-item",{attrs:{label:"样品名称",prop:"sample"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshTable()}},model:{value:e.entity.sample,callback:function(t){e.$set(e.entity,"sample",t)},expression:"entity.sample"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.refreshTable}},[e._v("查询")]),a("el-button",{attrs:{size:"mini"},on:{click:e.refresh}},[e._v("重置")])],1)],1)],1)]),a("div",[a("lims-table",{attrs:{tableData:e.tableData,column:e.column,height:"calc(100vh - 250px)",page:e.page,tableLoading:e.tableLoading},on:{pagination:e.pagination}})],1),a("el-dialog",{attrs:{title:"提交","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v("是否确认提交OA？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.submitOALoading},on:{click:e.submitOA}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"删除","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.deleteVisible,width:"30%"},on:{"update:visible":function(t){e.deleteVisible=t}}},[a("span",[e._v("是否确认"),a("span",{staticStyle:{color:"#FF4902"}},[e._v("删除")]),e._v("OA？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.cancelOALoading},on:{click:e.cancelOA}},[e._v("确 定")])],1)]),e.unPassDialog?a("UnPassDialog",{ref:"unPassDialog",attrs:{orderId:e.orderId,unPassDialog:e.unPassDialog},on:{resetForm:e.resetForm1}}):e._e(),e.OAProcess?a("OAProcess",{ref:"OAProcess",attrs:{OAProcess:e.OAProcess},on:{closeOAProcess:e.closeOAProcess}}):e._e()],1)},i=[],n=a("5530"),o=a("6ddf"),l=a("22df"),r=a("00d5"),c=a("b775");function d(e){return Object(c["a"])({url:"/unqualifiedHandler/page",method:"get",params:e})}function u(e){return Object(c["a"])({url:"/unqualifiedHandler/deleteUnqualifiedHandler",method:"delete",params:e})}function p(e){return Object(c["a"])({url:"/unqualifiedHandler/pushOA",method:"post",data:e})}var f={components:{limsTable:r["a"],OAProcess:l["default"],UnPassDialog:o["default"]},data:function(){var e=this;return{handlerId:null,entity:{sample:null,model:null},tableData:[],tableLoading:!1,column:[{label:"编号",prop:"no",width:"160px"},{label:"订单号",prop:"orderNo"},{label:"零件号",prop:"partNo",width:"160px",dataType:"link",linkMethod:"openUnPassDialog"},{label:"零件描述",prop:"partDesc"},{label:"物料名称",prop:"materialName"},{label:"生产批次",prop:"productionBatch"},{label:"到货数量",prop:"cargoQuantity"},{label:"规格型号",prop:"specsModels"},{label:"报检日期",prop:"inspectTime"},{label:"状态",prop:"statusDB"},{label:"反馈人",prop:"feedbackUser"},{label:"要检验的采购数量",prop:"qtyToInspect"},{label:"反馈日期",prop:"feedbackTime"},{label:"分类",prop:"classification",width:"100px",dataType:"tag",formatData:function(e){return 0==e?"一类不合格":1==e?"二类不合格":null},formatType:function(e){return 0==e?"warning":1==e?"info":"null"}},{label:"供应商名称",prop:"supplierName"},{label:"不合格归属",prop:"offGradeAscription",width:"100px",dataType:"tag",formatData:function(e){return 0==e?"生产反馈不合格":1==e?"检测不合格":null},formatType:function(e){return 0==e?"warning":1==e?"info":"null"}},{label:"不合格描述",prop:"unqualifiedDesc"},{dataType:"action",fixed:"right",label:"操作",width:"180px",operation:[{name:"提交OA",type:"text",clickFun:function(t){e.openOA(t)},disabled:function(e,t){return null!==e.requestId}},{name:"查看OA流程",type:"text",clickFun:function(t){e.OAView(t)}},{name:"删除",type:"text",clickFun:function(t){e.deleteOA(t)},disabled:function(e,t){return null!==e.requestId}}]}],page:{total:0,size:10,current:1},statusList:[],dialogVisible:!1,unPassDialog:!1,orderId:"",OAProcess:!1,submitOALoading:!1,deleteVisible:!1,cancelOALoading:!1}},mounted:function(){this.refreshTable()},methods:{refreshTable:function(){var e=this;this.tableLoading=!0,d(Object(n["a"])(Object(n["a"])({},this.page),this.entity)).then((function(t){e.tableLoading=!1,e.tableData=t.data.records,e.page.total=t.data.total})).catch((function(t){e.tableLoading=!1}))},refresh:function(){this.resetForm("entity"),this.refreshTable()},pagination:function(e){this.page.size=e.limit,this.refreshTable()},openUnPassDialog:function(e){var t=this;this.unPassDialog=!0,this.$nextTick((function(){t.$refs.unPassDialog.getInsOrder("view",e)}))},resetForm1:function(){this.$refs.unPassDialog.$refs["unPassForm"].resetFields(),this.unPassDialog=!1},deleteOA:function(e){this.handlerId=e.handlerId,this.deleteVisible=!0},cancelOA:function(){var e=this;this.de=!0,u({id:this.handlerId}).then((function(t){e.cancelOALoading=!1,200===t.code&&(e.deleteVisible=!1,e.$message.success("删除成功"),e.refreshTable("page"))})).catch((function(t){e.cancelOALoading=!1,console.error(t)}))},openOA:function(e){this.handlerId=e.handlerId,this.dialogVisible=!0},OAView:function(e){var t=this;this.OAProcess=!0,this.$nextTick((function(){t.$refs.OAProcess.getInfo(e.handlerId)}))},closeOAProcess:function(){this.OAProcess=!1},submitOA:function(e){var t=this;this.submitOALoading=!0,p({handlerId:this.handlerId}).then((function(e){t.submitOALoading=!1,200===e.code&&(t.dialogVisible=!1,t.$message.success("提交成功"),t.refreshTable("page"))})).catch((function(e){t.submitOALoading=!1,console.error(e)}))}}},m=f,h=a("2877"),v=Object(h["a"])(m,s,i,!1,null,null,null);t["default"]=v.exports},"5e56":function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return r})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"h",(function(){return u}));var s=a("b775");function i(e){return Object(s["a"])({url:"/insOrderPlan/getFactoryVerify",method:"get",params:e})}function n(e){return Object(s["a"])({url:"/insOrderPlan/addFactoryVerify",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/insOrderPlan/addUnqualifiedRetest",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/insOrder/getInsOrder",method:"get",params:e})}function r(e){return Object(s["a"])({url:"/unqualifiedHandler/getUnqualifiedHandler",method:"get",params:e})}function c(e){return Object(s["a"])({url:"/unqualifiedHandler/downFile",method:"get",params:e})}function d(e){return Object(s["a"])({url:"/unqualifiedHandler/addUnqualifiedHandler",method:"post",data:e})}function u(e){return Object(s["a"])({url:"/unPass/pageInsUnPass",method:"post",data:e})}},"64f3":function(e,t,a){"use strict";a("0813")},"6ddf":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"新增不合格处理",visible:e.isShow,width:"740px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isShow=t}}},[a("div",{staticClass:"search"},[a("el-form",{ref:"unPassForm",staticClass:"form-inline",attrs:{inline:!0,model:e.unPassForm,rules:e.unPassFormRules,"label-width":"120px"}},[a("div",[a("el-form-item",{staticClass:"headLine",staticStyle:{width:"100%"},attrs:{label:"标题:",prop:"headline"}},[a("el-input",{attrs:{clearable:"",size:"small",disabled:"view"===e.type,type:"textarea",placeholder:"请输入"},model:{value:e.unPassForm.headline,callback:function(t){e.$set(e.unPassForm,"headline",t)},expression:"unPassForm.headline"}})],1)],1),a("el-form-item",{attrs:{label:"供应商名称:"}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.supplierName,callback:function(t){e.$set(e.unPassForm,"supplierName",t)},expression:"unPassForm.supplierName"}})],1),a("el-form-item",{attrs:{label:"物料名称:"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:e.unPassForm.materialName}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.materialName,callback:function(t){e.$set(e.unPassForm,"materialName",t)},expression:"unPassForm.materialName"}})],1)],1),a("el-form-item",{attrs:{label:"生产批次:"}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.productionBatch,callback:function(t){e.$set(e.unPassForm,"productionBatch",t)},expression:"unPassForm.productionBatch"}})],1),a("el-form-item",{attrs:{label:"到货数量:"}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.cargoQuantity,callback:function(t){e.$set(e.unPassForm,"cargoQuantity",t)},expression:"unPassForm.cargoQuantity"}})],1),a("el-form-item",{attrs:{label:"规格型号:"}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.specsModels,callback:function(t){e.$set(e.unPassForm,"specsModels",t)},expression:"unPassForm.specsModels"}})],1),a("el-form-item",{attrs:{label:"报检时间:"}},[a("el-date-picker",{staticStyle:{width:"175px"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small",disabled:"",type:"date",placeholder:"选择日期"},model:{value:e.unPassForm.inspectTime,callback:function(t){e.$set(e.unPassForm,"inspectTime",t)},expression:"unPassForm.inspectTime"}})],1),a("el-form-item",{attrs:{label:"反馈人:"}},[a("el-input",{attrs:{clearable:"",disabled:"",size:"small",placeholder:"请输入"},model:{value:e.unPassForm.feedbackUser,callback:function(t){e.$set(e.unPassForm,"feedbackUser",t)},expression:"unPassForm.feedbackUser"}})],1),a("el-form-item",{attrs:{label:"反馈时间:",prop:"feedbackTime"}},[a("el-date-picker",{staticStyle:{width:"175px"},attrs:{disabled:"view"===e.type,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",type:"date",placeholder:"选择日期"},model:{value:e.unPassForm.feedbackTime,callback:function(t){e.$set(e.unPassForm,"feedbackTime",t)},expression:"unPassForm.feedbackTime"}})],1),a("el-form-item",{attrs:{label:"分类:",prop:"classification"}},[a("el-select",{attrs:{disabled:"view"===e.type,size:"small",placeholder:"请选择"},model:{value:e.unPassForm.classification,callback:function(t){e.$set(e.unPassForm,"classification",t)},expression:"unPassForm.classification"}},e._l(e.classificationOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"不合格归属:",prop:"offGradeAscription"}},[a("el-select",{attrs:{disabled:"view"===e.type,size:"small",placeholder:"请选择"},model:{value:e.unPassForm.offGradeAscription,callback:function(t){e.$set(e.unPassForm,"offGradeAscription",t)},expression:"unPassForm.offGradeAscription"}},e._l(e.offGradeAscriptionOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"不合格情况描述:",prop:"unqualifiedDesc"}},[a("el-input",{staticStyle:{width:"484px"},attrs:{clearable:"",type:"textarea",disabled:"view"===e.type,size:"small",placeholder:"请输入"},model:{value:e.unPassForm.unqualifiedDesc,callback:function(t){e.$set(e.unPassForm,"unqualifiedDesc",t)},expression:"unPassForm.unqualifiedDesc"}})],1)],1),"add"===e.type?a("el-upload",{ref:"upload",attrs:{action:e.action2,"on-change":e.beforeUpload,"on-error":e.onError,"on-remove":e.handleRemoveFile,"on-success":e.getUnpassUrl,headers:e.uploadHeader,"file-list":e.unPassFilesList}},[a("el-button",{staticStyle:{"text-align":"left"},attrs:{size:"small",type:"primary"}},[e._v("附件上传")])],1):e._e(),"add"!==e.type?a("div",[a("div",{staticStyle:{"padding-left":"40px","margin-bottom":"4px"}},[e._v("附件：")]),e._l(e.unqualifiedHandlerFiles,(function(t){return a("div",{staticStyle:{"padding-left":"40px","margin-bottom":"4px"}},[a("span",[e._v(e._s(t.fileName))]),a("el-link",{staticStyle:{"margin-left":"20px","vertical-align":"top"},attrs:{type:"primary",underline:!1},on:{click:function(a){return e.handleDown(t)}}},[e._v("下载")])],1)}))],2):e._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.$emit("resetForm")}}},[e._v("取 消")]),"add"===e.type?a("el-button",{attrs:{type:"primary",loading:e.handlunPassLoading},on:{click:e.handlunPass}},[e._v("确 定")]):e._e()],1)])],1)},i=[],n=a("5530"),o=(a("99af"),a("c740"),a("14d9"),a("a434"),a("d3b7"),a("0643"),a("4e3e"),a("159b"),a("5e56")),l=a("2f62"),r={name:"unPassDialog",components:{},props:{unPassDialog:{type:Boolean,default:function(){return!1}},orderId:{type:String,default:function(){return null}}},data:function(){return{type:"",isShow:this.unPassDialog,unPassForm:{headline:"",inventoryQuantityId:"",supplierName:"",materialName:"",productionBatch:"",cargoQuantity:"",specsModels:"",inspectTime:"",feedbackUser:"",feedbackTime:"",classification:"",offGradeAscription:"",unqualifiedDesc:"",unqualifiedHandlerFiles:[]},unPassFormRules:{offGradeAscription:[{required:!0,message:"请选择不合格归属",trigger:"change"}],headline:[{required:!0,message:"请填写标题",trigger:"blur"}]},unPassFilesList:[],classificationOptions:[],offGradeAscriptionOptions:[],handlunPassLoading:!1,unqualifiedHandlerFiles:[]}},mounted:function(){this.getClassificationOptions(),this.getOffGradeAscriptionOptions()},methods:{getInsOrder:function(e,t){var a=this;this.type=e,"add"===e?Object(o["f"])({orderId:this.orderId}).then((function(e){200===e.code&&(a.unPassForm.headline="No.0005-中天装备电线-外购品不合格反馈评审及纠正预防流程(正式版)-".concat(a.nickName,"-").concat((new Date).toISOString().substring(0,10)),a.unPassForm.feedbackTime=(new Date).toISOString().substring(0,10),a.unPassForm.feedbackUser=a.nickName,a.unPassForm.insOrderId=e.data.insOrder.id,a.unPassForm.materialName=e.data.insOrder.sampleType,a.unPassForm.specsModels=e.data.insOrder.partDetail,a.unPassForm.inventoryQuantityId=e.data.insOrderTemplate.inventoryQuantityId,a.unPassForm.supplierName=e.data.insOrderTemplate.supplierName,a.unPassForm.productionBatch=e.data.insOrderTemplate.updateBatchNo,a.unPassForm.cargoQuantity=e.data.insOrderTemplate.qtyArrived+e.data.insOrderTemplate.buyUnitMeas,a.unPassForm.inspectTime=e.data.insOrderTemplate.sendTime.substring(0,10))})):(this.getInfo(t.handlerId),this.unPassForm=Object(n["a"])({},t))},getInfo:function(e){var t=this;Object(o["g"])({id:e}).then((function(e){200===e.code&&(t.unqualifiedHandlerFiles=t.HaveJson(e.data.unqualifiedHandlerFiles))}))},handleDown:function(e){var t=this;Object(o["d"])({id:e.id}).then((function(a){t.$download.saveAs(a.data.fileUrl,e.fileName)})).catch((function(e){}))},handlunPass:function(){var e=this;this.$refs["unPassForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.unPassForm.unqualifiedHandlerFiles.forEach((function(e){delete e.orderBy})),e.handlunPassLoading=!0,Object(o["b"])(e.unPassForm).then((function(t){200===t.code&&(e.$message.success("提交成功"),e.$emit("resetForm")),e.handlunPassLoading=!1}))}))},getUnpassUrl:function(e,t,a){200==e.code&&(this.$message.success("上传成功"),this.unPassForm.unqualifiedHandlerFiles.push(e.data))},handleRemoveFile:function(e){var t=this.unPassForm.unqualifiedHandlerFiles.findIndex((function(t){return t===e.response.data}));t>-1&&this.unPassForm.unqualifiedHandlerFiles.splice(t,1)},beforeUpload:function(e){return e.size>10485760?(this.$message.error("上传文件不超过10M"),this.$refs.upload.clearFiles(),!1):(this.upLoading=!0,!0)},onError:function(e,t,a){this.$message.error("上传失败"),this.$refs.upload.clearFiles()},getClassificationOptions:function(){var e=this;this.getDicts("categories_no_conformities").then((function(t){e.classificationOptions=e.dictToValue(t.data)}))},getOffGradeAscriptionOptions:function(){var e=this;this.getDicts("attribution_no_conformities").then((function(t){e.offGradeAscriptionOptions=e.dictToValue(t.data)}))}},computed:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["nickName"])),{},{action2:function(){return this.javaApi+"/unqualifiedHandler/uploadFileByUnqualified"}})},c=r,d=(a("7bd8"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,"438d04df",null);t["default"]=u.exports},"7bd8":function(e,t,a){"use strict";a("f617")},f617:function(e,t,a){}}]);