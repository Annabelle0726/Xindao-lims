(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-004f4510"],{"0d3d":function(n,t,e){},2676:function(n,t,e){"use strict";e("0d3d")},9785:function(n,t,e){"use strict";e.r(t);var a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("div",{staticClass:"flex_table"},[n.isDepartment?e("div",{staticStyle:{width:"49%"}},[n._m(0),e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{"margin-bottom":"18px","margin-right":"10px",display:"flex","align-items":"center","line-height":"32px"}},[e("span",{staticStyle:{width:"48px","font-size":"14px","font-weight":"700",color:"#606266"}},[n._v("姓名")]),e("el-input",{staticClass:"search",attrs:{clearable:"",placeholder:"请输入",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&n._k(t.keyCode,"enter",13,t.key,"Enter")?null:n.getPersonnelTraining(n.departId)}},model:{value:n.trainingPagination.userName,callback:function(t){n.$set(n.trainingPagination,"userName",t)},expression:"trainingPagination.userName"}})],1),e("div",{staticStyle:{"line-height":"30px"}},[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return n.getPersonnelTraining(n.departId)}}},[n._v("查询")])],1)])]),e("lims-table",{ref:"trainingTableData",attrs:{tableData:n.trainingTableData,column:n.trainingColumn,currentChange:n.currentChange,highlightCurrentRow:!0,height:"calc(100vh - 22em)",page:n.trainingPagination,tableLoading:n.trainingLoading},on:{pagination:n.pagination}})],1):n._e(),e("div",{style:"width: "+(n.isDepartment?"49%":"100%")+";"},[n._m(1),e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("el-form",{ref:"searchForm",attrs:{model:n.searchForm,size:"small",inline:!0}},[e("el-form-item",{attrs:{label:"年份"}},[e("el-date-picker",{attrs:{clearable:"",format:"yyyy",placeholder:"选择年",size:"small",type:"year","value-format":"yyyy"},on:{change:function(t){return n.queryPersonnelDetailsPage(n.currentChangeRow.userId)}},model:{value:n.searchForm.trainingDate,callback:function(t){n.$set(n.searchForm,"trainingDate",t)},expression:"searchForm.trainingDate"}})],1),e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return n.queryPersonnelDetailsPage(n.currentChangeRow.userId)}}},[n._v("查询")])],1)],1),e("div",[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return n.openDownloadDia(n.currentChangeRow)}}},[n._v("导出")])],1)],1),e("lims-table",{attrs:{tableData:n.trainingPersonTableData,column:n.trainingPersonColumn,height:"calc(100vh - 22em)",page:n.trainingPersonPagination,tableLoading:n.trainingPersonLoading},on:{pagination:n.pagination1}})],1)])])},i=[function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticStyle:{"font-weight":"bold"}},[n._v("年度计划")])])},function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticStyle:{"font-weight":"bold"}},[n._v("年度计划明细")])])}],r=(e("a9e3"),e("00d5")),o=e("b775");function s(n){return Object(o["a"])({url:"/personTrainingRecord/exportTrainingRecord",method:"get",params:n,responseType:"blob"})}function l(n){return Object(o["a"])({url:"/personTrainingRecord/trainingSelectTrainingRecord",method:"get",params:n})}function g(n){return Object(o["a"])({url:"/personTrainingRecord/queryPersonnelDetails",method:"get",params:n})}var c={components:{limsTable:r["a"]},props:{departId:{type:Number,default:function(){return null}},isDepartment:{type:Boolean,default:!1}},data:function(){return{outLoading:!1,trainingForm:{},trainingColumn:[{label:"员工编号",prop:"account",width:"100"},{label:"姓名",prop:"name"},{label:"所在部门",prop:"departLimsName",width:"150"},{label:"职称",prop:"professionalTitle"},{label:"最高学历",prop:"officialAcademicRedentials",width:"100"},{label:"入单位时间",prop:"unitTime",width:"150"}],trainingTableData:[],trainingLoading:!1,trainingPagination:{size:20,total:0,current:1,userName:null},searchForm:{trainingDate:""},trainingPersonColumn:[{label:"培训日期",prop:"trainingDate"},{label:"培训内容",prop:"trainingContent"},{label:"课时",prop:"classHour"},{label:"培训结果",prop:"examinationResults"},{label:"备注",prop:"remarks"}],trainingPersonTableData:[],trainingPersonLoading:!1,trainingPersonPagination:{size:20,current:1,total:0},currentChangeRow:""}},mounted:function(){this.getPersonnelTraining(this.departId)},methods:{refreshTable:function(){this.getPersonnelTraining(this.departId)},openDownloadDia:function(n){var t=this,e=this.searchForm.trainingDate;e||(e=this.$moment().format("YYYY")),s({userId:n.userId,trainingDate:e}).then((function(n){t.outLoading=!1;var e=new Blob([n],{type:"application/msword"});t.$download.saveAs(e,"培训记录导出.docx")}))},getPersonnelTraining:function(n){var t=this,e={departmentId:n,size:this.trainingPagination.size,current:this.trainingPagination.current,userName:this.trainingPagination.userName};this.trainingLoading=!0,l(e).then((function(n){t.trainingLoading=!1,t.trainingTableData=n.data.records,t.trainingPagination.total=n.data.total,t.trainingTableData.length>0&&t.$refs.trainingTableData.setCurrentRow(t.trainingTableData[0])})).catch((function(n){t.trainingLoading=!1}))},currentChange:function(n){this.currentChangeRow=n,null===n&&(n=this.trainingTableData[0]),this.queryPersonnelDetailsPage(n.userId)},queryPersonnelDetailsPage:function(n){var t=this;null===this.searchForm.trainingDate&&(this.searchForm.trainingDate="");var e={userId:n,size:this.trainingPersonPagination.size,current:this.trainingPersonPagination.current,trainingDate:this.searchForm.trainingDate};this.trainingPersonLoading=!0,g(e).then((function(n){t.trainingPersonLoading=!1,t.trainingPersonTableData=n.data.records,t.trainingPersonPagination.total=n.data.total})).catch((function(n){t.trainingPersonLoading=!1}))},pagination:function(n){this.trainingPagination.size=n.limit,this.getPersonnelTraining(this.departId)},pagination1:function(n){this.trainingPersonPagination.size=n.limit,this.queryPersonnelDetailsPage(this.currentChangeRow.userId)}},watch:{departId:{handler:function(n,t){this.isDepartment?this.getPersonnelTraining(n):this.queryPersonnelDetailsPage(n)}}}},u=c,d=(e("2676"),e("2877")),p=Object(d["a"])(u,a,i,!1,null,"3b93b96a",null);t["default"]=p.exports}}]);